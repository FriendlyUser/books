<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- favicon -->
    <link rel="shortcut icon" href="/images/favicon.png">
    <!-- theme meta -->
    <meta name="theme-name" content="pinwheel-astro">
    <meta name="msapplication-TileColor" content="#000000">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2479144310234386" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119155027-6">

  </script>
  
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
    <meta name="generator" content="Astro v2.6.6">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <!-- google font css -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&#38;family=Merriweather:wght@700;900&#38;display=swap" rel="stylesheet">

    <link href="/_pagefind/pagefind-ui.css" rel="stylesheet">
		<script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script>

    <!-- responsive meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">

    <!-- title -->
    <title>
      Web Scraping with Typescript
    </title>

    <!-- canonical url -->
    

    <!-- noindex robots -->
    

    <!-- meta-description -->
    <meta name="description" content="A Comprehensive Guide to Building Web Scrapers">

    <!-- author from config.json -->
    <meta name="author" content="FriendlyUser">

    <!-- og-title -->
    <meta property="og:title" content="Web Scraping with Typescript">

    <!-- og-description -->
    <meta property="og:description" content="A Comprehensive Guide to Building Web Scrapers">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pinwheel-astro.vercel.app/books/typescript_scrapping_ref/">

    <!-- twitter-title -->
    <meta name="twitter:title" content="Web Scraping with Typescript">

    <!-- twitter-description -->
    <meta name="twitter:description" content="A Comprehensive Guide to Building Web Scrapers">

    <!-- og-image -->
    <meta property="og:image" content="https://pinwheel-astro.vercel.app/images/og-image.png">

    <!-- twitter-image -->
    <meta name="twitter:image" content="https://pinwheel-astro.vercel.app/images/og-image.png">
    <meta name="twitter:card" content="summary_large_image">
  <link rel="stylesheet" href="/_astro/_single_.db0af2d4.css" />
<link rel="stylesheet" href="/_astro/404.99013387.css" /><script type="module" src="/_astro/hoisted.4256c07d.js"></script></head>
  <body>
    
    <header class="header">
  <nav class="navbar container">
    <!-- logo -->
    <div class="order-0">
      <a href="/" class="navbar-brand block">
  <img alt="Pinwheel Astro" style="height:31px;width:147px" width="294" height="62" src="/_astro/logo_ZThIBR.png" loading="lazy" decoding="async">
</a>
    </div>
    <!-- navbar toggler -->
    <input id="nav-toggle" type="checkbox" class="hidden">
    <label id="show-button" for="nav-toggle" class="order-2 flex cursor-pointer items-center lg:order-1 lg:hidden">
      <svg class="h-6 fill-current" viewBox="0 0 20 20">
        <title>Menu Open</title>
        <path d="M0 3h20v2H0V3z m0 6h20v2H0V9z m0 6h20v2H0V0z"></path>
      </svg>
    </label>
    <label id="hide-button" for="nav-toggle" class="order-2 hidden cursor-pointer items-center lg:order-1">
      <svg class="h-6 fill-current" viewBox="0 0 20 20">
        <title>Menu Close</title>
        <polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"></polygon>
      </svg>
    </label>
    <!-- /navbar toggler -->

    <ul id="nav-menu" class="navbar-nav order-3 hidden w-full lg:order-1 lg:flex lg:w-auto lg:space-x-2">
      <li class="nav-item">
                <a href="/" class="nav-link inline-block lg:block false">
                  Home
                </a>
              </li><li class="nav-item">
                <a href="/books" class="nav-link inline-block lg:block false">
                  Books
                </a>
              </li><li class="nav-item">
                <a href="/contact" class="nav-link inline-block lg:block false">
                  Contact
                </a>
              </li>
      <li class="nav-item mt-2 lg:hidden">
        <a class="btn btn-white btn-sm border-border" href="/books">
          View Books</a>
      </li>
    </ul>
    <div class="order-1 ml-auto hidden items-center md:order-2 md:ml-0 lg:flex">
      <a class="btn btn-white btn-sm" href="/signin"> View Books</a>
    </div>
  </nav>
</header>
<script>
  const button = document.getElementById("dropdown-button");
  button.addEventListener("click", () => {
    const dropdown = document.getElementById("dropdown");
    dropdown.classList.toggle(dropdown.style === "hidden" ? "block" : "hidden");
  });

  //sticky header
  const header = document.querySelector(".header");
  window.addEventListener("scroll", () => {
    const scrollY = window.scrollY;
    if (scrollY > 0) {
      header.classList.add("header-sticky");
    } else {
      header.classList.remove("header-sticky");
    }
  });
</script>
    <main id="main-content">
      
  <section class="section blog-single">
    <div class="container">
      <div class="row justify-center">
        <div class="lg:col-10">
          <img class="w-full rounded-xl" alt="" width="920" height="450" src="/_astro/1538101898_KwcJC.png" loading="lazy" decoding="async">
        </div>
        <div class="mt-10 max-w-[810px] lg:col-9">
          <h1 class="h2">
            Web Scraping with Typescript
          </h1>
          <div class="mb-5 mt-6 flex items-center space-x-2">
            <ul class="mb-4">
              <li class="mr-4 inline-block">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="mr-2 -mt-1 inline-block" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M248 104c-53 0-96 43-96 96s43 96 96 96 96-43 96-96-43-96-96-96zm0 144c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm0-240C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-49.7 0-95.1-18.3-130.1-48.4 14.9-23 40.4-38.6 69.6-39.5 20.8 6.4 40.6 9.6 60.5 9.6s39.7-3.1 60.5-9.6c29.2 1 54.7 16.5 69.6 39.5-35 30.1-80.4 48.4-130.1 48.4zm162.7-84.1c-24.4-31.4-62.1-51.9-105.1-51.9-10.2 0-26 9.6-57.6 9.6-31.5 0-47.4-9.6-57.6-9.6-42.9 0-80.6 20.5-105.1 51.9C61.9 339.2 48 299.2 48 256c0-110.3 89.7-200 200-200s200 89.7 200 200c0 43.2-13.9 83.2-37.3 115.9z"></path></svg>
                
              </li>

              <!-- <li class="mr-4 inline-block">
                <FaRegCalendarAlt className={"mr-2 -mt-1 inline-block"} />
                {dateFormat(post.data?.pubDate)}
              </li> -->
              <li class="mr-4 inline-block">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="mr-2 -mt-1 inline-block" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"></path></svg>
                122 Mins read
              </li>
              <li class="mr-4 inline-block">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="mr-2 -mt-1 inline-block" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"></path></svg>
                
              </li>
            </ul>
          </div>

          <div class="content">
            <div id="search" class="ml-3 p-4 -mt-8"></div>
            <article id="article">
              <h1 id="chapter-1-introduction-to-web-scraping-with-typescript">Chapter 1: Introduction to Web Scraping with TypeScript</h1>
<h2 id="what-is-web-scraping">What is web scraping?</h2>
<p>Web scraping, also known as web data extraction or web harvesting, is the process of extracting data from websites. It involves using software tools to automatically gather and extract information from web pages, and then save the extracted data in a structured format, such as a database, spreadsheet, or CSV file. Web scraping is commonly used to extract data such as product prices, stock market data, real estate listings, news articles, social media posts, and more.</p>
<h2 id="why-use-typescript-for-web-scraping">Why use TypeScript for web scraping?</h2>
<p>TypeScript is a typed superset of JavaScript that compiles to plain JavaScript. It provides many benefits for web scraping projects, including:</p>
<ol>
<li>
<p><strong>Type safety:</strong> TypeScript allows developers to catch errors at compile-time rather than runtime, which can help catch issues early on and prevent bugs from making it to production.</p>
</li>
<li>
<p><strong>Code organization:</strong> TypeScript supports modern JavaScript features such as classes, modules, and interfaces, which can help developers write cleaner and more organized code.</p>
</li>
<li>
<p><strong>Intellisense and autocompletion:</strong> TypeScript provides better IDE support and code editor features such as Intellisense and autocompletion, which can save developers time and increase productivity.</p>
</li>
<li>
<p><strong>Better code maintainability:</strong> TypeScript supports features such as type annotations and interfaces that can make code easier to maintain and refactor over time.</p>
</li>
<li>
<p><strong>Scalability:</strong> TypeScript can help make large-scale web scraping projects more manageable by providing better organization and structure, as well as features such as static typing and better tooling support.</p>
</li>
</ol>
<h2 id="overview-of-the-books-contents">Overview of the book’s contents</h2>
<p>This book is a comprehensive guide to building web scrapers using TypeScript. It covers the following topics:</p>
<ol>
<li>Introduction to TypeScript</li>
<li>Setting up a TypeScript development environment</li>
<li>Basic TypeScript syntax and concepts</li>
<li>Type annotations and interfaces</li>
<li>Asynchronous programming with TypeScript</li>
<li>Debugging TypeScript applications</li>
<li>Installing Node.js and TypeScript</li>
<li>Configuring TypeScript for web scraping</li>
<li>Setting up a development environment with Visual Studio Code</li>
<li>Understanding the basics of HTML and CSS</li>
<li>Selecting elements with CSS selectors</li>
<li>Using XPath to select elements</li>
<li>Making HTTP requests with Node.js</li>
<li>Parsing HTML with Cheerio</li>
<li>Scraping data from websites</li>
<li>Scraping data from APIs</li>
<li>Handling pagination and infinite scrolling</li>
<li>Working with forms and user input</li>
<li>Using headless browsers for scraping</li>
<li>Handling errors and exceptions in web scraping</li>
<li>Saving scraped data to files and databases</li>
<li>Using TypeScript with databases</li>
<li>Cleaning and transforming scraped data</li>
<li>Analyzing scraped data with visualization tools</li>
<li>Writing maintainable and scalable scraping code</li>
<li>Respecting website terms of service and legal considerations</li>
<li>Dealing with anti-scraping measures</li>
<li>Testing and debugging web scraping applications</li>
<li>Deploying web scraping applications to production environments</li>
</ol>
<p>This book is aimed at developers who want to learn how to build web scrapers using TypeScript. It assumes a basic understanding of JavaScript and web development concepts, but no prior experience with TypeScript is required.</p>
<h1 id="chapter-2-setting-up-the-typescript-development-environment-for-web-scraping">Chapter 2: Setting up the TypeScript Development Environment for Web Scraping</h1>
<h2 id="installing-nodejs-and-typescript">Installing Node.js and TypeScript</h2>
<p>To start developing web scrapers with TypeScript, you need to install Node.js and TypeScript. Node.js is a JavaScript runtime that allows you to execute JavaScript code on the server-side, while TypeScript is a superset of JavaScript that adds static type checking and other features to the language.</p>
<p>Here are the steps to install Node.js and TypeScript on your system:</p>
<ol>
<li>
<p><strong>Install Node.js:</strong> Go to the <a href="https://nodejs.org/">official Node.js website</a> and download the latest stable version for your operating system. Once the download is complete, run the installer and follow the prompts to complete the installation.</p>
</li>
<li>
<p><strong>Install TypeScript:</strong> Once Node.js is installed, open a terminal or command prompt and type the following command to install TypeScript globally:</p>
</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install -g typescript</span></span></code></pre>
<p>This command will download and install the latest stable version of TypeScript on your system.</p>
<p>To check if TypeScript is installed correctly, you can run the following command in your terminal:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">tsc -v</span></span></code></pre>
<p>This should print the version of TypeScript that you installed.</p>
<p>Now that you have installed Node.js and TypeScript, you are ready to start building web scrapers using TypeScript.</p>
<h2 id="configuring-typescript-for-web-scraping">Configuring TypeScript for web scraping</h2>
<p>After you have installed TypeScript, you need to configure it for your web scraping project. Here are the steps to configure TypeScript for web scraping:</p>
<ol>
<li>
<p><strong>Create a project folder:</strong> Create a new folder for your TypeScript project. You can name it whatever you want, but make sure it’s a descriptive name that reflects the purpose of your project.</p>
</li>
<li>
<p><strong>Initialize the project:</strong> Open a terminal or command prompt, navigate to the project folder, and type the following command to initialize a new TypeScript project:</p>
</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm init -y</span></span></code></pre>
<p>This command will create a <code>package.json</code> file in your project folder that describes your project’s dependencies and other metadata.</p>
<ol start="3">
<li><strong>Create a TypeScript configuration file:</strong> Create a new file named <code>tsconfig.json</code> in your project folder. This file will contain the configuration options for TypeScript. Here is an example <code>tsconfig.json</code> file that you can use as a starting point:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">{</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">"compilerOptions"</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">"target"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"ES6"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">"module"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"commonjs"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">"outDir"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"dist"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">"sourceMap"</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">"include"</span><span style="color: #ABB2BF">: [</span><span style="color: #98C379">"src/**/*"</span><span style="color: #ABB2BF">],</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">"exclude"</span><span style="color: #ABB2BF">: [</span><span style="color: #98C379">"node_modules"</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">"**/*.spec.ts"</span><span style="color: #ABB2BF">]</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>Let’s go through each option in this configuration file:</p>
<ul>
<li>
<p><code>compilerOptions</code>: This section specifies the compiler options for TypeScript. Here are the options used in this example:</p>
<ul>
<li>
<p><code>target</code>: The ECMAScript version that you want to target. In this case, we are targeting ECMAScript 6.</p>
</li>
<li>
<p><code>module</code>: The module system that you want to use. In this case, we are using CommonJS, which is compatible with Node.js.</p>
</li>
<li>
<p><code>outDir</code>: The output directory for the compiled TypeScript files. In this case, we are using a <code>dist</code> folder in the project root.</p>
</li>
<li>
<p><code>sourceMap</code>: Whether to generate source maps for the compiled JavaScript files. Source maps are useful for debugging your TypeScript code in the browser’s developer console.</p>
</li>
</ul>
</li>
<li>
<p><code>include</code>: This option specifies the files that TypeScript should compile. In this case, we are including all <code>.ts</code> files in the <code>src</code> folder and its subfolders.</p>
</li>
<li>
<p><code>exclude</code>: This option specifies the files that TypeScript should ignore. In this case, we are excluding the <code>node_modules</code> folder and any test files that end with <code>.spec.ts</code>.</p>
</li>
</ul>
<ol start="4">
<li>
<p><strong>Create a source folder:</strong> Create a new folder named <code>src</code> in your project folder. This folder will contain your TypeScript source code.</p>
</li>
<li>
<p><strong>Write your TypeScript code:</strong> Write your web scraper code in TypeScript and save it in the <code>src</code> folder.</p>
</li>
<li>
<p><strong>Compile your code:</strong> Open a terminal or command prompt, navigate to the project folder, and type the following command to compile your TypeScript code:</p>
</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">tsc</span></span></code></pre>
<p>This command will compile all the <code>.ts</code> files in the <code>src</code> folder and its subfolders and output the compiled JavaScript files in the <code>dist</code> folder.</p>
<p>Now you have successfully configured TypeScript for your web scraping project.</p>
<p>Great! With TypeScript configured, we can now move on to writing our first web scraping script. But before we start writing any code, we need to create a <code>dist</code> folder where the compiled JavaScript files will be saved.</p>
<p>To create the <code>dist</code> folder, open a terminal in the root directory of your project and run the following command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">mkdir dist</span></span></code></pre>
<p>This will create a new folder named <code>dist</code> in the root directory of your project.</p>
<p>Next, we need to tell TypeScript to save the compiled JavaScript files in the <code>dist</code> folder. To do this, we’ll need to modify our <code>tsconfig.json</code> file.</p>
<p>Open the <code>tsconfig.json</code> file and add the following lines of code:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #98C379">"outDir"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"./dist"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #98C379">"rootDir"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"./src"</span></span></code></pre>
<p>The <code>outDir</code> property specifies the directory where TypeScript will save the compiled JavaScript files, while the <code>rootDir</code> property specifies the directory where the TypeScript source files are located.</p>
<p>With this configuration, when we compile our TypeScript files using the <code>tsc</code> command, the compiled JavaScript files will be saved in the <code>dist</code> folder.</p>
<p>Now that we have set up our <code>dist</code> folder, we can start writing our web scraping script in the <code>src</code> folder.</p>
<h2 id="setting-up-a-development-environment-with-visual-studio-code">Setting up a development environment with Visual Studio Code</h2>
<p>Now that we have installed Node.js and TypeScript and configured TypeScript for our project, we can set up a development environment in Visual Studio Code. Visual Studio Code is a popular code editor that has great support for TypeScript and Node.js development.</p>
<p>Here are the steps to set up Visual Studio Code for our web scraping project:</p>
<ol>
<li>
<p>Install Visual Studio Code: You can download and install Visual Studio Code from the official website at <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a>. Follow the instructions for your operating system to install it.</p>
</li>
<li>
<p>Install the required extensions: Once you have installed Visual Studio Code, you need to install some extensions that will help you with your TypeScript and Node.js development. Open Visual Studio Code and go to the Extensions panel on the left-hand side. Search for and install the following extensions:</p>
<ul>
<li>
<p>TypeScript: This extension provides TypeScript language support for Visual Studio Code. It includes features like syntax highlighting, code completion, and error checking.</p>
</li>
<li>
<p>Node.js Extension Pack: This extension pack includes a collection of popular Node.js extensions for Visual Studio Code. It includes features like IntelliSense for Node.js modules, debugging support, and the ability to run Node.js commands from within Visual Studio Code.</p>
</li>
</ul>
</li>
<li>
<p>Open your project folder in Visual Studio Code: Open Visual Studio Code and select File > Open Folder from the menu. Navigate to the folder where you have created your TypeScript project and select it.</p>
</li>
<li>
<p>Create a new TypeScript file: To create a new TypeScript file, select File > New File from the menu. Save the file with a .ts extension.</p>
</li>
<li>
<p>Write and run your code: Now you can start writing your TypeScript code in the new file you created. To run your code, open a terminal window in Visual Studio Code by selecting View > Terminal from the menu. Then, navigate to the folder where your TypeScript file is saved and run the following command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">tsc filename.ts &#x26;&#x26; node dist/filename.js</span></span></code></pre>
<p>Replace <code>filename</code> with the name of your TypeScript file. This command will compile your TypeScript code into JavaScript and run the resulting JavaScript file.</p>
</li>
</ol>
<p>With these steps, you now have a development environment set up in Visual Studio Code for your TypeScript web scraping project.</p>
<h1 id="chapter-3-understanding-html-and-css-for-web-scraping">Chapter 3: Understanding HTML and CSS for Web Scraping</h1>
<h2 id="basic-html-structure">Basic HTML structure</h2>
<p>HTML (HyperText Markup Language) is the standard markup language used to create web pages. An HTML document is composed of elements, which are represented by tags. The basic structure of an HTML document consists of the following elements:</p>
<ul>
<li><code>&#x3C;!DOCTYPE html></code> declaration: specifies the document type and version of HTML being used.</li>
<li><code>&#x3C;html></code> element: the root element that wraps around the entire HTML document.</li>
<li><code>&#x3C;head></code> element: contains the metadata of the HTML document such as title, stylesheets, and scripts.</li>
<li><code>&#x3C;body></code> element: contains the visible content of the HTML document that is rendered in the web browser.</li>
</ul>
<p>Here is an example of a basic HTML document:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">&#x3C;!</span><span style="color: #E06C75">DOCTYPE</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">html</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  &#x3C;</span><span style="color: #E06C75">head</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">>My Web Page&#x3C;/</span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  &#x3C;/</span><span style="color: #E06C75">head</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  &#x3C;</span><span style="color: #E06C75">body</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">h1</span><span style="color: #ABB2BF">>Welcome to my web page!&#x3C;/</span><span style="color: #E06C75">h1</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">p</span><span style="color: #ABB2BF">>This is a paragraph of text.&#x3C;/</span><span style="color: #E06C75">p</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  &#x3C;/</span><span style="color: #E06C75">body</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">></span></span></code></pre>
<p>In this example, the <code>&#x3C;!DOCTYPE html></code> declaration specifies that the document is an HTML5 document. The <code>&#x3C;html></code> element wraps around the entire document. The <code>&#x3C;head></code> element contains the title of the web page. The <code>&#x3C;body></code> element contains an <code>&#x3C;h1></code> heading and a <code>&#x3C;p></code> paragraph. When rendered in a web browser, the result would be a web page that displays “Welcome to my web page!” as a heading and “This is a paragraph of text.” as a paragraph below it.</p>
<h2 id="understanding-css-selectors">Understanding CSS selectors</h2>
<p>In order to scrape data from a website using web scraping, it is essential to understand how to select specific elements from the HTML structure of the website. CSS selectors are a powerful tool for selecting HTML elements based on their attributes, such as their class, ID, or tag name.</p>
<p>Here are some common CSS selectors and what they select:</p>
<ul>
<li>Tag selector: Selects all elements with a certain tag name, such as <code>div</code>, <code>p</code>, or <code>a</code>.</li>
<li>Class selector: Selects all elements with a specific class name, such as <code>.header</code>, <code>.menu</code>, or <code>.btn</code>.</li>
<li>ID selector: Selects a single element with a specific ID, such as <code>#main</code>, <code>#content</code>, or <code>#header</code>.</li>
<li>Attribute selector: Selects elements based on their attributes, such as <code>[href]</code>, which selects all elements with an <code>href</code> attribute, or <code>[data-id="123"]</code>, which selects elements with a specific value for a <code>data-id</code> attribute.</li>
<li>Combinator selector: Selects elements based on their relationship to other elements, such as <code>div > p</code>, which selects all <code>p</code> elements that are direct children of <code>div</code> elements.</li>
</ul>
<p>By using CSS selectors, you can target specific elements on a webpage and extract the data you need for your web scraping project.</p>
<h2 id="identifying-elements-for-scraping">Identifying elements for scraping</h2>
<p>Before we start scraping data from a website, we need to identify the specific elements on the page that we want to scrape. In order to do this, we need to have a basic understanding of HTML and CSS.</p>
<p>HTML is the markup language used to create web pages. HTML documents consist of a tree of elements, each represented by a pair of opening and closing tags. Elements can have attributes that provide additional information about the element.</p>
<p>CSS is the language used to describe the presentation of HTML documents. CSS selectors are used to target specific HTML elements based on their attributes, class names, and other properties.</p>
<p>To identify elements for scraping, we can use a web browser’s developer tools. Most modern web browsers have a built-in set of developer tools that allow us to inspect the HTML and CSS of a web page. We can use these tools to identify the specific elements on a page that we want to scrape.</p>
<p>Once we have identified the elements we want to scrape, we can use a scraping library like Cheerio to extract the data from the HTML. Cheerio is a fast and efficient library that provides a jQuery-like API for parsing and manipulating HTML documents.</p>
<p>Overall, identifying elements for scraping requires a basic understanding of HTML and CSS, as well as the ability to use a web browser’s developer tools to inspect the structure of a web page.</p>
<h2 id="using-chrome-devtools-for-inspecting-html-and-css">Using Chrome DevTools for inspecting HTML and CSS</h2>
<p>Chrome DevTools is a powerful tool that developers can use to inspect the HTML and CSS of a webpage. It allows you to see the structure of a webpage and identify the elements you want to scrape.</p>
<p>To access Chrome DevTools, simply right-click anywhere on the webpage and select “Inspect”. Alternatively, you can use the keyboard shortcut <code>Ctrl+Shift+I</code> on Windows or <code>Cmd+Shift+I</code> on Mac.</p>
<p>Once DevTools is open, you can use the “Elements” tab to see the HTML structure of the page. You can also hover over an element in the “Elements” tab to see its corresponding location on the page.</p>
<p>To identify elements for scraping, you can use the selector tool. Simply click on the selector tool in the top left of the DevTools window (or use the keyboard shortcut <code>Ctrl+Shift+C</code> on Windows or <code>Cmd+Shift+C</code> on Mac), and then click on the element you want to select. DevTools will automatically generate a selector for that element, which you can use in your scraping code.</p>
<p>It’s important to note that some websites use dynamic HTML and may change their structure based on user interactions or other events. In these cases, it may be necessary to use a headless browser or other tools to simulate user behavior and capture the data you need.</p>
<h1 id="chapter-4-making-http-requests-with-nodejs">Chapter 4: Making HTTP Requests with Node.js</h1>
<h2 id="an-overview-of-http">An overview of HTTP</h2>
<p>HTTP stands for Hypertext Transfer Protocol, which is a protocol used for transmitting data over the internet. It is the foundation of data communication for the World Wide Web. HTTP is a client-server protocol, which means it involves communication between two entities: a client and a server.</p>
<p>The client is typically a web browser that initiates a request for data, and the server is a web server that responds with the requested data. The data is transmitted using a format called Hypertext Markup Language (HTML), which is used to create web pages.</p>
<p>HTTP is a stateless protocol, which means it doesn’t remember any previous requests or responses. Each request/response cycle is independent of any previous ones. The client sends a request to the server, and the server responds with the requested data. The client then decides what to do with the data, such as display it on a web page or use it in another application.</p>
<p>HTTP also supports various methods for requests, such as GET, POST, PUT, and DELETE, which are used for different types of data interactions between the client and the server. Overall, HTTP is a critical component of the internet, and it enables the transfer of information across the web.</p>
<h2 id="using-the-built-in-nodejs-http-module">Using the built-in Node.js HTTP module</h2>
<p>The Node.js <code>http</code> module provides a way to make HTTP requests and handle incoming HTTP traffic. To use it, you first need to require the module in your code:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">*</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">as</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">http</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'http'</span><span style="color: #ABB2BF">;</span></span></code></pre>
<p>Once you have imported the <code>http</code> module, you can use it to create an HTTP server, make HTTP requests, and handle incoming HTTP requests.</p>
<h3 id="creating-an-http-server">Creating an HTTP server</h3>
<p>To create an HTTP server with the <code>http</code> module, you can use the <code>http.createServer()</code> method, which takes a request listener function as an argument. The request listener function is called every time a new HTTP request is received by the server. Here’s an example:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">server</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">http</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">createServer</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">request</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeHead</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">200</span><span style="color: #ABB2BF">, { </span><span style="color: #98C379">'Content-Type'</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'text/plain'</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">write</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Hello, world!'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">end</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">server</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">listen</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">3000</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>In this example, we create an HTTP server that listens on port 3000. When a new HTTP request is received by the server, the request listener function is called. The function takes two arguments: the <code>request</code> object, which contains information about the incoming request, and the <code>response</code> object, which is used to send a response back to the client.</p>
<p>In the request listener function, we set the status code and content type of the response using the <code>response.writeHead()</code> method, write the response body using the <code>response.write()</code> method, and end the response using the <code>response.end()</code> method.</p>
<h3 id="making-an-http-request">Making an HTTP request</h3>
<p>To make an HTTP request with the <code>http</code> module, you can use the <code>http.request()</code> method, which takes an options object and a callback function as arguments. The options object specifies the details of the request, such as the URL and HTTP method, and the callback function is called when the response is received.</p>
<p>Here’s an example of making an HTTP GET request:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">options</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">hostname</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'example.com'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">path</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'/path/to/resource'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">method</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'GET'</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">request</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">http</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">request</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">options</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Status code: </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">statusCode</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data'</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">chunk</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Received data: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">chunk</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">request</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">end</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>In this example, we create an options object that specifies the hostname, path, and HTTP method of the request. We then call <code>http.request()</code> with the options object and a callback function that logs the status code of the response and listens for the <code>data</code> event to receive the response body.</p>
<p>Finally, we call <code>request.end()</code> to send the HTTP request.</p>
<h2 id="using-third-party-libraries-like-axios-and-request">Using third-party libraries like Axios and Request</h2>
<p>In addition to using the built-in HTTP module, you can also use third-party libraries like Axios and Request to make HTTP requests in Node.js. These libraries provide a simpler and more user-friendly API for making requests and handling responses.</p>
<p>Axios is a popular library for making HTTP requests in both Node.js and the browser. It provides a promise-based API that makes it easy to write asynchronous code. Here’s an example of how to use Axios to make an HTTP GET request:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://api.example.com/data'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">  .</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  })</span></span>
<span class="line"><span style="color: #ABB2BF">  .</span><span style="color: #61AFEF">catch</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">error</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span></code></pre>
<p>The <code>get()</code> method of the <code>axios</code> object returns a promise that resolves with a response object. The <code>response.data</code> property contains the response body.</p>
<p>Request is another popular library for making HTTP requests in Node.js. It has been around for a long time and has a well-established API. Here’s an example of how to use Request to make an HTTP GET request:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">request</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'request'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">request</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://api.example.com/data'</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">error</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">body</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">body</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>The <code>request()</code> function takes a URL as its first argument and a callback function as its second argument. The callback function is called with three arguments: an error object (if there was an error), a response object, and the response body.</p>
<p>Both Axios and Request provide a lot of additional functionality, such as handling different types of data, setting headers, and handling redirects. You can refer to their documentation for more information.</p>
<h2 id="handling-different-types-of-responses">Handling different types of responses</h2>
<p>When making HTTP requests, it’s essential to handle different types of responses appropriately. HTTP responses are returned with a status code, a set of headers, and a message body.</p>
<p>The status code indicates the success or failure of the request. A status code in the 2xx range indicates success, while codes in the 4xx and 5xx range indicate errors.</p>
<p>Headers provide additional information about the response, such as content type, content length, and caching directives.</p>
<p>The message body contains the actual data returned by the server. The format of the message body can be HTML, JSON, XML, or any other format supported by the server.</p>
<p>When using Node.js’s built-in HTTP module or third-party libraries like Axios or Request, handling different types of responses involves examining the status code and headers and parsing the message body appropriately.</p>
<p>For example, if the response has a content type of “application/json,” you can use JSON.parse() to parse the message body into a JavaScript object. If the response has a content type of “text/html,” you can use a library like Cheerio to parse the HTML and extract the data you need.</p>
<p>It’s also essential to handle errors appropriately. When making HTTP requests, errors can occur due to network issues, server errors, or other issues. It’s crucial to handle these errors and provide appropriate feedback to the user or take appropriate action programmatically.</p>
<p>Overall, handling different types of responses is a critical part of web scraping and requires careful consideration and attention to detail.</p>
<h1 id="chapter-5-parsing-html-with-cheerio">Chapter 5: Parsing HTML with Cheerio</h1>
<h2 id="introduction-to-cheerio">Introduction to Cheerio</h2>
<p>Cheerio is a fast and lightweight library for parsing and manipulating HTML documents in Node.js. It provides a simple and intuitive API that allows you to select and manipulate elements in an HTML document using CSS selectors, similar to jQuery.</p>
<p>Cheerio is particularly useful for web scraping, as it can easily extract data from HTML documents by selecting elements based on their attributes, classes, and other characteristics.</p>
<p>To use Cheerio in your Node.js application, you first need to install it via NPM:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install cheerio</span></span></code></pre>
<p>Once installed, you can require the <code>cheerio</code> module in your code and use its API to parse and manipulate HTML documents.</p>
<h2 id="parsing-html-documents">Parsing HTML documents</h2>
<p>In web scraping, one of the main tasks is to extract data from HTML documents. HTML stands for Hypertext Markup Language, and it is the standard markup language used to create web pages. HTML documents are structured as a tree of elements, and each element can have attributes and child elements.</p>
<p>To extract data from an HTML document, we need to parse it first. Parsing is the process of analyzing a document and breaking it down into its component parts. There are several ways to parse an HTML document in JavaScript, but one of the most popular and convenient ways is to use a library called Cheerio.</p>
<p>Cheerio is a fast and flexible library for parsing HTML documents and manipulating the resulting data. It provides a jQuery-like syntax for selecting and manipulating elements, which makes it easy to extract the data we need from an HTML document.</p>
<p>To use Cheerio in a Node.js project, we first need to install it using npm:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install cheerio</span></span></code></pre>
<p>After installing Cheerio, we can use it in our code by requiring it:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>We can then load an HTML document into Cheerio by passing it to the <code>load()</code> function:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'&#x3C;html>&#x3C;body>&#x3C;h1>Hello World!&#x3C;/h1>&#x3C;/body>&#x3C;/html>'</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>The <code>load()</code> function returns a Cheerio object, which we can use to select and manipulate elements in the HTML document. For example, to select the <code>&#x3C;h1></code> element and get its text content, we can use the following code:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">h1Text</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'h1'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">h1Text</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// Output: "Hello World!"</span></span></code></pre>
<p>In this example, we used the <code>$()</code> function to select the <code>&#x3C;h1></code> element using a CSS selector, and then used the <code>text()</code> method to get its text content.</p>
<p>Cheerio also provides many other methods for selecting and manipulating elements, such as <code>html()</code>, <code>attr()</code>, <code>addClass()</code>, and <code>removeClass()</code>. We can use these methods to extract data from HTML documents and transform it as needed for our web scraping project.</p>
<h2 id="selecting-elements-with-css-selectors">Selecting elements with CSS selectors</h2>
<p>Cheerio allows us to select HTML elements using CSS selectors, which is a powerful way to locate elements on a web page. The <code>cheerio</code> function takes an HTML string as input and returns a jQuery-like object that we can use to interact with the elements of the page.</p>
<p>Here’s an example of selecting elements using CSS selectors with Cheerio:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">html</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'&#x3C;html>&#x3C;head>&#x3C;title>My page&#x3C;/title>&#x3C;/head>&#x3C;body>&#x3C;h1>Hello world&#x3C;/h1>&#x3C;p>Lorem ipsum&#x3C;/p>&#x3C;/body>&#x3C;/html>'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Select the title element and log its text</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'title'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// Output: "My page"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Select the first paragraph element and log its text</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">paragraph</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'p'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">first</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">paragraph</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// Output: "Lorem ipsum"</span></span></code></pre>
<p>In this example, we use Cheerio to load an HTML string and select the title and first paragraph elements using CSS selectors. We can then retrieve the text of these elements using the <code>text</code> method.</p>
<p>Cheerio supports a wide range of CSS selectors, including tag selectors, class selectors, ID selectors, attribute selectors, and more. You can also use complex selector combinations to target specific elements on the page.</p>
<h2 id="manipulating-html-elements">Manipulating HTML elements</h2>
<p>Once you have selected HTML elements using Cheerio and CSS selectors, you can manipulate them in various ways. Cheerio provides several methods for manipulating HTML elements:</p>
<ul>
<li>
<p><code>.text()</code> method: This method returns the text contents of an element.</p>
</li>
<li>
<p><code>.html()</code> method: This method returns the HTML contents of an element.</p>
</li>
<li>
<p><code>.attr()</code> method: This method is used to get or set the attributes of an element.</p>
</li>
<li>
<p><code>.addClass()</code> method: This method adds a class to the class attribute of an element.</p>
</li>
<li>
<p><code>.removeClass()</code> method: This method removes a class from the class attribute of an element.</p>
</li>
<li>
<p><code>.hasClass()</code> method: This method checks if an element has a specified class.</p>
</li>
<li>
<p><code>.parent()</code> method: This method returns the parent element of an element.</p>
</li>
<li>
<p><code>.children()</code> method: This method returns the child elements of an element.</p>
</li>
<li>
<p><code>.siblings()</code> method: This method returns the sibling elements of an element.</p>
</li>
<li>
<p><code>.next()</code> method: This method returns the next sibling element of an element.</p>
</li>
<li>
<p><code>.prev()</code> method: This method returns the previous sibling element of an element.</p>
</li>
</ul>
<p>Here’s an example of manipulating HTML elements with Cheerio:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrape</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.example.com'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Get the text content of the title element</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'title'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Set the src attribute of an img element</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'img'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'src'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'new-image.jpg'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Add a class to an element</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.button'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">addClass</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'active'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Remove a class from an element</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.button'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">removeClass</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'inactive'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Check if an element has a class</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">hasClass</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.button'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">hasClass</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'active'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Get the parent element of an element</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">parentElement</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'button'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">parent</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Get the child elements of an element</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">childElements</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.container'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">children</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Get the sibling elements of an element</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">siblingElements</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.button'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">siblings</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Get the next sibling element of an element</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextElement</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.button'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">next</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Get the previous sibling element of an element</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">prevElement</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.button'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">prev</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>With these methods, you can easily manipulate HTML elements to extract the data you need.</p>
<h2 id="extracting-data-from-html-elements">Extracting data from HTML elements</h2>
<p>To extract data from HTML elements using Cheerio, you first need to select the element using CSS selectors. Once you have selected the element, you can extract its data using various methods provided by Cheerio.</p>
<p>For example, if you want to extract the text content of a paragraph element, you can select it using its tag name and then call the <code>.text()</code> method on the resulting Cheerio object. Here’s an example:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">html</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'&#x3C;p>Hello, &#x3C;strong>world!&#x3C;/strong>&#x3C;/p>'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">text</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'p'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// Output: "Hello, world!"</span></span></code></pre>
<p>In this example, the HTML string contains a paragraph element with a strong element inside it. We load the HTML into a Cheerio object using <code>cheerio.load()</code>, and then select the paragraph element using its tag name <code>'p'</code>. Finally, we call the <code>.text()</code> method to extract the text content of the element.</p>
<p>Cheerio provides many other methods for extracting data from HTML elements, such as <code>.html()</code> for getting the HTML content of an element, <code>.attr()</code> for getting the value of an attribute, and <code>.data()</code> for getting the data associated with an element. You can also chain multiple methods together to extract nested data.</p>
<h1 id="chapter-6-scraping-data-from-websites">Chapter 6: Scraping Data from Websites</h1>
<h2 id="building-a-simple-web-scraper">Building a simple web scraper</h2>
<p>Let’s start building a simple web scraper using TypeScript and Cheerio.</p>
<p>First, let’s create a new TypeScript file in our project called <code>scraper.ts</code>. We will use this file to write the code for our web scraper.</p>
<p>Next, let’s install the necessary dependencies for our project. We will need the <code>cheerio</code> library to parse the HTML documents and the <code>axios</code> library to make HTTP requests. Open your terminal and navigate to the project directory. Then, run the following command to install the dependencies:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install cheerio axios</span></span></code></pre>
<p>Once the dependencies are installed, we can start writing the code for our web scraper.</p>
<p>Let’s start by making an HTTP request to a website and retrieving its HTML content. We will use the <code>axios</code> library for this. Here’s an example of how to make an HTTP request using <code>axios</code>:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">fetchHTML</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">url</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In this code, we define an <code>async</code> function called <code>fetchHTML</code> that takes a URL as a parameter and returns a <code>Promise</code> that resolves to the HTML content of the webpage. We use the <code>axios</code> library to make an HTTP GET request to the URL and retrieve the HTML content from the response.</p>
<p>Next, we need to parse the HTML content using <code>cheerio</code>. Here’s an example of how to parse HTML using <code>cheerio</code>:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseHTML</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">html</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">CheerioStatic</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In this code, we define a function called <code>parseHTML</code> that takes the HTML content as a parameter and returns a <code>CheerioStatic</code> object. We use the <code>cheerio.load()</code> method to load the HTML content into a <code>CheerioStatic</code> object that we can use to manipulate and extract data from the HTML.</p>
<p>Now that we have a way to fetch and parse HTML content, we can start extracting data from the webpage. Let’s say we want to extract the titles and URLs of all the links on the webpage. We can use CSS selectors to select the elements we’re interested in and extract their attributes. Here’s an example of how to extract the titles and URLs of all the links on the webpage:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrape</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">url</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;{ </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">; </span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> }[]> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">html</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">fetchHTML</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseHTML</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">links</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">links</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">i</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">link</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">link</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">(),</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">: </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">link</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'href'</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">??</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">''</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  }));</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In this code, we define an <code>async</code> function called <code>scrape</code> that takes a URL as a parameter and returns an array of objects containing the titles and URLs of all the links on the webpage. We use the <code>fetchHTML</code> and <code>parseHTML</code> functions we defined earlier to fetch and parse the HTML content of the webpage.</p>
<p>We then use the <code>$('a')</code> selector to select all the <code>a</code> elements on the webpage. We use the <code>.map()</code> method to iterate over each <code>a</code> element and extract its title and URL using the <code>.text()</code> and <code>.attr()</code> methods of the <code>CheerioStatic</code> object. Finally, we return the extracted data as an array of objects.</p>
<p>That’s it! We’ve just built a simple web scraper using TypeScript and Cheerio. We can now run this code using the TypeScript compiler and Node.js to extract data from any webpage we want.</p>
<p>Now run this code using the TypeScript compiler and Node.js to extract data from any webpage we want.</p>
<p>To run the code using the TypeScript compiler, first save the code in a TypeScript file with the <code>.ts</code> extension, such as <code>scraper.ts</code>. Then open a terminal or command prompt, navigate to the directory where the file is saved, and run the following command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">tsc scraper.ts &#x26;&#x26; node scraper.js</span></span></code></pre>
<p>This command will first compile the TypeScript code into JavaScript, and then execute the resulting JavaScript file with Node.js.</p>
<p>You should now see the scraped data outputted to the console. Congratulations, you have successfully built a basic web scraper using TypeScript and Cheerio!</p>
<p>Of course, this is just a simple example, and real-world web scraping projects will be more complex and require additional techniques and tools. But this example demonstrates the basic concepts and workflow of web scraping with TypeScript and Cheerio.</p>
<h2 id="handling-dynamic-websites">Handling dynamic websites</h2>
<p>Handling dynamic websites requires a slightly different approach to web scraping than static websites. In dynamic websites, the content is often loaded asynchronously through JavaScript, which means that the HTML response obtained from an HTTP request may not include all the data we need.</p>
<p>To handle dynamic websites, we need to use a headless browser that can execute JavaScript and load the page fully before we can extract data. A headless browser is essentially a web browser without a graphical user interface. It can be controlled programmatically and can be used to interact with web pages just like a regular web browser.</p>
<p>There are several headless browsers that we can use for web scraping, including Puppeteer, Playwright, and PhantomJS. These browsers are designed specifically for web scraping and come with built-in APIs that we can use to interact with web pages, execute JavaScript, and extract data.</p>
<p>In addition to using a headless browser, we also need to consider the timing of our requests. Since dynamic websites load data asynchronously, we need to ensure that we make our HTTP requests at the appropriate time to obtain all the data we need. We can use tools like <code>await sleep(ms)</code> to wait for a certain amount of time before making a request or use the browser API to wait for specific elements to load before extracting data.</p>
<p>Overall, handling dynamic websites requires a more advanced understanding of web scraping techniques and tools, but with the right approach, we can extract valuable data from even the most complex websites.</p>
<h2 id="dealing-with-anti-scraping-measures">Dealing with anti-scraping measures</h2>
<p>When building web scrapers, it’s important to keep in mind that some websites have measures in place to prevent scraping. These measures can include CAPTCHAs, IP blocking, user agent detection, and other techniques.</p>
<p>To deal with anti-scraping measures, there are a few strategies that can be employed:</p>
<ol>
<li>
<p>Mimic human behavior: Some anti-scraping measures are designed to detect bots by analyzing user behavior. By mimicking human behavior, such as by introducing random delays between requests and varying the order in which pages are scraped, it’s possible to evade some anti-scraping measures.</p>
</li>
<li>
<p>Rotate IP addresses: Some websites block requests from certain IP addresses or IP ranges. By rotating IP addresses, either manually or through a proxy service, it’s possible to evade IP blocking.</p>
</li>
<li>
<p>Use a headless browser: Some websites use JavaScript to load content dynamically, making it difficult to scrape using traditional methods. A headless browser, which can execute JavaScript and render pages like a regular browser, can be used to overcome this challenge.</p>
</li>
<li>
<p>Respect website terms of service: Ultimately, the best way to avoid anti-scraping measures is to respect website terms of service. If a website explicitly prohibits scraping or imposes limits on the frequency or volume of requests, it’s important to comply with these rules.</p>
</li>
</ol>
<p>It’s also important to keep in mind that some anti-scraping measures may be illegal or unethical to bypass, and doing so may result in legal or ethical consequences. It’s always best to consult with legal and ethical experts before engaging in web scraping activities.</p>
<h2 id="scraping-data-from-multiple-pages">Scraping data from multiple pages</h2>
<p>When scraping websites, it is common to encounter data that is spread across multiple pages, either through pagination or infinite scrolling. To scrape data from multiple pages, we can use techniques like recursion, iteration, and promises.</p>
<p>For pagination, we can loop through each page, extract the data we need, and move on to the next page until we have collected all the data. We can use techniques like the <code>await</code> keyword and <code>Promise.all()</code> to ensure that our requests and extractions are done in the correct order.</p>
<p>For infinite scrolling, we need to simulate user interaction by scrolling down the page and making additional requests for data as needed. We can use tools like Puppeteer or Playwright to automate this process and extract data from each new batch of content.</p>
<p>It is important to be aware that some websites may implement anti-scraping measures to prevent automated access. To avoid getting blocked or banned, we can use techniques like rotating user agents, throttling our requests, and respecting website terms of service. We can also use tools like proxies and VPNs to hide our IP address and avoid detection.</p>
<h2 id="scraping-data-from-multiple-websites">Scraping data from multiple websites</h2>
<p>Scraping data from multiple websites is a common task in web scraping. It involves fetching data from different sources, parsing the data, and extracting the relevant information. There are a few considerations to keep in mind when scraping data from multiple websites:</p>
<ol>
<li>
<p>Respect the website’s terms of service: Before scraping data from a website, make sure to review the website’s terms of service. Some websites may prohibit web scraping or have specific requirements for accessing their data.</p>
</li>
<li>
<p>Use appropriate scraping techniques: Depending on the website, you may need to use different scraping techniques. For example, some websites may use dynamic content loading, which requires using a headless browser to simulate user interaction.</p>
</li>
<li>
<p>Handle errors and exceptions: When scraping data from multiple websites, there is a higher chance of encountering errors and exceptions. Make sure to implement error handling and retry mechanisms to ensure that your scraper can recover from these issues.</p>
</li>
<li>
<p>Be mindful of rate limits: Some websites may have rate limits in place to prevent excessive scraping. Make sure to respect these limits and adjust your scraping frequency accordingly.</p>
</li>
</ol>
<p>Overall, scraping data from multiple websites requires careful planning and execution. It’s important to be mindful of legal and technical considerations to ensure that your scraper is efficient, effective, and respectful of the websites you are scraping.</p>
<h1 id="chapter-7-storing-and-analyzing-scraped-data">Chapter 7: Storing and Analyzing Scraped Data</h1>
<h2 id="saving-scraped-data-to-files-and-databases">Saving scraped data to files and databases</h2>
<p>Once you have extracted the data you need, you may want to save it for future use or further analysis. There are several ways to store scraped data, including saving it to files or storing it in databases.</p>
<p>One way to save data to a file is to use Node.js’s built-in file system module, <code>fs</code>. With <code>fs</code>, you can write the scraped data to a file in various formats, such as CSV or JSON.</p>
<p>Here’s an example of how to save scraped data to a CSV file using <code>fs</code>:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">fs</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"fs"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Sample scraped data</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"John Doe"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">35</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">city</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"New York"</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Jane Smith"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">28</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">city</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Los Angeles"</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Bob Johnson"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">42</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">city</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Chicago"</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Convert data to CSV format</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">csv</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"Name,Age,City</span><span style="color: #56B6C2">\n</span><span style="color: #98C379">"</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">(({ </span><span style="color: #E06C75; font-style: italic">name</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">age</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">city</span><span style="color: #ABB2BF"> }) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E06C75">name</span><span style="color: #C678DD">}</span><span style="color: #98C379">,</span><span style="color: #C678DD">${</span><span style="color: #E06C75">age</span><span style="color: #C678DD">}</span><span style="color: #98C379">,</span><span style="color: #C678DD">${</span><span style="color: #E06C75">city</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">join</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"</span><span style="color: #56B6C2">\n</span><span style="color: #98C379">"</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Write CSV data to a file</span></span>
<span class="line"><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFile</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"data.csv"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">csv</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"Data saved to data.csv"</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>This code takes the scraped data as an array of objects, converts it to CSV format, and then saves it to a file named <code>data.csv</code>. Note that the <code>writeFile</code> function is asynchronous and takes a callback function that is called once the file has been written.</p>
<p>Another way to save scraped data is to store it in a database. There are several types of databases you can use for this purpose, including relational databases like MySQL and PostgreSQL, and NoSQL databases like MongoDB and Firebase.</p>
<p>To save data to a database, you will need to use a database driver or ORM (Object-Relational Mapping) library for Node.js. These libraries provide a way to interact with the database using JavaScript code.</p>
<p>Here’s an example of how to save scraped data to a MongoDB database using the <code>mongodb</code> library:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">MongoClient</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"mongodb"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Sample scraped data</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"John Doe"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">35</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">city</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"New York"</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Jane Smith"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">28</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">city</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Los Angeles"</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Bob Johnson"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">42</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">city</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Chicago"</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Connect to the MongoDB database</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">uri</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"mongodb://localhost:27017"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">MongoClient</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">uri</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">connect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">db</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">db</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"mydatabase"</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Insert scraped data into a collection</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">db</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">collection</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"people"</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">insertMany</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Close the database connection</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>This code takes the scraped data as an array of objects, connects to a MongoDB database running on the local machine, and inserts the data into a collection named <code>people</code>. Note that the <code>insertMany</code> function is asynchronous and returns a Promise.</p>
<p>In summary, saving scraped data to files or databases is an important part of web scraping. By saving the data, you can store it for future use or further analysis.</p>
<p>There are various ways to save the scraped data, such as saving it to a file, storing it in a database, or uploading it to a cloud storage service. The choice of storage method depends on the size and nature of the data and the intended use case.</p>
<p>One simple way to save the scraped data is to write it to a file in a format that can be easily read by other programs. For example, you can save the data as a CSV (Comma Separated Values) file, which is a widely used format for tabular data. You can use the built-in <code>fs</code> module in Node.js to write the data to a file:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">fs</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'fs'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// example data to save</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'John Doe'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">30</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">occupation</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Developer'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Jane Doe'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">25</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">occupation</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Designer'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// write the data to a file</span></span>
<span class="line"><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFileSync</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data.csv'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'Name,Age,Occupation</span><span style="color: #56B6C2">\n</span><span style="color: #98C379">'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">forEach</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">appendFileSync</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data.csv'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">name</span><span style="color: #C678DD">}</span><span style="color: #98C379">,</span><span style="color: #C678DD">${</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">age</span><span style="color: #C678DD">}</span><span style="color: #98C379">,</span><span style="color: #C678DD">${</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">occupation</span><span style="color: #C678DD">}</span><span style="color: #56B6C2">\n</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we first define the data to save as an array of objects. We then use the <code>fs.writeFileSync()</code> method to create a new file called <code>data.csv</code> and write the header row. We then use a <code>forEach</code> loop to iterate over each item in the data array and append the values to the file using the <code>fs.appendFileSync()</code> method.</p>
<p>Another way to save the scraped data is to store it in a database. This approach is useful when dealing with large amounts of data that need to be accessed and queried efficiently. Popular databases for web scraping include MongoDB, MySQL, and PostgreSQL.</p>
<p>To store the scraped data in a database, we first need to establish a connection to the database using a client library. For example, we can use the <code>mongodb</code> package to connect to a MongoDB database and insert the data:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">MongoClient</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mongodb'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// example data to save</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'John Doe'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">30</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">occupation</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Developer'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Jane Doe'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">25</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">occupation</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Designer'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// MongoDB connection URI</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">uri</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mongodb://localhost:27017/mydb'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// connect to the database and insert the data</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">MongoClient</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">connect</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">uri</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">db</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">collection</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'mycollection'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">insertMany</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>In this example, we first define the data to save as an array of objects. We then use the <code>MongoClient.connect()</code> method to connect to a MongoDB database running on the local machine. We specify the connection URI as <code>mongodb://localhost:27017/mydb</code>, where <code>mydb</code> is the name of the database to use.</p>
<p>We then use the <code>collection()</code> method to select a collection within the database to store the data. In this case, we use the name <code>mycollection</code>. We then use the <code>insertMany()</code> method to insert the data into the collection. Finally, we close the database connection using the <code>client.close()</code> method.</p>
<p>In conclusion, saving the scraped data is an important part of web scraping. By saving the data, you can store it for future use or further analysis. There are various ways to save the data, including writing it to a file or storing it in a database. The choice of storage method depends on the size and nature of the data and the intended use case.</p>
<h2 id="using-typescript-with-databases">Using TypeScript with databases</h2>
<p>TypeScript is a superset of JavaScript, so any database that can be used with JavaScript can also be used with TypeScript. There are many databases to choose from, including SQL databases like MySQL, PostgreSQL, and Microsoft SQL Server, and NoSQL databases like MongoDB, Couchbase, and Cassandra.</p>
<p>When using TypeScript with databases, it is often helpful to use a database driver or ORM (Object-Relational Mapping) library that provides TypeScript support. These libraries can help simplify database access and provide type safety and other benefits.</p>
<p>Some popular TypeScript-friendly database drivers and ORMs include:</p>
<ul>
<li>
<p>TypeORM: A popular ORM that supports many databases including MySQL, PostgreSQL, SQLite, and MongoDB. TypeORM provides TypeScript support out of the box and allows you to define database models using TypeScript classes.</p>
</li>
<li>
<p>Sequelize: A popular SQL ORM that supports many databases including MySQL, PostgreSQL, and SQLite. Sequelize provides TypeScript support via the <code>@types/sequelize</code> package.</p>
</li>
<li>
<p>Mongoose: A popular MongoDB ORM that provides TypeScript support via the <code>@types/mongoose</code> package.</p>
</li>
<li>
<p>Prisma: A modern ORM that supports many databases including MySQL, PostgreSQL, and SQLite. Prisma provides strong type safety and schema management features.</p>
</li>
</ul>
<p>When using these libraries, you will typically define your database schema using TypeScript classes or interfaces. For example, with TypeORM, you might define a <code>User</code> entity like this:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">@</span><span style="color: #61AFEF">Entity</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  @</span><span style="color: #61AFEF">PrimaryGeneratedColumn</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  @</span><span style="color: #61AFEF">Column</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">firstName</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  @</span><span style="color: #61AFEF">Column</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">lastName</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  @</span><span style="color: #61AFEF">Column</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  @</span><span style="color: #61AFEF">Column</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">password</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>This defines a <code>User</code> entity with four columns: <code>id</code>, <code>firstName</code>, <code>lastName</code>, <code>email</code>, and <code>password</code>. You can then use TypeORM’s query API to interact with the database:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">getRepository</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'typeorm'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">userRepository</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">getRepository</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">User</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">userRepository</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">users</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>This would retrieve all <code>User</code> entities from the database and log them to the console.</p>
<p>Using TypeScript with databases can help catch errors at compile time and provide better type safety and code completion.</p>
<h2 id="cleaning-and-transforming-scraped-data">Cleaning and transforming scraped data</h2>
<p>Cleaning and transforming scraped data is an essential step in the web scraping process. Raw data obtained from web pages may contain irrelevant or inaccurate information, which could affect the quality of the analysis. Therefore, it’s necessary to preprocess the data before using it for further analysis.</p>
<p>There are several techniques for cleaning and transforming scraped data, including:</p>
<ol>
<li>
<p>Removing HTML tags and special characters: Web pages often contain HTML tags and special characters that can make the data difficult to read. Using regular expressions or libraries like BeautifulSoup or Cheerio can help remove these tags and characters.</p>
</li>
<li>
<p>Parsing and formatting data: Depending on the type of data you’re scraping, it may be necessary to parse and format the data to make it more readable or usable. For example, if you’re scraping data from a table, you may need to convert it into a CSV or JSON format.</p>
</li>
<li>
<p>Filtering and selecting data: Sometimes, you may only need to extract specific information from the web page. In this case, you can use filtering techniques to select the relevant data and discard the rest.</p>
</li>
<li>
<p>Handling missing or inconsistent data: Web pages may not always contain complete or consistent data. You may need to handle missing data by either filling in the gaps or discarding the incomplete data altogether.</p>
</li>
<li>
<p>Normalizing data: Normalizing data involves transforming the data into a standardized format. This can make it easier to compare data from different sources or analyze it using statistical techniques.</p>
</li>
</ol>
<p>In TypeScript, you can use various libraries and frameworks to clean and transform scraped data. For example, you can use the following libraries:</p>
<ol>
<li>
<p>Lodash: Lodash is a popular JavaScript utility library that provides many functions for manipulating and formatting data.</p>
</li>
<li>
<p>Moment.js: Moment.js is a JavaScript library for parsing, validating, manipulating, and formatting dates and times.</p>
</li>
<li>
<p>Papa Parse: Papa Parse is a library for parsing and formatting CSV files.</p>
</li>
<li>
<p>Joi: Joi is a schema validation library that can be used to validate and format JSON data.</p>
</li>
</ol>
<p>By using these libraries and techniques, you can preprocess scraped data to make it more usable for further analysis.</p>
<h2 id="analyzing-scraped-data-with-visualization-tools">Analyzing scraped data with visualization tools</h2>
<p>Analyzing scraped data is an essential step in the web scraping process, as it helps in understanding the insights and patterns of the data that have been extracted. One popular tool for visualizing data is the JavaScript library D3.js, which allows for the creation of interactive data visualizations on the web.</p>
<p>Another popular tool is Tableau, a business intelligence and data visualization software that provides a range of tools for data analysis and visualization. Tableau allows users to connect to various data sources, including databases, spreadsheets, and web scraping tools, to create interactive visualizations, dashboards, and reports.</p>
<p>Other data visualization tools include Power BI, Google Data Studio, and matplotlib, a Python library for creating static, animated, and interactive visualizations.</p>
<p>In addition to data visualization tools, there are also tools for cleaning and transforming scraped data, such as OpenRefine, a powerful data cleaning tool that allows for the manipulation and transformation of large datasets. OpenRefine can be used to clean and standardize data, merge and split columns, and transform data from one format to another.</p>
<p>Overall, the use of data visualization and cleaning tools can help in gaining valuable insights from scraped data, making it easier to understand and use in various applications.</p>
<h1 id="chapter-8-advanced-web-scraping-techniques">Chapter 8: Advanced Web Scraping Techniques</h1>
<h2 id="scraping-data-from-apis">Scraping data from APIs</h2>
<p>Scraping data from APIs is similar to scraping data from websites. However, instead of sending an HTTP request to a web page and parsing the HTML response, we send a request to an API and parse the JSON or XML response.</p>
<p>APIs provide a structured way to access data, which can be easier to work with than scraping data from websites. APIs often have documentation that describes how to use them and what data they provide. Additionally, using an API can be more reliable than scraping data from a website since the data is provided in a structured way and is less likely to change.</p>
<p>To scrape data from an API, we first need to find the API endpoint, which is the URL that we will use to make requests to the API. We can usually find the endpoint in the API documentation. We then send an HTTP request to the endpoint and parse the JSON or XML response.</p>
<p>Here is an example of how to scrape data from a hypothetical API that provides information about books:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeBooks</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">apiUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'https://example.com/api/books'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiUrl</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">books</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Do something with the scraped data</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">books</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">scrapeBooks</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>In this example, we use the Axios library to send an HTTP GET request to the API endpoint at <code>https://example.com/api/books</code>. We then parse the JSON response using <code>response.data</code>. The scraped data is stored in the <code>books</code> variable and can be used for further analysis or stored in a database.</p>
<p>It’s important to note that not all APIs allow scraping. Always check the terms of service and API documentation before scraping data from an API. Some APIs may require authentication, such as an API key or OAuth token, to access their data.</p>
<h2 id="handling-pagination-and-infinite-scrolling">Handling pagination and infinite scrolling</h2>
<p>When scraping data from a website, it is common to encounter situations where the data is spread out across multiple pages. To scrape all of the data, it is necessary to handle pagination. Pagination refers to the process of breaking up a large dataset into smaller pages or segments, making it easier to browse or navigate.</p>
<p>There are different methods of pagination, including:</p>
<ol>
<li>
<p>Page numbers: The website displays links to different pages, numbered from 1 to n.</p>
</li>
<li>
<p>Next/previous buttons: The website has buttons to navigate to the next or previous page.</p>
</li>
<li>
<p>Scroll-based pagination: The website loads new content as the user scrolls down the page.</p>
</li>
</ol>
<p>To handle pagination in web scraping, you need to identify the pattern of URLs for each page and then loop through each page to extract the desired data. One way to achieve this is to use a loop that iterates over the pages, incrementing a page number or index until all pages have been scraped.</p>
<p>For example, let’s say we want to scrape a website that lists products across multiple pages. The URLs for each page follow a specific pattern: <code>https://example.com/products?page=1</code>, <code>https://example.com/products?page=2</code>, <code>https://example.com/products?page=3</code>, and so on. We can use a loop to iterate over the pages and extract the data from each page:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapePages</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">startPage</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">endPage</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">for</span><span style="color: #ABB2BF"> (</span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">i</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">startPage</span><span style="color: #ABB2BF">; </span><span style="color: #E06C75">i</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x3C;=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">endPage</span><span style="color: #ABB2BF">; </span><span style="color: #E06C75">i</span><span style="color: #56B6C2">++</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`https://example.com/products?page=</span><span style="color: #C678DD">${</span><span style="color: #E06C75">i</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// Extract data from the page</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Scraped data from page </span><span style="color: #C678DD">${</span><span style="color: #E06C75">i</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">scrapePages</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// Scrape data from pages 1 to 10</span></span></code></pre>
<p>In this example, we start with page 1 and continue until page 10. For each page, we make a request to the URL and load the response into Cheerio for parsing. After extracting the data, we log a message to the console indicating the page that was scraped.</p>
<p>Another way to handle pagination is to use a recursive function that continues to scrape the next page until there are no more pages to scrape. This approach can be useful when the number of pages is unknown or dynamic.</p>
<p>Infinite scrolling is another pagination technique used on many modern websites. Infinite scrolling means that new content is loaded dynamically as the user scrolls down the page, rather than clicking on a link to go to the next page. To handle infinite scrolling in web scraping, you need to use a headless browser like Puppeteer or Playwright to simulate user scrolling and extract the data as it loads. This approach can be more complex than handling traditional pagination, but it can be necessary for scraping certain websites.</p>
<p>Infinite scrolling is a technique used by websites to load additional content dynamically as the user scrolls down the page. This can be a challenge for web scraping, as the additional content is not present in the initial HTML response.</p>
<p>To handle infinite scrolling, we can use headless browsers like Puppeteer or Playwright. These tools can simulate user interactions like scrolling down a page and waiting for new content to load. Once the new content is loaded, we can extract it using Cheerio or other HTML parsing libraries.</p>
<p>Another approach to handling infinite scrolling is to analyze the network requests made by the website and look for requests that fetch additional data. We can then make these requests ourselves using libraries like Axios or Request.</p>
<p>It’s important to note that some websites may have anti-scraping measures in place to prevent automated scraping of their content, including using techniques like rate limiting or CAPTCHAs. It’s important to be aware of these measures and to ensure that your scraping code respects the website’s terms of service.</p>
<p>Overall, handling pagination and infinite scrolling can be a challenge in web scraping, but with the right tools and techniques, it is possible to extract data from even the most complex websites.</p>
<h2 id="working-with-forms-and-user-input">Working with forms and user input</h2>
<p>Web scraping often involves filling out forms and submitting data to extract information from websites. In this section, we will discuss how to handle forms and user input using TypeScript.</p>
<p>When a website requires user input, we need to fill out the form with the appropriate data and submit it to the server. The server then processes the data and returns the desired results.</p>
<p>To handle forms and user input in TypeScript, we can use a combination of HTML parsing, HTTP requests, and data manipulation. Here are the steps involved:</p>
<ol>
<li>Parse the HTML page containing the form using Cheerio or a similar library.</li>
<li>Identify the form element using CSS selectors and extract its attributes, such as the action URL, method, and input fields.</li>
<li>Create an HTTP request to the action URL using Axios or another HTTP library. Use the method specified in the form element (usually GET or POST).</li>
<li>Construct the query string or request body based on the input fields of the form.</li>
<li>Send the HTTP request and handle the response as usual.</li>
</ol>
<p>Let’s take a look at an example. Suppose we want to scrape data from a website that requires us to log in first. The login page contains a form with two input fields, “username” and “password,” and a submit button.</p>
<p>Here’s how we can handle this form using TypeScript:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// URL of the login page</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">loginUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'https://example.com/login'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// User credentials</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'myusername'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">password</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mypassword'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Parse the login page</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">loginUrl</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Find the login form and its input fields</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">form</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'form[action="/login"]'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">usernameField</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">form</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'input[name="username"]'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">passwordField</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">form</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'input[name="password"]'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">submitButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">form</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'button[type="submit"]'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Construct the HTTP request</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">formData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">FormData</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #E5C07B">formData</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">append</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'username'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #E5C07B">formData</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">append</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'password'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">password</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">requestConfig</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">method</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">form</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'method'</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'GET'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">form</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'action'</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">loginUrl</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">formData</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Send the HTTP request and handle the response</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">loginResponse</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">axios</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">requestConfig</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// ...</span></span></code></pre>
<p>In this example, we first make an HTTP GET request to the login page and parse the HTML using Cheerio. We then find the login form and its input fields using CSS selectors. Next, we create a new FormData object and populate it with the username and password values. Finally, we send an HTTP POST request to the form’s action URL with the FormData as the request body.</p>
<p>Note that this is just a simple example, and in real-world scenarios, handling forms and user input can be more complex. We may need to handle cookies, redirects, or CAPTCHAs, among other things. However, the basic process remains the same: parse the HTML, find the form, construct the HTTP request, and send it to the server.</p>
<p>Once you have submitted the form, the server may redirect you to a new page or display the results on the same page. In either case, you need to parse the HTML of the response to extract the desired information.</p>
<p>If the server redirects you to a new page, you can use the same techniques we have discussed earlier to extract the data from the new page. Alternatively, you can inspect the HTTP response headers to see if the server sends any cookies or authentication tokens that you need to include in subsequent requests.</p>
<p>If the server displays the results on the same page, you may need to extract the data from a specific section of the page using CSS selectors or other parsing techniques. For example, if the search results are displayed in a table, you can use Cheerio to extract the table rows and columns and convert them into a structured format such as JSON or CSV.</p>
<p>Handling forms and user input is a common use case for web scraping, especially when you need to automate repetitive tasks such as filling out online surveys or submitting data to web applications. However, it is important to respect the terms of service of the website and avoid overloading the server with too many requests, as this can lead to IP blocking or other anti-scraping measures. In addition, you should always test your scraping scripts on a small subset of data before scaling up to avoid unintended consequences.</p>
<h2 id="using-headless-browsers-for-scraping">Using headless browsers for scraping</h2>
<p>Headless browsers are a popular option for web scraping as they allow you to automate web interactions just like a real user would, but without the need for a graphical interface. This means that you can write scripts to interact with web pages and extract data without the need for manual intervention. Some popular headless browsers include Puppeteer, Playwright, and PhantomJS.</p>
<p>To get started with using headless browsers for web scraping, you’ll need to install the necessary packages and set up a new browser instance. Once you have that in place, you can use the browser’s API to navigate to web pages, interact with the page content, and extract the data you’re interested in.</p>
<p>Here’s an example of how you might use Puppeteer to scrape the title and description of a webpage:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.example.com'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">title</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">description</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'meta[name="description"]'</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Element</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">getAttribute</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'content'</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Title: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">title</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Description: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">description</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">})();</span></span></code></pre>
<p>In this example, we use Puppeteer to launch a new headless browser instance, create a new page, and navigate to the URL <a href="https://www.example.com">https://www.example.com</a>. We then extract the title of the page using the <code>page.title()</code> method, and the description using <code>page.$eval()</code> to select the appropriate HTML element and extract the <code>content</code> attribute.</p>
<p>Once we have the data we’re interested in, we log it to the console and close the browser instance using <code>browser.close()</code>.</p>
<h2 id="handling-errors-and-exceptions-in-web-scraping">Handling errors and exceptions in web scraping</h2>
<p>Handling errors and exceptions is an important part of web scraping as it helps ensure that your script is robust and can handle unexpected situations. Here are some common error scenarios that can occur during web scraping and how to handle them:</p>
<ol>
<li>Network errors: These occur when there is an issue with the internet connection or the target website is down. To handle this, you can use try-catch blocks to catch errors thrown by the browser or network requests.</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">fetch</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.example.com'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">html</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">} </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Network error: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">err</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<ol start="2">
<li>Element not found: This error occurs when you’re trying to select an element on the page that doesn’t exist. To handle this, you can use <code>page.waitForSelector()</code> to wait for the element to appear on the page before selecting it.</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.example.com'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForSelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#my-element'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#my-element'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">} </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Element not found: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">err</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<ol start="3">
<li>Captchas and anti-scraping measures: Some websites use captchas or other anti-scraping measures to prevent automated access. To handle this, you may need to implement a manual intervention step or use third-party services to solve the captcha.</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.example.com'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">captchaElement</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#captcha'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">captchaElement</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// Implement manual intervention step here or use third-party service</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">} </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Error: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">err</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>By handling errors and exceptions in your web scraping script, you can ensure that it runs smoothly and can handle unexpected situations.</p>
<h1 id="chapter-9-best-practices-for-web-scraping-with-typescript">Chapter 9: Best Practices for Web Scraping with TypeScript</h1>
<h2 id="writing-maintainable-and-scalable-scraping-code">Writing maintainable and scalable scraping code</h2>
<p>Writing maintainable and scalable scraping code is important for ensuring that your code is easy to maintain and can handle large amounts of data. Here are some tips for writing maintainable and scalable scraping code:</p>
<ol>
<li>
<p>Use a modular structure: Break your code down into smaller, more manageable pieces. Each module should be responsible for a specific task, such as navigating to a page, extracting data, or storing data. This makes it easier to test and debug your code and allows you to reuse code across different projects.</p>
</li>
<li>
<p>Use a configuration file: Store configuration options, such as the target URL, CSS selectors, or regular expressions, in a separate file. This makes it easier to update your code when the target website changes and allows you to use the same code with different configuration options.</p>
</li>
<li>
<p>Handle errors and exceptions: As mentioned earlier, handling errors and exceptions is important for ensuring that your code is robust and can handle unexpected situations. Use try-catch blocks to catch errors thrown by the browser or network requests and handle them appropriately.</p>
</li>
<li>
<p>Use asynchronous programming: Asynchronous programming allows your code to perform multiple tasks simultaneously, which can improve performance and make your code more scalable. Use the <code>async</code> and <code>await</code> keywords to write asynchronous code that is easy to read and understand.</p>
</li>
<li>
<p>Use a database or file system: Storing data in a database or file system allows you to handle large amounts of data and makes it easier to analyze and visualize the data. Use a database or file system that is well-suited for your specific use case, such as MongoDB for unstructured data or PostgreSQL for structured data.</p>
</li>
<li>
<p>Document your code: Documenting your code is important for making it easy to understand and maintain. Use comments to explain what each section of code does and how it fits into the overall project. Use descriptive variable and function names to make your code easy to read and understand.</p>
</li>
</ol>
<p>By following these best practices, you can write maintainable and scalable scraping code that is easy to understand, test, and maintain.</p>
<h2 id="respecting-website-terms-of-service-and-legal-considerations">Respecting website terms of service and legal considerations</h2>
<p>Respecting website terms of service and legal considerations is essential when it comes to web scraping. Here are some important things to consider:</p>
<ol>
<li>
<p>Read the website’s terms of service: The terms of service for a website can vary widely and may contain specific guidelines about web scraping. It’s important to read and understand the terms of service for each website you want to scrape.</p>
</li>
<li>
<p>Obtain permission if necessary: Some websites may require you to obtain explicit permission before scraping their data. If in doubt, it’s always best to reach out to the website owner and ask for permission before scraping their data.</p>
</li>
<li>
<p>Use ethical scraping practices: Scraping large amounts of data from a website can put a strain on their servers and may violate their terms of service. Use ethical scraping practices such as limiting the number of requests you make and respecting any rate limits or throttling.</p>
</li>
<li>
<p>Respect copyright and intellectual property rights: Be aware of any copyright or intellectual property rights that may apply to the data you’re scraping. It’s important to respect these rights and not use the data in a way that violates them.</p>
</li>
<li>
<p>Protect personal data: Some websites may contain personal data that is protected by data protection laws. It’s important to ensure that you are not collecting or storing this data in a way that violates these laws.</p>
</li>
<li>
<p>Use proxies and user agents: Some websites may block your scraping attempts if they detect too many requests from a single IP address or user agent. To avoid this, consider using proxies and rotating user agents.</p>
</li>
<li>
<p>Be transparent: Be transparent about your scraping activities and how you plan to use the data. Provide clear information about what data you’re collecting and how you plan to use it.</p>
</li>
</ol>
<p>By respecting website terms of service and legal considerations, you can avoid legal issues and ensure that your scraping activities are ethical and sustainable.</p>
<h2 id="dealing-with-anti-scraping-measures-1">Dealing with anti-scraping measures</h2>
<p>Dealing with anti-scraping measures is an important consideration for any web scraping project. Here are some common anti-scraping measures and how to deal with them:</p>
<ol>
<li>
<p>Captchas: Captchas are designed to prevent automated bots from accessing a website. If you encounter a captcha, you will need to solve it manually or use a captcha solving service. Captcha solving services use machine learning algorithms to automatically solve captchas, but they can be expensive.</p>
</li>
<li>
<p>IP blocking: Some websites may block your IP address if they detect too many requests coming from it. To avoid this, consider using a rotating proxy service that can automatically switch between different IP addresses.</p>
</li>
<li>
<p>User agent blocking: Some websites may block requests from certain user agents or browsers. To avoid this, consider rotating user agents or using a headless browser that can simulate different user agents.</p>
</li>
<li>
<p>JavaScript rendering: Some websites may use JavaScript to dynamically load content, which can be difficult to scrape using traditional scraping tools. To scrape JavaScript-rendered content, consider using a headless browser or a tool like Puppeteer that can render JavaScript content.</p>
</li>
<li>
<p>Throttling and rate limiting: Some websites may limit the number of requests you can make within a certain period of time. To avoid being throttled or rate limited, consider implementing a delay between requests or using a proxy service to spread your requests across multiple IP addresses.</p>
</li>
</ol>
<p>It’s important to note that some anti-scraping measures may be in place for a good reason, such as protecting user privacy or preventing abuse of the website. When scraping a website, it’s important to respect their terms of service and use ethical scraping practices to avoid being blocked or banned.</p>
<h2 id="testing-and-debugging-web-scraping-applications">Testing and debugging web scraping applications</h2>
<p>Testing and debugging are important aspects of any software development project, and web scraping is no exception. Here are some tips for testing and debugging web scraping applications:</p>
<ol>
<li>
<p>Start with small test cases: When testing your web scraping application, start with small test cases to ensure that the basic functionality is working correctly. This will allow you to catch any errors early on and ensure that your application is working as expected.</p>
</li>
<li>
<p>Use test data: It’s important to use test data that is representative of the data you will be scraping in your application. This will allow you to test your application with realistic data and catch any errors that may occur.</p>
</li>
<li>
<p>Test edge cases: Test your application with edge cases, such as websites that have a large number of pages or data that is structured differently than expected. This will help you identify any potential issues with your application and ensure that it can handle unexpected scenarios.</p>
</li>
<li>
<p>Use logging and debugging tools: Logging and debugging tools can be extremely helpful when testing and debugging web scraping applications. Use tools like console logs or browser extensions to help you understand what’s happening under the hood and identify any issues that may arise.</p>
</li>
<li>
<p>Handle errors gracefully: Make sure your application handles errors gracefully by catching exceptions and displaying meaningful error messages. This will help users understand what went wrong and how to fix the issue.</p>
</li>
<li>
<p>Test with different environments: Test your application in different environments, such as different operating systems or browsers. This will help you ensure that your application is compatible with different setups and can handle different scenarios.</p>
</li>
</ol>
<p>By following these tips, you can ensure that your web scraping application is thoroughly tested and free of errors before it goes into production.</p>
<h2 id="deploying-web-scraping-applications-to-production-environments">Deploying web scraping applications to production environments</h2>
<p>Deploying a web scraping application to a production environment requires careful planning and consideration. Here are some tips for deploying web scraping applications to production environments:</p>
<ol>
<li>
<p>Choose a reliable hosting provider: When deploying your web scraping application, choose a reliable hosting provider that can handle the traffic and provide the necessary resources for your application to run smoothly.</p>
</li>
<li>
<p>Use version control: Use version control tools like Git to keep track of changes to your application and ensure that you can roll back to a previous version if necessary.</p>
</li>
<li>
<p>Secure your application: Make sure your application is secure by implementing measures like HTTPS, user authentication, and encryption of sensitive data. This will help protect your application from attacks and ensure the privacy of your users’ data.</p>
</li>
<li>
<p>Use automation tools: Use automation tools like Ansible, Chef, or Docker to automate the deployment process and ensure that your application is deployed consistently across different environments.</p>
</li>
<li>
<p>Monitor your application: Monitor your application using tools like New Relic, Datadog, or Nagios to ensure that it’s running smoothly and detect any issues before they become critical.</p>
</li>
<li>
<p>Respect website policies: Make sure your web scraping application respects the website’s policies and terms of service. If a website requests that you stop scraping their data, make sure to comply with their request.</p>
</li>
<li>
<p>Implement rate limiting: Implement rate limiting in your application to ensure that you’re not overloading the website with too many requests at once.</p>
</li>
</ol>
<p>By following these tips, you can ensure that your web scraping application is deployed safely and effectively in a production environment. Remember to test your application thoroughly before deploying it to production and to follow best practices for web scraping to ensure that you’re respecting the websites you’re scraping.</p>
<h1 id="chapter-10-case-studies">Chapter 10: Case Studies</h1>
<h2 id="real-world-examples-of-web-scraping-applications-built-with-typescript">Real-world examples of web scraping applications built with TypeScript</h2>
<p>There are many real-world examples of web scraping applications built with TypeScript. Here are a few examples:</p>
<ol>
<li>
<p>Scraping job listings: Many job websites like Indeed, Glassdoor, and LinkedIn provide job listings that can be scraped using web scraping techniques. TypeScript can be used to build robust and scalable web scrapers that extract job listings and other relevant data from these websites.</p>
</li>
<li>
<p>Scraping e-commerce product data: E-commerce websites like Amazon, Walmart, and Target provide a wealth of product data that can be scraped and used for price comparison and other applications. TypeScript can be used to build web scrapers that extract product data, such as product names, descriptions, prices, and reviews.</p>
</li>
<li>
<p>Scraping social media data: Social media websites like Twitter, Instagram, and Facebook provide a vast amount of data that can be scraped and used for social listening, sentiment analysis, and other applications. TypeScript can be used to build web scrapers that extract data, such as posts, comments, likes, and followers.</p>
</li>
<li>
<p>Scraping news articles: News websites like CNN, BBC, and Reuters provide a wealth of news articles that can be scraped and used for analysis and other applications. TypeScript can be used to build web scrapers that extract news articles and other relevant data, such as article titles, authors, dates, and categories.</p>
</li>
<li>
<p>Scraping weather data: Weather websites like AccuWeather, Weather.com, and NOAA provide weather data that can be scraped and used for analysis and other applications. TypeScript can be used to build web scrapers that extract weather data, such as current temperature, humidity, wind speed, and forecast.</p>
</li>
</ol>
<p>These are just a few examples of web scraping applications that can be built with TypeScript. With the power and flexibility of TypeScript, the possibilities are endless when it comes to building robust and scalable web scrapers for a variety of real-world applications.</p>
<h2 id="discussion-of-challenges-faced-and-solutions-implemented-in-each-case-study">Discussion of challenges faced and solutions implemented in each case study</h2>
<p>Let’s discuss the challenges faced and solutions implemented in each of the case studies mentioned:</p>
<ol>
<li>
<p>Scraping job listings: One of the main challenges faced when scraping job listings is that many job websites use anti-scraping measures to prevent automated scraping. To overcome this challenge, web scrapers can implement various techniques such as rate-limiting, rotating IP addresses, using headless browsers, and implementing random delays between requests to avoid being detected by anti-scraping measures. Additionally, scraping job listings may require implementing complex logic to navigate through job search pages, filter job listings, and extract relevant data such as job titles, descriptions, salaries, and locations.</p>
</li>
<li>
<p>Scraping e-commerce product data: Scraping e-commerce websites can be challenging as the data is often scattered across different pages, and some websites use dynamic content that requires rendering using JavaScript. To overcome this challenge, web scrapers can use headless browsers such as Puppeteer or Playwright to render dynamic content and extract the data using XPath or CSS selectors. Additionally, e-commerce websites may use CAPTCHAs or other anti-scraping measures to prevent automated scraping, so web scrapers must implement techniques such as rate-limiting, proxy rotation, and solving CAPTCHAs using third-party services.</p>
</li>
<li>
<p>Scraping social media data: Scraping social media data is challenging as most social media websites have strict policies that prohibit scraping user data without explicit consent. Additionally, social media websites may use anti-scraping measures such as rate-limiting and CAPTCHAs to prevent automated scraping. To overcome these challenges, web scrapers can use APIs provided by social media platforms, which provide access to user data in a structured and legal manner. However, not all social media platforms provide APIs, and some APIs may have usage limitations or require payment. In such cases, web scrapers can use various techniques such as rate-limiting, proxy rotation, and using headless browsers to scrape data without getting detected.</p>
</li>
<li>
<p>Scraping news articles: Scraping news articles can be challenging as the data is often scattered across different pages and may require navigating through pagination links and category pages. Additionally, news websites may use anti-scraping measures such as CAPTCHAs and rate-limiting to prevent automated scraping. To overcome these challenges, web scrapers can implement techniques such as using headless browsers, using XPath or CSS selectors to extract data, and implementing rate-limiting and proxy rotation to avoid being detected by anti-scraping measures.</p>
</li>
<li>
<p>Scraping weather data: Scraping weather data can be challenging as the data is often real-time and dynamic and may require rendering using JavaScript. Additionally, weather websites may use anti-scraping measures such as CAPTCHAs and rate-limiting to prevent automated scraping. To overcome these challenges, web scrapers can use headless browsers to render dynamic content, implement techniques such as rate-limiting and proxy rotation, and use APIs provided by weather services to access weather data in a structured and legal manner.</p>
</li>
</ol>
<p>In summary, web scraping presents various challenges, including anti-scraping measures, dynamic content, and data scattered across different pages. However, web scrapers can overcome these challenges by implementing various techniques such as rate-limiting, proxy rotation, using headless browsers, and using APIs provided by websites in a structured and legal manner.</p>
<p>It is also important to note that web scraping should always be done ethically and legally, and web scrapers should respect website terms of service and data privacy laws. Failure to do so can result in legal consequences and damage to reputation. Therefore, web scrapers should always obtain explicit consent from website owners before scraping their websites and should always use the scraped data responsibly and within legal boundaries.</p>
<p>In conclusion, web scraping is a powerful tool for extracting valuable data from websites, and TypeScript provides a robust and scalable framework for building web scraping applications. However, web scraping presents various challenges that require careful consideration and implementation of best practices to ensure successful and ethical scraping. With proper planning, testing, and execution, web scraping can provide valuable insights and data for various industries, including e-commerce, finance, and marketing.</p>
<h2 id="lessons-learned-and-best-practices-applied-in-each-case-study">Lessons learned and best practices applied in each case study</h2>
<p>Let’s discuss some of the best practices and lessons learned from the case studies mentioned:</p>
<ol>
<li>
<p>Scraping job listings: One of the best practices when scraping job listings is to implement robust error handling and logging mechanisms to capture errors and exceptions that may occur during scraping. Additionally, web scrapers should implement techniques such as random delays and proxy rotation to avoid being detected by anti-scraping measures. Finally, web scrapers should ensure that the extracted data is accurate and relevant by implementing quality assurance checks such as data validation and cleaning.</p>
</li>
<li>
<p>Scraping e-commerce product data: One of the best practices when scraping e-commerce websites is to use headless browsers such as Puppeteer or Playwright to render dynamic content and extract the data using XPath or CSS selectors. Additionally, web scrapers should implement techniques such as rate-limiting, proxy rotation, and solving CAPTCHAs using third-party services. Finally, web scrapers should ensure that the extracted data is accurate and complete by implementing quality assurance checks such as data validation and cleaning.</p>
</li>
<li>
<p>Scraping social media data: One of the best practices when scraping social media data is to use APIs provided by social media platforms, which provide access to user data in a structured and legal manner. Additionally, web scrapers should ensure that they comply with website terms of service and data privacy laws and obtain explicit consent from website owners before scraping their websites. Finally, web scrapers should implement techniques such as rate-limiting and proxy rotation to avoid being detected by anti-scraping measures.</p>
</li>
<li>
<p>Scraping news articles: One of the best practices when scraping news articles is to use headless browsers to navigate through pagination links and category pages and extract the data using XPath or CSS selectors. Additionally, web scrapers should implement techniques such as rate-limiting and proxy rotation to avoid being detected by anti-scraping measures. Finally, web scrapers should ensure that the extracted data is accurate and relevant by implementing quality assurance checks such as data validation and cleaning.</p>
</li>
<li>
<p>Scraping weather data: One of the best practices when scraping weather data is to use APIs provided by weather services, which provide access to weather data in a structured and legal manner. Additionally, web scrapers should implement techniques such as rate-limiting and proxy rotation to avoid being detected by anti-scraping measures. Finally, web scrapers should ensure that the extracted data is accurate and complete by implementing quality assurance checks such as data validation and cleaning.</p>
</li>
</ol>
<p>In summary, the best practices when building web scraping applications include implementing error handling and logging mechanisms, using headless browsers and APIs where possible, complying with website terms of service and data privacy laws, implementing quality assurance checks, and avoiding being detected by anti-scraping measures by implementing rate-limiting and proxy rotation. By following these best practices, web scrapers can build robust and scalable web scraping applications that provide valuable insights and data for various industries.</p>
<p>Another best practice when building web scraping applications is to document the scraping process and the data sources used, including the frequency of data updates, the data format, and any changes to the data structure. This documentation can help in troubleshooting and maintaining the web scraping application, as well as ensuring compliance with legal and ethical guidelines.</p>
<p>Additionally, it’s important to consider the scalability of the web scraping application. As the amount of data to be scraped grows, the performance and scalability of the application become critical. One way to improve the performance and scalability of a web scraping application is to use distributed computing techniques such as parallel processing, load balancing, and task scheduling.</p>
<p>Another consideration is data storage and management. The extracted data should be stored in a structured and organized manner, with appropriate indexing and querying capabilities. It’s also important to regularly clean and validate the data to ensure accuracy and completeness.</p>
<p>Finally, when deploying a web scraping application to a production environment, it’s important to consider security measures such as user authentication and access control, encryption of sensitive data, and regular security audits.</p>
<p>In summary, building maintainable and scalable web scraping applications requires a combination of best practices such as error handling, documentation, scalability, data storage and management, and security considerations. By following these best practices, web scrapers can ensure successful and ethical scraping, provide valuable data insights, and avoid legal consequences and damage to reputation.</p>
<h1 id="chapter-11-web-scraping-techniques-with-puppeteer">Chapter 11: Web Scraping Techniques with Puppeteer</h1>
<h2 id="implementing-authentication-with-puppeteer">Implementing authentication with Puppeteer</h2>
<p>Here’s an overview of implementing authentication with Puppeteer:</p>
<p>Logging in with Puppeteer:
When it comes to logging in to a website using Puppeteer, the process can be broken down into a few steps:</p>
<ol>
<li>Navigate to the login page of the website using <code>page.goto()</code>.</li>
<li>Fill in the login form fields using <code>page.type()</code> or <code>page.click()</code>.</li>
<li>Submit the login form using <code>page.click()</code> or <code>page.evaluate()</code>.</li>
</ol>
<p>Here’s an example of how to login to a website using Puppeteer:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://example.com/login'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Fill in login form fields</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#username'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'myusername'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#password'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'mypassword'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Submit the login form</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">all</span><span style="color: #ABB2BF">([</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForNavigation</span><span style="color: #ABB2BF">(), </span><span style="color: #7F848E; font-style: italic">// wait for the page to reload</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#login-button'</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">  ]);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Verify that the user is logged in</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">isLoggedIn</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">evaluate</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">document</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#username'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">!==</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Is logged in? </span><span style="color: #C678DD">${</span><span style="color: #E06C75">isLoggedIn</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">})();</span></span></code></pre>
<p>Handling OAuth and Two-Factor Authentication:
OAuth and Two-Factor Authentication (2FA) can present additional challenges when it comes to web scraping and authentication. OAuth involves redirecting the user to a third-party website for authentication, while 2FA requires the user to enter a second form of authentication after entering their login credentials.</p>
<p>To handle OAuth authentication, you can use Puppeteer’s <code>page.waitForNavigation()</code> method to wait for the user to be redirected back to your website after authenticating with the third-party service.</p>
<p>To handle 2FA authentication, you can use Puppeteer to automate the process of entering the second form of authentication. This can involve filling in a code sent via SMS or email, or entering a code generated by an authenticator app.</p>
<p>Here’s an example of how to handle 2FA authentication with Puppeteer:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://example.com/login'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Fill in login form fields</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#username'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'myusername'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#password'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'mypassword'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Submit the login form</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">all</span><span style="color: #ABB2BF">([</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForNavigation</span><span style="color: #ABB2BF">(), </span><span style="color: #7F848E; font-style: italic">// wait for the page to reload</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#login-button'</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">  ]);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Check if 2FA is required</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">is2FARequired</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">evaluate</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">codeInput</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">document</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#2fa-code'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">codeInput</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">!==</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">is2FARequired</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// Enter the 2FA code</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">code</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">getCodeFromUser</span><span style="color: #ABB2BF">(); </span><span style="color: #7F848E; font-style: italic">// This function prompts the user for the 2FA code</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#2fa-code'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">code</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#submit-2fa-code'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Verify that the user is logged in</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">isLoggedIn</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">evaluate</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">document</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#username'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">!==</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Is logged in? </span><span style="color: #C678DD">${</span><span style="color: #E06C75">isLoggedIn</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">})();</span></span></code></pre>
<p>Note that this is just a basic example, and in practice, you’ll want to handle errors and edge cases more carefully. Additionally, for security reasons, it’s generally not a good idea to hard-code login credentials or 2FA codes in your code,</p>
<p>so we will explore some strategies for handling authentication in a more secure and flexible way.</p>
<h2 id=""></h2>
<h2 id="handling-oauth">Handling OAuth</h2>
<p>OAuth is a common authentication protocol used by many websites and web applications. With OAuth, a user can grant a third-party application access to their account without giving out their login credentials. Instead, the user is redirected to the OAuth provider’s website, where they can grant or deny the application’s request for access.</p>
<p>To handle OAuth authentication with Puppeteer, we need to perform the following steps:</p>
<ol>
<li>Navigate to the OAuth provider’s website and click the button to start the OAuth process.</li>
<li>Enter the user’s login credentials (if required).</li>
<li>Grant or deny the application’s request for access.</li>
<li>Capture the OAuth token from the redirect URL.</li>
</ol>
<p>Here’s an example of how to implement OAuth authentication with Puppeteer:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">getOAuthToken</span><span style="color: #ABB2BF">(): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Navigate to the OAuth provider's website</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://oauth-provider.com'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Click the button to start the OAuth process</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#oauth-button'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Wait for the login page to load</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForSelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#login-form'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Enter the user's login credentials</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#username-input'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'user@example.com'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#password-input'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'password123'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Submit the login form</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#login-button'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Wait for the OAuth grant page to load</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForSelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#grant-form'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Grant or deny the application's request for access</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#grant-button'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Wait for the OAuth redirect to complete</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForNavigation</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Capture the OAuth token from the redirect URL</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">redirectUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">url</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">oauthToken</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">URLSearchParams</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">redirectUrl</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">split</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#'</span><span style="color: #ABB2BF">)[</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">]).</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'access_token'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">oauthToken</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>This function launches a new Puppeteer browser instance, navigates to the OAuth provider’s website, logs in with the user’s credentials (if required), grants or denies the application’s request for access, and captures the OAuth token from the redirect URL.</p>
<h2 id="-1"></h2>
<h2 id="handling-two-factor-authentication">Handling Two-Factor Authentication</h2>
<p>Two-factor authentication (2FA) is an additional layer of security that requires a user to provide two forms of authentication (such as a password and a verification code) to access their account. Many websites and web applications use 2FA to protect user accounts from unauthorized access.</p>
<p>To handle 2FA with Puppeteer, we need to perform the following steps:</p>
<ol>
<li>Navigate to the login page and enter the user’s login credentials.</li>
<li>Wait for the 2FA page to load.</li>
<li>Send the user’s verification code to the input field on the 2FA page.</li>
<li>Submit the 2FA form and wait for the login to complete.</li>
</ol>
<p>Here’s an example of how to implement 2FA authentication with Puppeteer:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">loginWith2FA</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">username</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">password</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">verificationCode</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">void</span><span style="color: #ABB2BF">> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Navigate to the login page</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://example.com/login'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Enter the user's login credentials</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#username-input'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#password-input'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">password</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Submit the login form</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#login-button'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Wait for the 2FA page to load</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForSelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#2fa-form'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Enter the verification code</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#verification-code-input'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">verificationCode</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Submit the 2FA form</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#submit-verification-code-button'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Wait for the login to complete</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForNavigation</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Close the browser</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<h2 id="handling-headless-browsing-with-puppeteer">Handling Headless Browsing with Puppeteer</h2>
<p>Puppeteer provides an option to run the browser in headless mode, which means the browser runs in the background without a graphical interface. Headless browsing can help reduce resource usage and increase the speed of the scraping process. To enable headless browsing, set the <code>head option to </code>true` when launching the browser:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">headless</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF"> });</span></span></code></pre>
<h2 id="setting-up-a-proxy-with-puppeteer">Setting up a Proxy with Puppeteer</h2>
<p>Using a proxy can help hide your IP address and avoid getting blocked by a website. Puppeteer provides an option to configure a proxy for the browser when launching it:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">args</span><span style="color: #ABB2BF">: [</span><span style="color: #98C379">`--proxy-server=</span><span style="color: #C678DD">${</span><span style="color: #E06C75">proxyUrl</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">],</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>Here, <code>proxyUrl</code> is the URL of the proxy server. You can also set up authentication for the proxy server if necessary.</p>
<h2 id="bypassing-captcha-with-puppeteer">Bypassing CAPTCHA with Puppeteer</h2>
<p>CAPTCHA (Completely Automated Public Turing test to tell Computers and Humans Apart) is a common anti-bot measure used by websites to prevent automated scraping. However, Puppeteer can be used to bypass some CAPTCHAs by automating the solving process.</p>
<p>One common method is to use a third-party CAPTCHA solving service, such as 2captcha or Anti-Captcha. You can send the CAPTCHA image to the service and receive a solution in return, which can then be used to complete the login process.</p>
<p>Another method is to use machine learning algorithms to train a model to solve the CAPTCHA. However, this requires a significant amount of data and computing resources and may not be feasible for smaller projects.</p>
<p>It’s important to note that bypassing CAPTCHAs may be against the terms of service of some websites and may result in legal action. It’s always best to check the website’s policies and only use automated scraping methods with permission.</p>
<h2 id="introduction-to-puppeteer-cluster">Introduction to Puppeteer cluster</h2>
<p>When building web scrapers, it’s common to face the problem of scalability. As the amount of data to be scraped increases, a single Puppeteer instance may not be enough to handle the load efficiently. That’s where Puppeteer cluster comes in.</p>
<p>Puppeteer cluster is a library that allows you to create clusters of Puppeteer instances that can work together to handle large amounts of data. The library takes care of the communication between the instances, distributing the workload, and monitoring errors.</p>
<h2 id="creating-a-cluster-of-browsers">Creating a cluster of browsers</h2>
<p>To create a cluster of browsers with Puppeteer cluster, you first need to install the library by running the following command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">install</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">puppeteer-cluster</span></span></code></pre>
<p>Once you’ve installed the library, you can create a cluster of browsers by creating an instance of the <code>Cluster</code> class:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">Cluster</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer-cluster'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cluster</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Cluster</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">concurrency</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Cluster</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">CONCURRENCY_CONTEXT</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">maxConcurrency</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we’re creating a cluster with a maximum concurrency of 10. This means that the cluster can handle up to 10 tasks simultaneously. We’re also using <code>Cluster.CONCURRENCY_CONTEXT</code>, which means that each task will have its own context. This is useful for isolating tasks from each other.</p>
<h2 id="distributing-tasks-across-the-cluster">Distributing tasks across the cluster</h2>
<p>To distribute tasks across the cluster, you can use the <code>queue</code> method of the cluster instance:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #E5C07B">cluster</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">queue</span><span style="color: #ABB2BF">(</span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> ({ </span><span style="color: #E06C75; font-style: italic">page</span><span style="color: #ABB2BF"> }) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://example.com'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">title</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we’re queuing a task that navigates to the <code>https://example.com</code> website and logs its title to the console. The task is passed a <code>page</code> object, which is a Puppeteer page instance that belongs to one of the browsers in the cluster.</p>
<h2 id="monitoring-and-handling-errors-in-the-cluster">Monitoring and handling errors in the cluster</h2>
<p>To monitor and handle errors in the cluster, you can use the <code>on</code> method of the cluster instance:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #E5C07B">cluster</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'taskerror'</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">data</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Error crawling </span><span style="color: #C678DD">${</span><span style="color: #E06C75">data</span><span style="color: #C678DD">}</span><span style="color: #98C379">: </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">err</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">message</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">cluster</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'error'</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Cluster error: </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">err</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">message</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">cluster</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'close'</span><span style="color: #ABB2BF">, () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Cluster closed'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we’re handling the <code>taskerror</code>, <code>error</code>, and <code>close</code> events. The <code>taskerror</code> event is emitted when a task throws an error. The <code>error</code> event is emitted when the cluster encounters an error that’s not related to a task. The <code>close</code> event is emitted when the cluster is closed.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Puppeteer cluster is a powerful library that allows you to build scalable web scraping applications with Puppeteer. By creating a cluster of browsers, you can distribute the workload and handle errors more efficiently.</p>
<p>Another advantage of using Puppeteer cluster is that it allows you to monitor the status of the cluster and handle errors more effectively. When scraping multiple pages or websites, it’s common to encounter errors such as timeouts, network errors, or pages that are not properly loaded. With Puppeteer cluster, you can handle these errors gracefully and ensure that your scraping job continues running smoothly.</p>
<p>To monitor the status of the cluster, you can listen to events such as <code>taskerror</code>, <code>taskstart</code>, <code>taskfinished</code>, and <code>idle</code>. For example, to log the progress of your scraping job, you can listen to the <code>taskfinished</code> event and increment a counter each time a task is completed:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #E5C07B">cluster</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'taskfinished'</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">task</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">result</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Task </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">task</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #C678DD">}</span><span style="color: #98C379"> finished with result: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">result</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">counter</span><span style="color: #56B6C2">++</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>To handle errors, you can listen to the <code>taskerror</code> event and retry the task a certain number of times before giving up:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #E5C07B">cluster</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'taskerror'</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">task</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Task </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">task</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #C678DD">}</span><span style="color: #98C379"> failed with error: </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">err</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">message</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">task</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">retry</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x3C;</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">maxRetries</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Retrying task </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">task</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #C678DD">}</span><span style="color: #98C379"> (</span><span style="color: #C678DD">${</span><span style="color: #E5C07B">task</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">retry</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span><span style="color: #C678DD">}</span><span style="color: #98C379">/</span><span style="color: #C678DD">${</span><span style="color: #E06C75">maxRetries</span><span style="color: #C678DD">}</span><span style="color: #98C379">)`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">cluster</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">queue</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">task</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">priority</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">task</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">priority</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">retry</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">task</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">retry</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Giving up on task </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">task</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">counter</span><span style="color: #56B6C2">++</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we retry the task up to <code>maxRetries</code> times before giving up. Each time the task fails, we increment the <code>retry</code> counter, which is passed as an option to the <code>cluster.queue</code> method. If the task fails <code>maxRetries</code> times, we give up and increment the <code>counter</code> variable to ensure that the scraping job can terminate when all tasks have been processed.</p>
<p>By using Puppeteer cluster to handle headless browsing and distribute tasks across multiple browsers, you can build scalable web scrapers that can handle large amounts of data with ease. The cluster module provides a flexible and powerful framework for building complex scraping workflows, while ensuring that your code is maintainable and easy to debug.</p>
<h2 id="parsing-and-cleaning-scraped-data-with-typescript">Parsing and cleaning scraped data with TypeScript</h2>
<p>When web scraping, the data obtained from websites is often in an unstructured format and requires parsing and cleaning before it can be used for further analysis or stored in a database. TypeScript provides powerful tools for parsing and manipulating strings and objects, making it an ideal language for cleaning and transforming scraped data.</p>
<p>One common technique for parsing data is to use regular expressions (regex). Regex is a pattern-matching language that allows you to search for and extract specific pieces of data from a string. TypeScript provides built-in support for regex with the <code>RegExp</code> class.</p>
<p>For example, let’s say we’ve scraped a webpage that contains a list of names and email addresses. We can use regex to extract the email addresses from the string:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"John Doe: john.doe@example.com, Jane Smith: jane.smith@example.com"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">regex</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #E06C75"> /</span><span style="color: #C678DD">\b</span><span style="color: #D19A66">[A-Z0-9</span><span style="color: #E06C75">.</span><span style="color: #D19A66">_%+-]+</span><span style="color: #E06C75">@</span><span style="color: #D19A66">[A-Z0-9</span><span style="color: #E06C75">.</span><span style="color: #D19A66">-]+</span><span style="color: #56B6C2">\.</span><span style="color: #D19A66">[A-Z]{2,}</span><span style="color: #C678DD">\b</span><span style="color: #E06C75">/</span><span style="color: #C678DD">gi</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">emails</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">match</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">regex</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">emails</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// ["john.doe@example.com", "jane.smith@example.com"]</span></span></code></pre>
<p>In this example, we define a regex pattern that matches valid email addresses, and then use the <code>match()</code> method to find all matches in the <code>data</code> string. The resulting <code>emails</code> array contains the extracted email addresses.</p>
<p>In addition to regex, TypeScript provides a variety of string methods for manipulating and cleaning data. For example, the <code>trim()</code> method removes whitespace from the beginning and end of a string, while the <code>replace()</code> method can be used to replace specific characters or patterns within a string.</p>
<p>Let’s say we’ve scraped a webpage that contains a list of product names and prices, but the prices include currency symbols and commas that we want to remove before storing the data:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"Product A: $1,000.00, Product B: €750.00, Product C: ¥100,000.00"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cleanedData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">replace</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">/</span><span style="color: #D19A66">[</span><span style="color: #ABB2BF">^</span><span style="color: #E06C75">\d.</span><span style="color: #D19A66">-]</span><span style="color: #E06C75">/</span><span style="color: #C678DD">g</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">''</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">cleanedData</span><span style="color: #ABB2BF">); </span><span style="color: #7F848E; font-style: italic">// "1000.00 750.00 100000.00"</span></span></code></pre>
<p>In this example, we use the <code>replace()</code> method with a regex pattern that matches any character that is not a digit, period, or minus sign. This removes all currency symbols and commas from the string, leaving us with a cleaned data string that can be further processed or stored in a database.</p>
<p>Overall, TypeScript provides a wide range of tools for parsing and cleaning scraped data, allowing you to transform unstructured data into a usable format for further analysis or storage.</p>
<h2 id="transforming-scraped-data-into-usable-formats">Transforming scraped data into usable formats</h2>
<p>After scraping and cleaning data, the next step is often to transform it into a usable format. This can involve converting the data into popular formats such as JSON, CSV, or XML, or creating custom data structures that are better suited for the specific use case.</p>
<p>In TypeScript, there are many libraries available that can be used for data transformation. For example, the <code>csv-parser</code> library can be used to convert CSV data into JSON format, and the <code>xml2js</code> library can be used to convert XML data into JavaScript objects.</p>
<p>To demonstrate data transformation in TypeScript, let’s take the example of a web scraper that collects data about books from an online bookstore. After scraping the data and cleaning it up, we can transform it into a JSON format that can be easily consumed by other applications.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">fs</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'fs'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">csvParser</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'csv-parser'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">xml2js</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'xml2js'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">Book</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./types'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Assume we have an array of Book objects called 'books'</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">books</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Book</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span><span style="color: #7F848E; font-style: italic">/* ... */</span><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Convert the array of Book objects to JSON format</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">json</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">stringify</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">books</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Write the JSON data to a file</span></span>
<span class="line"><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFileSync</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'books.json'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">json</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Convert the array of Book objects to CSV format</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">csv</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">books</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">book</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">book</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">author</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">book</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">author</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">publisher</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">book</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">publisher</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">isbn</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">book</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">isbn</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">})).</span><span style="color: #61AFEF">pipe</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">csvParser</span><span style="color: #ABB2BF">());</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Write the CSV data to a file</span></span>
<span class="line"><span style="color: #E5C07B">csv</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">pipe</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">createWriteStream</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'books.csv'</span><span style="color: #ABB2BF">));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Convert the array of Book objects to XML format</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">builder</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">xml2js</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">Builder</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">rootName</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'books'</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">xml</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">builder</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">buildObject</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">books</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Write the XML data to a file</span></span>
<span class="line"><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFileSync</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'books.xml'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">xml</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>In this example, we first convert the array of <code>Book</code> objects to a JSON format using the built-in <code>JSON.stringify()</code> method. We then write the resulting JSON data to a file using the <code>fs.writeFileSync()</code> method.</p>
<p>Next, we use the <code>map()</code> method to transform the array of <code>Book</code> objects into an array of objects containing only the relevant fields for the CSV format. We then pipe the resulting data through the <code>csvParser()</code> method from the <code>csv-parser</code> library, which returns a readable stream that we can write to a file using the <code>fs.createWriteStream()</code> method.</p>
<p>Finally, we use the <code>xml2js</code> library to convert the array of <code>Book</code> objects to an XML format. We create a new instance of the <code>xml2js.Builder</code> class, passing in an options object that specifies the root element name. We then call the <code>buildObject()</code> method on the builder instance, passing in an object that contains the array of <code>Book</code> objects. The <code>buildObject()</code> method returns an XML string that we can write to a file using the <code>fs.writeFileSync()</code> method.</p>
<p>By transforming the scraped data into these widely used formats, we can easily import it into other applications or use it for data analysis and visualization.</p>
<p>In addition to exporting data in different formats, we can also transform scraped data into custom data structures that suit our needs. For example, we may want to combine data from multiple sources, filter out certain records, or calculate derived values based on existing data.</p>
<p>To accomplish this, we can use TypeScript’s powerful type system and functional programming features to create custom transformations that operate on our data. For instance, we can define interfaces or classes to represent our data types, use functions like <code>map</code> and <code>filter</code> to manipulate arrays of records, and leverage libraries like <code>lodash</code> to perform complex operations.</p>
<p>Here is an example of how we can use TypeScript to transform scraped data into a custom data structure:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Post</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">content</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">authorId</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">UserWithPosts</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">posts</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Post</span><span style="color: #ABB2BF">[];</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Assume we have scraped data for users and posts</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [{ </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Alice'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'alice@example.com'</span><span style="color: #ABB2BF"> }];</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">posts</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Post</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Hello, world!'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">content</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'...'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">authorId</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'My first post'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">content</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'...'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">authorId</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Define a function to join users and posts based on authorId</span></span>
<span class="line"><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">joinUsersWithPosts</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">users</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">[], </span><span style="color: #E06C75; font-style: italic">posts</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Post</span><span style="color: #ABB2BF">[]): </span><span style="color: #E5C07B">UserWithPosts</span><span style="color: #ABB2BF">[] {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">user</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">user</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">user</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">user</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">posts</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">posts</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">filter</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">post</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">post</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">authorId</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">user</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">  }));</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Apply the transformation and log the result</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">usersWithPosts</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">joinUsersWithPosts</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">users</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">posts</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">usersWithPosts</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>In this example, we define three interfaces to represent our data types: <code>User</code>, <code>Post</code>, and <code>UserWithPosts</code>. We then define a function called <code>joinUsersWithPosts</code> that takes in arrays of <code>User</code> and <code>Post</code> records, and returns an array of <code>UserWithPosts</code> records. The function uses the <code>map</code> function to iterate over the <code>users</code> array, and for each user, it creates a new <code>UserWithPosts</code> record that contains the user’s information and an array of their posts, which is obtained by using the <code>filter</code> function to select only posts that have the same <code>authorId</code> as the user’s <code>id</code>. Finally, we apply the transformation by calling <code>joinUsersWithPosts</code> with the scraped data, and log the resulting <code>usersWithPosts</code> array to the console.</p>
<p>By using TypeScript’s type system and functional programming features to transform our scraped data into custom data structures, we can create more powerful and flexible scrapers that can handle a wider range of use cases.</p>
<h2 id="exporting-data-to-various-file-formats">Exporting data to various file formats</h2>
<p>Exporting data to various file formats is an important part of web scraping as it enables us to share the scraped data with others or use it in other applications. In this section, we’ll look at how to write data to a file and export data to databases like MongoDB and MySQL.</p>
<h2 id="writing-data-to-a-file">Writing data to a file</h2>
<p>One of the simplest ways to export data is to write it to a file. TypeScript provides built-in support for working with files through the <code>fs</code> module.</p>
<p>Let’s say we want to write an array of objects to a file. We can do this as follows:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">fs</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'fs'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Alice'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">30</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Bob'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">40</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Charlie'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">50</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFile</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data.json'</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">stringify</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">), (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">throw</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Data written to file'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we use the <code>writeFile</code> method of the <code>fs</code> module to write the <code>data</code> array to a file named <code>data.json</code>. We first convert the array to a JSON string using <code>JSON.stringify</code>. The third argument to <code>writeFile</code> is a callback function that is called when the write operation is complete. If there is an error, we throw an exception; otherwise, we log a message to the console.</p>
<h2 id="exporting-data-to-databases">Exporting data to databases</h2>
<p>Another common way to export data is to store it in a database. TypeScript can work with a variety of databases, including MongoDB and MySQL.</p>
<h3 id="mongodb">MongoDB</h3>
<p>MongoDB is a popular NoSQL database that is often used for storing unstructured or semi-structured data. We can use the <code>mongodb</code> package to interact with MongoDB from TypeScript.</p>
<p>Here’s an example of how to insert data into a MongoDB collection:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">MongoClient</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mongodb'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mongodb://localhost:27017'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">dbName</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mydb'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">MongoClient</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">insertData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">data</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">[]) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">connect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">db</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">db</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">dbName</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">db</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">collection</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'mycollection'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">insertMany</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Data inserted into MongoDB'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">finally</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Alice'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">30</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Bob'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">40</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Charlie'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">50</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">insertData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>In this example, we use the <code>MongoClient</code> class to connect to a MongoDB instance running on <code>localhost</code>. We then insert the <code>data</code> array into a collection named <code>mycollection</code>. Finally, we log a message to the console when the insert operation is complete.</p>
<h3 id="mysql">MySQL</h3>
<p>MySQL is a popular relational database that is often used for storing structured data. We can use the <code>mysql2</code> package to interact with MySQL from TypeScript.</p>
<p>Here’s an example of how to insert data into a MySQL table:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">createConnection</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mysql2/promise'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">config</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">host</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'localhost'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">user</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'root'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">password</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'password'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">database</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'mydb'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">insertData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">data</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">[]) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">connection</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">createConnection</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">config</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">rows</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">connection</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">execute</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #98C379">'INSERT INTO mytable (name, age) VALUES (?, ?)'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">item</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">age</span><span style="color: #ABB2BF">])</span></span>
<span class="line"><span style="color: #ABB2BF">    );</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Inserted </span><span style="color: #C678DD">${</span><span style="color: #E5C07B">rows</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">affectedRows</span><span style="color: #C678DD">}</span><span style="color: #98C379"> rows into MySQL`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">insertIntoMySQL</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>Once the data is inserted into the MySQL database, we can easily retrieve it and use it for further analysis or visualization. We can also export the data to other formats like CSV or JSON using TypeScript.</p>
<p>Overall, using TypeScript for web scraping allows us to build more robust and maintainable web scrapers that can easily integrate with other applications and tools. By using Puppeteer and other web scraping libraries with TypeScript, we can handle complex scraping scenarios, authenticate with websites, and parse and transform scraped data into usable formats. With TypeScript’s strong typing and error handling, we can catch errors early and ensure that our code is reliable and scalable.</p>
<h2 id="introduction-to-axios">Introduction to Axios</h2>
<p>Axios is a popular and widely used HTTP client library for JavaScript that allows developers to make HTTP requests to web servers. It provides an easy-to-use API for sending asynchronous HTTP requests and handling responses. Axios is often used for web scraping and building RESTful APIs.</p>
<p>Axios supports many features that make it a popular choice for web scraping, including the ability to handle JSON and form data, handle HTTP cookies and authentication, and perform automatic retries on failed requests. Additionally, it can be used both in browser and Node.js environments, making it a versatile tool for web scraping.</p>
<p>To use Axios in a web scraping project, you first need to install it. This can be done using npm, the package manager for Node.js, with the following command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install axios</span></span></code></pre>
<p>Once installed, you can import and configure Axios in your scraping code. This typically involves setting default configuration options, such as the base URL for your requests and any headers you want to include.</p>
<p>Here’s an example of how to import and configure Axios in a Node.js project:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">AxiosInstance</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axiosInstance</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">AxiosInstance</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">create</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">baseURL</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'https://example.com/api'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">headers</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #98C379">'Content-Type'</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'application/json'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">Authorization</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Bearer my-jwt-token'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we create an instance of the Axios client with a base URL of <code>https://example.com/api</code> and set some default headers to be included with every request. You can then use this instance to make HTTP requests to the server.</p>
<p>Axios provides a simple and powerful API for making HTTP requests, including support for GET, POST, PUT, DELETE, and other HTTP methods. In the next section, we’ll explore how to use Axios to send HTTP requests and handle responses.</p>
<h2 id="scraping-dynamic-websites-with-axios">Scraping dynamic websites with Axios</h2>
<p>Axios is a popular third-party library used for making HTTP requests in Node.js and the browser. It provides an easy-to-use API for sending GET, POST, PUT, DELETE, and other types of HTTP requests. In this section, we’ll explore how to use Axios for scraping dynamic websites.</p>
<p>To get started with Axios, we first need to install it via NPM:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install axios</span></span></code></pre>
<p>Once installed, we can create an Axios instance and configure it with the desired settings. For example, we can set the base URL and default headers for all requests:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">instance</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">create</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">baseURL</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'https://example.com/api/'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">headers</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #98C379">'Content-Type'</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'application/json'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #98C379">'Authorization'</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Bearer '</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">token</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>To send an HTTP request with Axios, we can use one of the many methods available in the instance. For example, we can send a GET request to retrieve the contents of a webpage:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">instance</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://example.com/page'</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>Note that Axios returns a Promise, which we can await to get the response object containing the data, headers, status, and other information. The response data can be of various types, such as a string, a Buffer, a JSON object, or an HTML document.</p>
<p>To parse an HTML response with Cheerio, we can use the same approach as with the built-in HTTP module. First, we need to install Cheerio via NPM:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install cheerio</span></span></code></pre>
<p>Then, we can load the response data into a Cheerio object and use its methods to extract the desired data:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'title'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">links</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">i</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'href'</span><span style="color: #ABB2BF">)).</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">images</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'img'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">i</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'src'</span><span style="color: #ABB2BF">)).</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>Here, we’re using Cheerio’s selector syntax to select elements from the HTML document and extract their attributes. The <code>map()</code> method allows us to apply a function to each selected element and return an array of the results.</p>
<p>Finally, we can use the extracted data for further processing or saving to files or databases.</p>
<p>Note that like with the built-in HTTP module, Axios can also handle cookies, sessions, authentication, and other features required for scraping dynamic websites. We can also use other third-party libraries like Puppeteer in combination with Axios for more complex scraping tasks.</p>
<h2 id="implementing-pagination-with-axios">Implementing pagination with Axios</h2>
<p>Pagination is a common feature in many dynamic websites, especially those that display a large amount of data. Pagination involves splitting the data into smaller chunks or pages to make it easier to navigate and view. Each page typically contains a fixed number of items, and users can move between pages using pagination links or buttons.</p>
<p>When web scraping with Axios, it’s important to understand how pagination works in the website you’re scraping. You’ll need to identify the pagination links or buttons and extract the relevant data from each page. Once you’ve done this, you can use Axios to send HTTP requests to each page and extract the data using Cheerio.</p>
<p>To implement pagination with Axios and Cheerio, you can start by sending a request to the first page of the website. You can then use Cheerio to extract the pagination links or buttons from the HTML response. Once you have the links or buttons, you can iterate through them, sending a request to each page and extracting the relevant data.</p>
<p>Here’s an example of how you can implement pagination with Axios and Cheerio:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">baseURL</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'https://example.com/page/'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeData</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">currentPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">hasNextPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">while</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">hasNextPage</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">baseURL</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">currentPage</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// Extract data from current page using Cheerio</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// Check if there's a next page</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextPageButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a.next-page'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">nextPageButton</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">currentPage</span><span style="color: #56B6C2">++</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">hasNextPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In this example, we start by defining a <code>baseURL</code> that points to the first page of the website. We then initialize an empty array to store the data we’ll be scraping. We also set <code>currentPage</code> to 1 and <code>hasNextPage</code> to true to start the pagination loop.</p>
<p>Inside the loop, we use Axios to send a GET request to the current page of the website. We then use Cheerio to extract the relevant data from the HTML response. Once we’ve extracted the data, we check if there’s a next page by searching for a pagination link or button with the class <code>next-page</code>. If we find a next page, we increment <code>currentPage</code> and continue the loop. If we don’t find a next page, we set <code>hasNextPage</code> to false to exit the loop.</p>
<p>This is a basic example of how you can implement pagination with Axios and Cheerio. The specifics will depend on the website you’re scraping and the structure of its pagination. In some cases, you may need to extract additional data from the pagination links or buttons, or use other techniques to identify the pages you need to scrape.</p>
<h2 id="overview-of-web-scraping-ethics">Overview of web scraping ethics</h2>
<p>Web scraping can be a powerful tool for gathering data and insights from the web, but it is important to approach it with a strong ethical framework. Ethical web scraping involves respecting the rights of website owners and users, as well as ensuring that your scraping activities do not cause harm or damage.</p>
<p>Some common ethical concerns and considerations in web scraping include:</p>
<ol>
<li>
<p>Respect for website terms of service: Website terms of service often contain clauses that restrict scraping activities or require permission before scraping. It is important to read and understand these terms before scraping a website.</p>
</li>
<li>
<p>Respect for copyright and intellectual property: It is important to ensure that the data you scrape does not infringe on the copyright or intellectual property rights of others.</p>
</li>
<li>
<p>Respect for privacy and personal data: Scraping personal data, such as user profiles or contact information, can raise ethical concerns around privacy and data protection. It is important to ensure that any personal data you scrape is done so with the appropriate consent and legal framework.</p>
</li>
<li>
<p>Avoiding overloading websites with requests: Scraping activities can put a strain on websites, potentially causing them to slow down or crash. It is important to implement measures to avoid overloading websites with requests or scraping large amounts of data without permission.</p>
</li>
<li>
<p>Transparency and accountability: Ethical web scraping involves being transparent about your activities and being accountable for any impact they may have. This includes providing clear information about your scraping activities and ensuring that any data you scrape is used appropriately.</p>
</li>
</ol>
<p>By taking these ethical concerns and considerations into account, web scraping can be a valuable tool for gathering insights and data from the web while also respecting the rights of website owners and users.</p>
<h2 id="understanding-web-scraping-laws-and-regulations">Understanding web scraping laws and regulations</h2>
<p>Web scraping is a topic that has legal and ethical considerations. While web scraping itself is not illegal, it can violate certain laws and regulations, especially if it involves sensitive or personal data. Therefore, it’s important to understand the relevant laws and regulations and the implications of breaking them.</p>
<p>One of the main legal considerations when it comes to web scraping is copyright law. Copyright law protects the original expression of ideas, and scraping content that is protected by copyright can lead to legal action. Additionally, scraping personal information such as email addresses or social security numbers can also lead to legal action under data protection and privacy laws.</p>
<p>Another legal consideration is the terms of service of websites that are being scraped. Many websites explicitly prohibit scraping in their terms of service, and violating these terms can result in legal action.</p>
<p>There are also specific laws that apply to web scraping, such as the Computer Fraud and Abuse Act (CFAA) in the United States. This law criminalizes unauthorized access to computer systems, and web scraping that involves hacking or bypassing security measures can be considered a violation of this law.</p>
<p>In addition to legal considerations, there are also ethical considerations when it comes to web scraping. One of the main ethical concerns is the potential for web scraping to cause harm to individuals or organizations. For example, scraping personal information can lead to identity theft or fraud, while scraping sensitive business information can lead to a competitive advantage for one party over another.</p>
<p>Another ethical concern is the potential for web scraping to overload websites with requests, causing them to crash or become inaccessible. This is known as a denial of service attack and is typically considered unethical.</p>
<p>Overall, it’s important to be aware of the relevant laws and regulations when it comes to web scraping and to ensure that scraping activities are ethical and respectful of website terms of service and individual privacy.</p>
<h2 id="best-practices-for-responsible-web-scraping">Best practices for responsible web scraping</h2>
<p>Responsible web scraping is crucial to ensure that websites are not overloaded with requests or scraped beyond the limits defined by the website owners. Here are some best practices that web scrapers should follow to be responsible and respectful:</p>
<ol>
<li>
<p>Respect website terms of service: Before scraping any website, it is important to read and understand the website’s terms of service. Some websites prohibit scraping, while others may require permission or have specific limitations on the amount of data that can be scraped.</p>
</li>
<li>
<p>Use polite scraping techniques: Web scrapers should use techniques that are polite and respectful to the website. This includes setting appropriate scraping intervals, using appropriate user agents, and not scraping private or sensitive data.</p>
</li>
<li>
<p>Identify yourself as a bot: It is important to identify yourself as a bot by setting a custom user agent in your requests. This will help website owners understand that the traffic is coming from a bot and not a human user.</p>
</li>
<li>
<p>Monitor scraping behavior: It is important to monitor scraping behavior and ensure that it is not causing any harm to the website or its users. Web scrapers should monitor their scraping activity and ensure that it does not cause any website downtime, slow response times, or other issues.</p>
</li>
<li>
<p>Minimize the impact on websites: Web scrapers should try to minimize the impact of scraping on websites by using techniques such as caching, compression, and limiting the number of requests sent.</p>
</li>
<li>
<p>Obtain permission when necessary: If a website requires permission to scrape, it is important to obtain permission before scraping. This can be done by contacting the website owner and explaining the purpose of the scraping.</p>
</li>
<li>
<p>Be respectful of personal data: Web scrapers should be respectful of personal data and ensure that it is not collected or used inappropriately. Personal data should be anonymized or removed if it is not necessary for the scraping purpose.</p>
</li>
</ol>
<p>By following these best practices, web scrapers can ensure that they are being responsible and respectful to website owners, users, and personal data.</p>
<h2 id="scraping-product-information-from-e-commerce-websites">Scraping Product Information from E-commerce Websites</h2>
<h2 id="setting-up-the-project">Setting up the project</h2>
<p>To set up the project, you will need to follow the steps below:</p>
<ol>
<li>
<p>Create a new directory for your project and navigate into it using the command line.</p>
</li>
<li>
<p>Initialize a new npm project by running the following command:</p>
</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm init</span></span></code></pre>
<p>This command will prompt you to enter some information about your project, such as its name, version, description, and author.</p>
<ol start="3">
<li>Install the necessary dependencies by running the following command:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install axios cheerio json2csv mysql</span></span></code></pre>
<p>This command will install the Axios library for making HTTP requests, the Cheerio library for parsing HTML responses, the json2csv library for converting data to CSV format, and the MySQL library for interacting with the MySQL database.</p>
<ol start="4">
<li>
<p>Create a new file named <code>index.ts</code> in the root directory of your project. This file will contain the main logic of your web scraper.</p>
</li>
<li>
<p>Configure your development environment to use TypeScript. You can follow the official TypeScript documentation to set up TypeScript for your preferred text editor or IDE.</p>
</li>
</ol>
<p>Once you have completed these steps, you can start building your web scraper in TypeScript.</p>
<h2 id="scraping-product-information-with-puppeteer">Scraping product information with Puppeteer</h2>
<p>Let’s start by setting up Puppeteer and navigating to the product page we want to scrape. Here’s an example code snippet:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeProduct</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">url</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">waitUntil</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'networkidle2'</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Scrape product information here</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">scrapeProduct</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.example.com/product'</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>In this code snippet, we import Puppeteer and define an asynchronous function called <code>scrapeProduct</code> that takes in a URL as a parameter. We then launch a new Puppeteer browser instance and create a new page within that browser. We use the <code>page.goto</code> method to navigate to the product page we want to scrape, and we specify the <code>waitUntil: 'networkidle2'</code> option to ensure that the page has finished loading before we begin scraping.</p>
<p>Now that we have navigated to the product page, we can begin scraping the product information. We’ll need to inspect the page’s HTML and use the appropriate selectors to extract the data we need. We can use Puppeteer’s <code>page.$</code> and <code>page.$$</code> methods to query the page for elements, and we can use the <code>ElementHandle</code> object’s <code>getProperty</code> and <code>jsonValue</code> methods to extract the element’s properties and values.</p>
<p>Here’s an example of how we might scrape the product name and price:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeProduct</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">url</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">waitUntil</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'networkidle2'</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">productName</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-name'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">productPrice</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-price'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Product Name: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">productName</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Product Price: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">productPrice</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">scrapeProduct</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.example.com/product'</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>In this example, we use Puppeteer’s <code>page.$eval</code> method to query the page for the product name and price elements, and we extract their text content using the <code>textContent</code> property. We also use the <code>trim</code> method to remove any leading or trailing whitespace from the text. Finally, we log the product name and price to the console.</p>
<h2 id="handling-headless-browsing-with-puppeteer-1">Handling headless browsing with Puppeteer</h2>
<p>To handle headless browsing with Puppeteer, we can use the `head option when launching a new browser instance. This option allows us to control whether the browser should be run in headless mode or not. By default, Puppeteer runs the browser in headless mode, which means that no GUI is displayed and all interactions with the page happen in the background.</p>
<p>To disable headless mode, we can set the <code>head option to </code>false` when launching a new browser instance:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">headless</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF"> });</span></span></code></pre>
<p>With this option enabled, we can see the browser window as it navigates to the page and interacts with the elements. This can be useful for debugging and testing purposes, but it also slows down the scraping process and consumes more resources.</p>
<p>It’s worth noting that some websites may detect and block headless browsers, so using this option may not always be feasible or effective. In those cases, we may need to resort to other techniques, such as using a real browser or rotating IP addresses to avoid detection.</p>
<h2 id="implementing-pagination-with-puppeteer">Implementing pagination with Puppeteer</h2>
<p>To implement pagination with Puppeteer, we need to first identify the element on the page that contains the pagination controls, such as the “next” button or a dropdown menu. Once we have identified this element, we can use Puppeteer to simulate user actions to navigate to the next page.</p>
<p>Here’s an example of how to implement pagination with Puppeteer:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">navigateToNextPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">page</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Page</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#next-page-button'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">nextButton</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForNavigation</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">waitUntil</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'networkidle0'</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">currentPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">while</span><span style="color: #ABB2BF"> (</span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">productsOnPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeProductDataFromPage</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">page</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Save scraped data to database or file</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">hasNextPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">navigateToNextPage</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">page</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">hasNextPage</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">break</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">currentPage</span><span style="color: #56B6C2">++</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In this example, we define a function <code>navigateToNextPage</code> that takes a Puppeteer <code>Page</code> object and attempts to find and click the “next page” button on the current page. If the button is found and clicked, the function waits for the page to finish loading before returning <code>true</code>. If the button is not found, the function returns <code>false</code>.</p>
<p>We then use a <code>while</code> loop to continuously scrape data from each page until we reach the last page. On each page, we scrape the data and save it to a database or file. We then call <code>navigateToNextPage</code> to attempt to navigate to the next page. If there is no next page, the loop breaks and the scraping process ends.</p>
<p>By using this method to implement pagination, we can easily scrape data from multiple pages without having to manually navigate to each page.</p>
<h2 id="parsing-and-transforming-data-with-typescript">Parsing and transforming data with TypeScript</h2>
<p>Now that we have the product information scraped and stored in our <code>products</code> array, we can use TypeScript to parse and transform the data into a usable format.</p>
<p>First, let’s create an interface to define the shape of our product objects:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">imageUrl</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>Next, let’s use TypeScript to clean up and format the data. We can start by using string methods to trim and remove unwanted characters from the <code>title</code> and <code>price</code> properties. For example:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #E5C07B">products</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">forEach</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">product</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Clean up title</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Clean up price</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">price</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Number</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">price</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">replace</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">/</span><span style="color: #D19A66">[</span><span style="color: #ABB2BF">^</span><span style="color: #D19A66">0-9</span><span style="color: #E06C75">.</span><span style="color: #D19A66">-]+</span><span style="color: #E06C75">/</span><span style="color: #C678DD">g</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">""</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In the code above, we use the <code>trim</code> method to remove any leading or trailing whitespace from the <code>title</code> property. We also use a regular expression to remove any non-numeric characters from the <code>price</code> property and convert it to a number using the <code>Number</code> constructor.</p>
<p>We can also create a helper function to format the price as a string with two decimal places:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">formatPrice</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">price</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">price</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">toFixed</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>Now that we’ve cleaned up the data, let’s create a function to transform the product objects into a format that’s easy to work with. For example, we could create an array of objects with just the <code>title</code> and <code>price</code> properties:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">formatProducts</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">products</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF">[]): { </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">; </span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> }[] {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">product</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> ({</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">: </span><span style="color: #61AFEF">formatPrice</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">  }));</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the code above, we use the <code>map</code> method to transform each <code>Product</code> object into an object with just the <code>title</code> and <code>price</code> properties. We also use the <code>formatPrice</code> helper function to format the price as a string with two decimal places.</p>
<p>Now we can call the <code>formatProducts</code> function to get an array of formatted product objects:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">formattedProducts</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">formatProducts</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">formattedProducts</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>This will output an array of objects with just the <code>title</code> and <code>price</code> properties, formatted as strings with two decimal places.</p>
<p>Finally, we can write the data to a CSV file using the <code>csv-writer</code> package:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">createCsvWriter</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">"csv-writer"</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">csvWriter</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">createCsvWriter</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">path</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"products.csv"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">header</span><span style="color: #ABB2BF">: [{ </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"title"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Title"</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"price"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"Price"</span><span style="color: #ABB2BF"> }],</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E06C75">csvWriter</span></span>
<span class="line"><span style="color: #ABB2BF">  .</span><span style="color: #61AFEF">writeRecords</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">formattedProducts</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">  .</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"CSV file written successfully"</span><span style="color: #ABB2BF">));</span></span></code></pre>
<p>In the code above, we create a CSV writer with the <code>createCsvWriter</code> function and specify the path and header for the CSV file. We then call the <code>writeRecords</code> method with the formatted product data and log a success message to the console when the file is written successfully.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">fs</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'fs'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// write product data to a CSV file</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">writeToFile</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">data</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">[], </span><span style="color: #E06C75; font-style: italic">filename</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">header</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">keys</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">]).</span><span style="color: #61AFEF">join</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">','</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'</span><span style="color: #56B6C2">\n</span><span style="color: #98C379">'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">rows</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">item</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">values</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">item</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">join</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">','</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'</span><span style="color: #56B6C2">\n</span><span style="color: #98C379">'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">csv</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">header</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">rows</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">join</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">''</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFile</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">filename</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">csv</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Product data successfully written to </span><span style="color: #C678DD">${</span><span style="color: #E06C75">filename</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// transform and format product data</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">formatProductData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">products</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">[]) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">product</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">: </span><span style="color: #61AFEF">parseFloat</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">price</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">replace</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">/</span><span style="color: #D19A66">[</span><span style="color: #ABB2BF">^</span><span style="color: #D19A66">0-9</span><span style="color: #E06C75">.</span><span style="color: #D19A66">-]+</span><span style="color: #E06C75">/</span><span style="color: #C678DD">g</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">''</span><span style="color: #ABB2BF">)),</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">brand</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">brand</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">category</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">category</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">availability</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">product</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">availability</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    };</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// extract product information from the page</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">extractProducts</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">page</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">Page</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product'</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">elements</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">elements</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-name'</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-price'</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">brand</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-brand'</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">category</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-category'</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">availability</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-availability'</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      };</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">formatProductData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// scrape product information from the website</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeProducts</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">url</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">maxPages</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">headless</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">any</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">currentPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">while</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">currentPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x3C;=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">maxPages</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E06C75">url</span><span style="color: #C678DD">}</span><span style="color: #98C379">?page=</span><span style="color: #C678DD">${</span><span style="color: #E06C75">currentPage</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">waitUntil</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'networkidle0'</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">pageProducts</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">extractProducts</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">page</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">(...</span><span style="color: #E06C75">pageProducts</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">currentPage</span><span style="color: #56B6C2">++</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// run the scraper and write the data to a file</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'https://example.com/products'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">maxPages</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">5</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">filename</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'product_data.csv'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #61AFEF">scrapeProducts</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">maxPages</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">  .</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">data</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">writeToFile</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">filename</span><span style="color: #ABB2BF">))</span></span>
<span class="line"><span style="color: #ABB2BF">  .</span><span style="color: #61AFEF">catch</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">));</span></span></code></pre>
<p>In this code, we have added a <code>writeToFile()</code> function to write the formatted product data to a CSV file. We have also modified the <code>formatProductData()</code> function to return only the desired fields and format the price as a float. Finally, we have modified the <code>extractProducts()</code> function to use <code>$$eval()</code> to select all product elements on the page and return an array of product objects.</p>
<p>We have also added code to iterate over the desired number of pages and concatenate the product data into a single array.</p>
<p>By running this script, we should see product data being scraped and written to a CSV file in the project directory.</p>
<h2 id="exporting-data-to-a-json-file">Exporting data to a JSON file</h2>
<p>To export our formatted data to a JSON file, we can use the built-in <code>writeFile</code> function provided by the Node.js <code>fs</code> module. Here’s how we can modify our code to export the data:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">fs</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'fs'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFile</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'products.json'</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">stringify</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">), (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Error writing file: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">err</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Product data written to products.json'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>Here, we use <code>JSON.stringify</code> to convert the <code>products</code> array into a JSON-formatted string. The second argument to <code>JSON.stringify</code> is a replacer function, which we don’t need in this case, so we pass <code>null</code> instead. The third argument is the number of spaces to use for indentation in the output JSON file, which we set to 2 for readability.</p>
<p>We then pass the resulting string to <code>writeFile</code>, along with the file path and a callback function to handle errors and log a success message. The callback function takes an <code>err</code> argument, which will be <code>null</code> if the file was written successfully. If an error occurs, we log the error message to the console. Otherwise, we log a success message with the file name.</p>
<h1 id="chapter-12-building-a-web-scraper-with-typescript-scraping-e-commerce-websites">Chapter 12: Building a Web Scraper with TypeScript: Scraping E-commerce Websites</h1>
<h2 id="project-overview">Project overview</h2>
<p>In this project, we will be building a web scraper using Axios and Cheerio to extract data about movies from IMDb’s “Top Rated Movies” list. We will then use TypeScript to parse and transform the scraped data, and finally export it to a JSON file.</p>
<p>The scraper will navigate through multiple pages of the “Top Rated Movies” list, scrape information such as the movie title, release year, rating, and poster image URL, and store it in an array. We will then use TypeScript to clean up the scraped data, format it, and transform it into a usable JSON format. Finally, we will write the transformed data to a file using Node.js file system module.</p>
<p>Throughout the project, we will be following best practices for ethical and responsible web scraping. We will limit our requests to IMDb’s server and will ensure that our scraper does not overload their servers. We will also adhere to the terms of service and laws related to web scraping.</p>
<h2 id="setting-up-the-project-1">Setting up the project</h2>
<p>To set up the project, we first need to create a new directory for the project and initialize it as a Node.js project with npm. We can do this by running the following commands in our terminal:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">mkdir weather-scraper</span></span>
<span class="line"><span style="color: #abb2bf">cd weather-scraper</span></span>
<span class="line"><span style="color: #abb2bf">npm init -y</span></span></code></pre>
<p>The <code>mkdir</code> command creates a new directory named <code>weather-scraper</code>, and the <code>cd</code> command changes our current directory to the newly created <code>weather-scraper</code> directory.</p>
<p>The <code>npm init -y</code> command initializes the project with default values for the <code>package.json</code> file. This file will contain metadata about our project, as well as dependencies and scripts for running the project.</p>
<p>Next, we need to install the necessary dependencies for our project, which are:</p>
<ul>
<li><code>puppeteer</code>: A Node.js library that provides a high-level API for controlling headless Chrome or Chromium.</li>
<li><code>dotenv</code>: A zero-dependency module that loads environment variables from a .env file into process.env.</li>
</ul>
<p>We can install these dependencies by running the following command in our terminal:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install puppeteer dotenv</span></span></code></pre>
<p>This will download and install the latest version of <code>puppeteer</code> and <code>dotenv</code> from the npm registry and add them to our project’s <code>package.json</code> file as dependencies.</p>
<h2 id="understanding-the-structure-of-e-commerce-websites">Understanding the structure of e-commerce websites</h2>
<p>E-commerce websites typically have a hierarchical structure consisting of multiple pages and sections.</p>
<p>At the top level, there are usually category pages that group products based on their type or function. These pages often have a menu or navigation bar that allows users to quickly jump to different sections of the website.</p>
<p>Within each category, there are product listing pages that display multiple products with basic information such as images, titles, prices, and ratings. These pages may also have filters or sorting options to help users refine their search.</p>
<p>Clicking on a product usually takes the user to a product details page that provides more information about the product, including a more detailed description, specifications, customer reviews, and related products.</p>
<p>In addition to these core pages, e-commerce websites may also have pages for promotions, sales, and deals, as well as pages for customer service, shipping and returns, and other informational content.</p>
<h2 id="automating-browsing-with-puppeteer">Automating browsing with Puppeteer</h2>
<p>To automate browsing with Puppeteer, we need to follow these steps:</p>
<ol>
<li>
<p><strong>Install Puppeteer</strong>: First, we need to install the Puppeteer package. We can do this by running the following command in our project directory:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install puppeteer</span></span></code></pre>
</li>
<li>
<p><strong>Launch a browser instance</strong>: Once Puppeteer is installed, we can launch a browser instance using the <code>puppeteer.launch()</code> method. This method returns a Promise that resolves to an instance of the <code>Browser</code> class.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">const puppeteer = require('puppeteer');</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">(async () => {</span></span>
<span class="line"><span style="color: #abb2bf">  const browser = await puppeteer.launch();</span></span>
<span class="line"><span style="color: #abb2bf">})();</span></span></code></pre>
</li>
<li>
<p><strong>Create a new page</strong>: After launching a browser instance, we need to create a new page using the <code>browser.newPage()</code> method. This method also returns a Promise that resolves to an instance of the <code>Page</code> class.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">const page = await browser.newPage();</span></span></code></pre>
</li>
<li>
<p><strong>Navigate to a URL</strong>: Once we have a page, we can navigate to a URL using the <code>page.goto()</code> method. This method also returns a Promise.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">await page.goto('https://www.example.com');</span></span></code></pre>
</li>
<li>
<p><strong>Interact with the page</strong>: After navigating to a URL, we can interact with the page using methods such as <code>page.click()</code>, <code>page.type()</code>, <code>page.select()</code>, and <code>page.evaluate()</code>. These methods allow us to click on elements, fill out forms, select options from dropdowns, and extract data from the page.</p>
</li>
<li>
<p><strong>Close the browser</strong>: Once we’re done with the browser instance, we should close it using the <code>browser.close()</code> method.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">await browser.close();</span></span></code></pre>
</li>
</ol>
<p>Here’s an example that navigates to the Google homepage, types a search query, and clicks the search button:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">const puppeteer = require('puppeteer');</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">(async () => {</span></span>
<span class="line"><span style="color: #abb2bf">  const browser = await puppeteer.launch();</span></span>
<span class="line"><span style="color: #abb2bf">  const page = await browser.newPage();</span></span>
<span class="line"><span style="color: #abb2bf">  await page.goto('https://www.google.com');</span></span>
<span class="line"><span style="color: #abb2bf">  await page.type('input[name="q"]', 'web scraping');</span></span>
<span class="line"><span style="color: #abb2bf">  await page.click('input[type="submit"]');</span></span>
<span class="line"><span style="color: #abb2bf">  await browser.close();</span></span>
<span class="line"><span style="color: #abb2bf">})();</span></span></code></pre>
<h2 id="handling-authentication-and-cookies-with-puppeteer">Handling authentication and cookies with Puppeteer</h2>
<p>To handle authentication and cookies with Puppeteer, we can use the <code>page.authenticate()</code> method and the <code>page.setCookie()</code> method, respectively.</p>
<p>To authenticate with a website, we first need to provide our login credentials. We can do this by navigating to the login page, entering our username and password, and submitting the form. Once we have successfully logged in, we can use the <code>page.authenticate()</code> method to provide our credentials on subsequent requests.</p>
<p>Here’s an example of how to authenticate with a website using Puppeteer:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'my_username'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">password</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'my_password'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Navigate to the login page</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://example.com/login'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Enter the username and password</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#username'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#password'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">password</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Submit the form</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">all</span><span style="color: #ABB2BF">([</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#login-button'</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForNavigation</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">  ]);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Authenticate with the website</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">authenticate</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">password</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Continue browsing the website</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://example.com/dashboard'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// ...</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">})();</span></span></code></pre>
<p>To handle cookies with Puppeteer, we can use the <code>page.setCookie()</code> method to add cookies to the current page context. Cookies are typically obtained when we first authenticate with a website, and we can use them on subsequent requests to maintain our authenticated state.</p>
<p>Here’s an example of how to set cookies using Puppeteer:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cookies</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'session_id'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">value</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'my_session_id'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">domain</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'example.com'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">path</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'/'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">expires</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Date</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">now</span><span style="color: #ABB2BF">() </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">86400000</span><span style="color: #ABB2BF">, </span><span style="color: #7F848E; font-style: italic">// expires in 24 hours</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">httpOnly</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">secure</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Set the cookies for the page</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">setCookie</span><span style="color: #ABB2BF">(...</span><span style="color: #E06C75">cookies</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Navigate to a page that requires authentication</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://example.com/dashboard'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// ...</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">})();</span></span></code></pre>
<p>In this example, we’re setting a single cookie with the name “session_id” and the value “my_session_id”. We’re also specifying the domain, path, expiration date, and security settings for the cookie. Once we’ve set the cookie, we can navigate to a page that requires authentication, and Puppeteer will automatically send the cookie with our request.</p>
<h2 id="extracting-product-data-with-puppeteer">Extracting product data with Puppeteer</h2>
<p>To extract product data from an e-commerce website, we can use Puppeteer to automate the browsing process and extract the data we need. Here is an example of how we can extract product data from an e-commerce website:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Launch browser</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Open a new page and navigate to the product page</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.example.com/product/123'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Extract the product name, price, and description</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">productName</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'h1.product-name'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">productPrice</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'span.product-price'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">productDescription</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div.product-description'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Extract the product image URL</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">productImageURL</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'img.product-image'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">el</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">src</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Extract the product reviews</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">reviews</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div.review'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">reviews</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">reviews</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">review</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">reviewerName</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">review</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div.reviewer-name'</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">reviewText</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">review</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div.review-text'</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">reviewRating</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">review</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">querySelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div.review-rating'</span><span style="color: #ABB2BF">).</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">reviewerName</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">reviewText</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E06C75">reviewRating</span></span>
<span class="line"><span style="color: #ABB2BF">      };</span></span>
<span class="line"><span style="color: #ABB2BF">    });</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Close the browser</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Log the extracted data</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">productName</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">productPrice</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">productDescription</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">productImageURL</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">reviews</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"><span style="color: #ABB2BF">})();</span></span></code></pre>
<p>In this example, we first launch a new browser instance with <code>puppeteer.launch()</code>. We then open a new page with <code>browser.newPage()</code> and navigate to the product page with <code>page.goto()</code>. We use <code>page.$eval()</code> to extract the product name, price, and description, and <code>page.$eval()</code> again to extract the product image URL. We use <code>page.$$eval()</code> to extract the product reviews and create an array of review objects. Finally, we close the browser with <code>browser.close()</code> and log the extracted data to the console.</p>
<p>This is a basic example of how to extract product data with Puppeteer. Depending on the website structure and the data we want to extract, we may need to use more advanced techniques such as waiting for certain elements to load, handling dynamic content, and using regular expressions to extract data from text.</p>
<h2 id="implementing-pagination-with-puppeteer-1">Implementing pagination with Puppeteer</h2>
<p>To implement pagination with Puppeteer, we need to find the elements that allow us to navigate to the next page, click on them, and wait for the new page to load.</p>
<p>First, we need to locate the button or link that takes us to the next page. We can use Puppeteer’s <code>page.$</code> method to find the element by its selector. Once we have the element, we can use <code>element.click()</code> to click on it and wait for the page to load using <code>page.waitForNavigation()</code>.</p>
<p>We can wrap this process in a loop to navigate through all the pages until we have scraped all the data we need. Here’s an example code snippet:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapePages</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">page</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Page</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">hasNextPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">while</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">hasNextPage</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// Scraping logic goes here</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextPageButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'selector-for-next-page-button'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">nextPageButton</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextPageButton</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForNavigation</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">hasNextPage</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">false</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In this example, we initialize a <code>hasNextPage</code> variable to <code>true</code> to start the loop. We then use a <code>while</code> loop to keep scraping until there are no more pages.</p>
<p>Inside the loop, we first scrape the data we need from the current page. We then use <code>page.$</code> to locate the button or link that takes us to the next page. If the button is found, we click on it and wait for the page to load using <code>page.waitForNavigation()</code>. If the button is not found, we set <code>hasNextPage</code> to <code>false</code> to exit the loop.</p>
<p>By using this approach, we can easily navigate through all the pages of a website and scrape all the data we need.</p>
<h2 id="parsing-and-transforming-data-with-typescript-1">Parsing and transforming data with TypeScript</h2>
<p>To parse and transform the scraped data, we will use TypeScript. TypeScript is a superset of JavaScript that adds type annotations, classes, and other features to make it easier to write and maintain large-scale applications.</p>
<p>To get started, let’s create a new file called <code>transformData.ts</code> in the root of our project. In this file, we’ll define a function that takes in the raw HTML data and returns an array of product objects. Each product object will contain information such as the name, price, and image URL.</p>
<p>First, let’s install the <code>cheerio</code> library, which is a jQuery-like library for parsing HTML:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">install</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">cheerio</span></span></code></pre>
<p>Next, let’s import <code>cheerio</code> and define our function:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">imageUrl</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">transformData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">html</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF">[] {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-item'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">each</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">_</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$element</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">element</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">name</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$element</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-name a'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">price</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseFloat</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">$element</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.price'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">replace</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">/\D/</span><span style="color: #C678DD">g</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">''</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">imageUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$element</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.product-image img'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'src'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">imageUrl</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In this function, we first load the raw HTML data into a <code>cheerio</code> object using the <code>load</code> method. We then loop through each <code>.product-item</code> element and extract the name, price, and image URL using <code>find</code> and <code>text</code> methods. We also use a regular expression to remove any non-numeric characters from the price before parsing it into a number using <code>parseFloat</code>. Finally, we add the product object to an array and return it.</p>
<p>Now that we have our <code>transformData</code> function, we can use it to transform the scraped data into a more usable format. Let’s modify our <code>scrapeData</code> function to use <code>transformData</code>:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">launch</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">Browser</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">transformData</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./transformData'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'https://www.example.com/products'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeData</span><span style="color: #ABB2BF">(): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF">[]> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">while</span><span style="color: #ABB2BF"> (</span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">html</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">content</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">newProducts</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">transformData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">(...</span><span style="color: #E06C75">newProducts</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.next-page'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">nextButton</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">break</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForNavigation</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In this modified <code>scrapeData</code> function, we first load the URL using <code>page.goto</code>. We then loop through the pages using the <code>while</code> loop, just as we did before. However, instead of parsing the raw HTML data, we now pass it to <code>transformData</code> and add the resulting product objects to our <code>products</code> array using the spread operator.</p>
<p>Finally, we close the browser and return the <code>products</code> array.</p>
<p>With this updated code, we should now be able to scrape and transform the product data from the e-commerce website. In the next step, we will export the data to a file.</p>
<p>Step 5: Exporting the data</p>
<p>The last step is to export the data to a file. We will use the <code>fs</code> module in Node.js to write the data to a file. Here is the code:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">fs</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'fs'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Export data to a JSON file</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">exportData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">data</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF">[]) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">formattedData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">stringify</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFile</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'./data/products.json'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">formattedData</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Error writing file:'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Data exported to ./data/products.json'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"><span style="color: #ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">exportData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>In this code, we define a function called <code>exportData</code> that takes the <code>products</code> array as a parameter. Inside the function, we first use <code>JSON.stringify</code> to convert the <code>products</code> array to a JSON string with indentation of 2 spaces. Then we use <code>fs.writeFile</code> to write the JSON string to a file named <code>products.json</code> in the <code>data</code> folder. We also provide a callback function to handle errors and log a success message to the console when the file is written successfully.</p>
<p>Finally, we call the <code>exportData</code> function with the <code>products</code> array as an argument to write the product data to the file.</p>
<p>And that’s it! We have successfully scraped product data from an e-commerce website using Puppeteer and TypeScript, implemented pagination to extract all available data, parsed and transformed the data, and exported it to a JSON file.</p>
<p>Conclusion</p>
<p>Web scraping can be a powerful tool for gathering data and insights from websites. However, it is important to do so in a responsible and ethical manner. In this project, we have demonstrated how to scrape product data from an e-commerce website using Puppeteer and TypeScript, while also discussing best practices and ethical considerations.</p>
<p>Some potential next steps for this project could be to add error handling and retry logic, implement support for scraping multiple categories, or export the data to a database instead of a file. With the skills and techniques covered in this project, you should have a solid foundation for building more complex and sophisticated web scraping applications.</p>
<h2 id="storing-data-in-a-database">Storing data in a database</h2>
<p>Once we have scraped and parsed the data, the next step is to store it in a database for further use. In this project, we will use MongoDB, a popular NoSQL database, to store our scraped product data. Here are the steps to store data in MongoDB using Node.js:</p>
<ol>
<li>Install the MongoDB Node.js driver:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">install</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">mongodb</span></span></code></pre>
<ol start="2">
<li>Import the MongoDB driver and establish a connection to the database:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">MongoClient</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mongodb'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">uri</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mongodb://localhost:27017'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">MongoClient</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">uri</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">connectToDatabase</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">connect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Connected to MongoDB'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<ol start="3">
<li>Define a schema for the data:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">image</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">description</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">category</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">brand</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<ol start="4">
<li>Create a collection in the database:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">createCollection</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">database</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">db</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'mydb'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">database</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">collection</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'products'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">collection</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<ol start="5">
<li>Insert the data into the collection:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">insertData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">products</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF">[]) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">createCollection</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">result</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">insertMany</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E5C07B">result</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">insertedCount</span><span style="color: #C678DD">}</span><span style="color: #98C379"> documents were inserted into the collection`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>Putting it all together, here’s how we can store our scraped data in MongoDB:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">MongoClient</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mongodb'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">Product</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./types'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">uri</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'mongodb://localhost:27017'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">MongoClient</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">uri</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">connectToDatabase</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">connect</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Connected to MongoDB'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">price</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">image</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">description</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">category</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">brand</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">createCollection</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">database</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">db</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'mydb'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">database</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">collection</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'products'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">collection</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">insertData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">products</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Product</span><span style="color: #ABB2BF">[]) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">createCollection</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">result</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">collection</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">insertMany</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E5C07B">result</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">insertedCount</span><span style="color: #C678DD">}</span><span style="color: #98C379"> documents were inserted into the collection`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">main</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">connectToDatabase</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// scrape and parse product data</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">products</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span><span style="color: #7F848E; font-style: italic">/* array of Product objects */</span><span style="color: #ABB2BF">];</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">insertData</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">client</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">main</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>With these steps, we can store our scraped product data in a MongoDB database for further use.</p>
<h2 id="building-a-web-interface-to-display-scraped-data">Building a web interface to display scraped data</h2>
<p>To build a web interface to display the scraped data, we will need to create a web application that fetches the data from the database and displays it in an organized and user-friendly format. We can use a web framework like Express to build the web application.</p>
<p>First, let’s install the necessary dependencies:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install express ejs mysql2</span></span></code></pre>
<ul>
<li><code>express</code>: a popular Node.js web framework for building web applications</li>
<li><code>ejs</code>: a templating engine for rendering dynamic HTML templates</li>
<li><code>mysql2</code>: a MySQL client for Node.js</li>
</ul>
<p>Next, let’s create a new file <code>index.js</code> in the project directory and add the following code:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">express</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'express'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">mysql</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'mysql2/promise'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">app</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">express</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">port</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">process</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">env</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">PORT</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">3000</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Create a MySQL connection pool</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">pool</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">mysql</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">createPool</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">host</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'localhost'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">user</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'root'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">password</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'password'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">database</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'my_database'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Define the route for the home page</span></span>
<span class="line"><span style="color: #E5C07B">app</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'/'</span><span style="color: #ABB2BF">, </span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75; font-style: italic">req</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">res</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Fetch the product data from the database</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">conn</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">pool</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">getConnection</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">rows</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">conn</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">execute</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'SELECT * FROM products'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">conn</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">release</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Render the home page with the product data</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">res</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">render</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'index'</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">products</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">rows</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Start the server</span></span>
<span class="line"><span style="color: #E5C07B">app</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">listen</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">port</span><span style="color: #ABB2BF">, () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Server is listening on port </span><span style="color: #C678DD">${</span><span style="color: #E06C75">port</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this code, we first create an instance of the Express application and set the port to listen on. We also create a MySQL connection pool using the <code>mysql2/promise</code> package, which allows us to execute SQL queries asynchronously.</p>
<p>Next, we define a route for the home page using the <code>app.get()</code> method. In this route, we fetch the product data from the <code>products</code> table in the database using the <code>execute()</code> method on the connection pool. We then release the connection to the pool using the <code>release()</code> method. Finally, we render the <code>index.ejs</code> template with the product data using the <code>res.render()</code> method.</p>
<p>We also need to create a new file <code>index.ejs</code> in the <code>views</code> directory and add the following code:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #ABB2BF">&#x3C;!</span><span style="color: #E06C75">DOCTYPE</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">html</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  &#x3C;</span><span style="color: #E06C75">head</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">>My E-commerce Site&#x3C;/</span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  &#x3C;/</span><span style="color: #E06C75">head</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  &#x3C;</span><span style="color: #E06C75">body</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">h1</span><span style="color: #ABB2BF">>My E-commerce Site&#x3C;/</span><span style="color: #E06C75">h1</span><span style="color: #ABB2BF">></span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;</span><span style="color: #E06C75">table</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">thead</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;</span><span style="color: #E06C75">tr</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;</span><span style="color: #E06C75">th</span><span style="color: #ABB2BF">>Product Name&#x3C;/</span><span style="color: #E06C75">th</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;</span><span style="color: #E06C75">th</span><span style="color: #ABB2BF">>Price&#x3C;/</span><span style="color: #E06C75">th</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;</span><span style="color: #E06C75">th</span><span style="color: #ABB2BF">>Category&#x3C;/</span><span style="color: #E06C75">th</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;</span><span style="color: #E06C75">th</span><span style="color: #ABB2BF">>Description&#x3C;/</span><span style="color: #E06C75">th</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        &#x3C;/</span><span style="color: #E06C75">tr</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">thead</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;</span><span style="color: #E06C75">tbody</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #FFFFFF">&#x3C;</span><span style="color: #ABB2BF">% for (const product of products) { %></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;</span><span style="color: #E06C75">tr</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;</span><span style="color: #E06C75">td</span><span style="color: #ABB2BF">></span><span style="color: #FFFFFF">&#x3C;</span><span style="color: #ABB2BF">%= product.name %>&#x3C;/</span><span style="color: #E06C75">td</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;</span><span style="color: #E06C75">td</span><span style="color: #ABB2BF">></span><span style="color: #FFFFFF">&#x3C;</span><span style="color: #ABB2BF">%= product.price %>&#x3C;/</span><span style="color: #E06C75">td</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;</span><span style="color: #E06C75">td</span><span style="color: #ABB2BF">></span><span style="color: #FFFFFF">&#x3C;</span><span style="color: #ABB2BF">%= product.category %>&#x3C;/</span><span style="color: #E06C75">td</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">            &#x3C;</span><span style="color: #E06C75">td</span><span style="color: #ABB2BF">></span><span style="color: #FFFFFF">&#x3C;</span><span style="color: #ABB2BF">%= product.description %>&#x3C;/</span><span style="color: #E06C75">td</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">          &#x3C;/</span><span style="color: #E06C75">tr</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #FFFFFF">&#x3C;</span><span style="color: #ABB2BF">% } %></span></span>
<span class="line"><span style="color: #ABB2BF">      &#x3C;/</span><span style="color: #E06C75">tbody</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">    &#x3C;/</span><span style="color: #E06C75">table</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">  &#x3C;/</span><span style="color: #E06C75">body</span><span style="color: #ABB2BF">></span></span>
<span class="line"><span style="color: #ABB2BF">&#x3C;/</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">></span></span></code></pre>
<p>In this template, we use EJS syntax to loop through the <code>products</code> array and render the product data in an HTML table.</p>
<p>Finally, let’s start the web application by running the command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">node index.js</span></span></code></pre>
<p>This will start the web server, and we can access the home page by navigating to <code>http://localhost:3000</code> in a web browser. The page should display the product data in a table format.</p>
<p>We can also add additional routes to the web application to display specific product
information, such as product details, images, and customer reviews. With this, the user can browse through the scraped data and find the products they are interested in.</p>
<p>Another useful feature we can add is the ability to filter and sort the data. This can be done by implementing search functionality and sorting options based on various parameters like price, rating, and popularity.</p>
<p>To improve the user experience, we can also add pagination to the product listings, allowing the user to easily navigate through the results and view more products without having to reload the page.</p>
<p>Finally, we can add some visualizations to help the user gain insights into the data, such as price distribution charts, popular brand charts, and customer review sentiment analysis.</p>
<p>With these features in place, our web application can provide a powerful tool for users to search and analyze the scraped e-commerce data.</p>
<h1 id="chapter-13-building-a-web-scraper-with-typescript-scraping-social-media-websites">Chapter 13: Building a Web Scraper with TypeScript: Scraping Social Media Websites</h1>
<h2 id="project-overview-1">Project overview</h2>
<p>Sure! In this project, we will be building a web scraper that extracts data on job postings from a popular job search website. We will use the Axios library to send HTTP requests to the website and Cheerio to parse and extract data from the HTML response. The extracted data will then be transformed and stored in a MongoDB database. Finally, we will build a web interface that displays the stored job postings in a table format, with the ability to search and filter results.</p>
<p>The project will involve setting up a Node.js environment, installing and configuring the necessary libraries, building the web scraper, and building the web interface using a front-end framework like React or Vue. Additionally, we will need to consider ethical concerns and best practices for web scraping, such as respecting website terms of service and avoiding overloading the website with requests.</p>
<h2 id="setting-up-the-project-2">Setting up the project</h2>
<p>To set up the project, we need to follow a few steps:</p>
<ol>
<li>Create a new directory for our project</li>
<li>Initialize a new Node.js project using <code>npm init</code> command</li>
<li>Install the required dependencies:
<ul>
<li><code>puppeteer</code> to automate browsing</li>
<li><code>dotenv</code> to load environment variables</li>
<li><code>express</code> to build the web application</li>
<li><code>ejs</code> to render dynamic HTML templates</li>
<li><code>mongoose</code> to connect to a MongoDB database and store the scraped data</li>
</ul>
</li>
<li>Create a <code>.env</code> file to store environment variables like the URL of the e-commerce website, the database connection string, and any other sensitive information</li>
<li>Create a <code>index.ts</code> file to start the application</li>
</ol>
<p>Here’s the step-by-step guide:</p>
<ol>
<li>Open the terminal and create a new directory for our project:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">mkdir e-commerce-scraper</span></span></code></pre>
<ol start="2">
<li>Change the current directory to the newly created directory:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">cd e-commerce-scraper</span></span></code></pre>
<ol start="3">
<li>Initialize a new Node.js project by running the following command and answering the questions prompted:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm init</span></span></code></pre>
<ol start="4">
<li>Install the required dependencies by running the following command:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install puppeteer dotenv express ejs mongoose</span></span></code></pre>
<ol start="5">
<li>Create a <code>.env</code> file in the root directory of our project and add the following environment variables:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">E_COMMERCE_URL=&#x3C;URL_OF_E_COMMERCE_WEBSITE></span></span>
<span class="line"><span style="color: #abb2bf">MONGODB_URI=&#x3C;MONGODB_CONNECTION_STRING></span></span></code></pre>
<p>Replace <code>&#x3C;URL_OF_E_COMMERCE_WEBSITE></code> with the URL of the e-commerce website that we want to scrape and <code>&#x3C;MONGODB_CONNECTION_STRING></code> with the connection string of the MongoDB database where we want to store the scraped data.</p>
<ol start="6">
<li>Create a <code>index.ts</code> file in the root directory of our project and add the following code:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">express</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'express'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">dotenv</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'dotenv'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">dotenv</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">config</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">app</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">express</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">app</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">listen</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">3000</span><span style="color: #ABB2BF">, () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Server started at http://localhost:3000'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>This code imports the required dependencies, loads the environment variables from the <code>.env</code> file, and starts an Express server on port 3000.</p>
<ol start="7">
<li>Run the following command to compile the TypeScript code to JavaScript:</li>
</ol>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npx tsc</span></span></code></pre>
<p>This creates a <code>index.js</code> file in the <code>dist</code> directory, which we can run to start the application:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">node dist/index.js</span></span></code></pre>
<p>Now, if we open the URL <code>http://localhost:3000</code> in a web browser, we should see a message <code>Cannot GET /</code>, which means that our application is running successfully but we have not defined any routes yet.</p>
<h2 id="scraping-data-from-twitter-with-axios">Scraping data from Twitter with Axios</h2>
<p>To start scraping data from Twitter with Axios, we need to first understand the Twitter API and how to authenticate with it. Twitter provides an API that allows developers to interact with Twitter data programmatically. However, to access this API, we need to authenticate our application with Twitter.</p>
<p>Twitter API authentication requires creating a Twitter Developer Account and creating a new Twitter App. Once we have created a Twitter App, we can obtain the necessary authentication credentials, including the Consumer Key, Consumer Secret, Access Token, and Access Token Secret. These credentials are used to sign each API request and verify that the request is being made by an authorized application.</p>
<p>After obtaining the authentication credentials, we can use Axios to send HTTP requests to the Twitter API and receive data in JSON format. We can then use JavaScript or TypeScript to parse the JSON data and extract the relevant information.</p>
<p>To start the project, we need to create a new directory and initialize a new Node.js project with the following command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">mkdir twitter-scraper</span></span>
<span class="line"><span style="color: #abb2bf">cd twitter-scraper</span></span>
<span class="line"><span style="color: #abb2bf">npm init -y</span></span></code></pre>
<p>This will create a new directory called <code>twitter-scraper</code>, navigate into the directory, and initialize a new Node.js project with default settings.</p>
<p>Next, we need to install the necessary dependencies:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install axios dotenv</span></span></code></pre>
<p>This will install Axios, a popular HTTP client for Node.js, and dotenv, a module for loading environment variables from a .env file.</p>
<p>We also need to create a new file called <code>.env</code> in the root directory of the project and add our Twitter API authentication credentials:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">CONSUMER_KEY=your_consumer_key</span></span>
<span class="line"><span style="color: #abb2bf">CONSUMER_SECRET=your_consumer_secret</span></span>
<span class="line"><span style="color: #abb2bf">ACCESS_TOKEN=your_access_token</span></span>
<span class="line"><span style="color: #abb2bf">ACCESS_TOKEN_SECRET=your_access_token_secret</span></span></code></pre>
<p>We can obtain these credentials by creating a Twitter Developer Account and creating a new Twitter App as mentioned earlier.</p>
<p>With the necessary dependencies and authentication credentials in place, we can now start scraping data from Twitter with Axios.</p>
<h2 id="extracting-user-information-with-cheerio">Extracting user information with Cheerio</h2>
<p>To extract user information with Cheerio, you can use the <code>load()</code> method to load the HTML content and then use Cheerio’s selector syntax to extract the relevant data.</p>
<p>Here’s an example:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">require</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">getUserInfo</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">username</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">try</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`https://twitter.com/</span><span style="color: #C678DD">${</span><span style="color: #E06C75">username</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">name</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="primaryColumn"] h1'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">handle</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="primaryColumn"] span'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">bio</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserDescription"] span'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'span[data-testid="PlaceTag"]'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">website</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a[data-testid="UserProfileHeaderItems_Url"]'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'href'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">joinedDate</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'span[data-testid="AccountCreationDate"]'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">tweets</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="primaryColumn"] [data-testid="tweets"] span'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data-count'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">following</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="primaryColumn"] [data-testid="following"] span'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data-count'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">followers</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="primaryColumn"] [data-testid="followers"] span'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">      .</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data-count'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">handle</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">bio</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">location</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">website</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">joinedDate</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">tweets</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">following</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">followers</span></span>
<span class="line"><span style="color: #ABB2BF">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">catch</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// example usage</span></span>
<span class="line"><span style="color: #61AFEF">getUserInfo</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'elonmusk'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">  .</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">data</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">))</span></span>
<span class="line"><span style="color: #ABB2BF">  .</span><span style="color: #61AFEF">catch</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">error</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">error</span><span style="color: #ABB2BF">));</span></span></code></pre>
<p>In this example, we first use Axios to make an HTTP GET request to the Twitter user’s profile page. We then use Cheerio’s <code>load()</code> method to load the HTML content of the page and use Cheerio’s selector syntax to extract the relevant data.</p>
<p>We extract the user’s name, Twitter handle, bio, location, website, joined date, number of tweets, number of people the user is following, and number of followers. We return this data as an object.</p>
<p>Note that in this example, we’re using <code>async/await</code> syntax to handle the asynchronous nature of the HTTP request and the Cheerio parsing.</p>
<h2 id="parsing-and-transforming-data-with-typescript-2">Parsing and transforming data with TypeScript</h2>
<p>To parse and transform the scraped data, we can use TypeScript. TypeScript is a superset of JavaScript that allows us to write strongly-typed code with features like classes, interfaces, and type annotations. With TypeScript, we can catch errors at compile-time instead of run-time, which can make our code more robust.</p>
<p>First, we need to install TypeScript as a development dependency in our project. We can do this by running the following command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install --save-dev typescript</span></span></code></pre>
<p>Next, we can create a new file called <code>user.ts</code> in our <code>src</code> directory. In this file, we can define an interface to represent a Twitter user:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">TwitterUser</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">bio</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">location</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">website</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">joinDate</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">Date</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">followersCount</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">followingCount</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">tweetsCount</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>We can also define a function to parse the HTML response and return an array of <code>TwitterUser</code> objects:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseUsers</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">html</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">TwitterUser</span><span style="color: #ABB2BF">[] {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">TwitterUser</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserCell"]'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">each</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">i</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a[data-testid="UserCell:userLink"]'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">name</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserCell:name"]'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">bio</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserCell:bio"]'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserCell:location"]'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">website</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a[data-testid="UserCell:website"]'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">joinDate</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Date</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'span[data-testid="UserCell:joinDate"]'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">followersCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a[data-testid="UserCell:followers"] span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'title'</span><span style="color: #ABB2BF">)?.</span><span style="color: #61AFEF">replace</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">/,/</span><span style="color: #C678DD">g</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">''</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">??</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'0'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">followingCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a[data-testid="UserCell:following"] span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'title'</span><span style="color: #ABB2BF">)?.</span><span style="color: #61AFEF">replace</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">/,/</span><span style="color: #C678DD">g</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">''</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">??</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'0'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">tweetsCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">find</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a[data-testid="UserCell:tweets"] span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'title'</span><span style="color: #ABB2BF">)?.</span><span style="color: #61AFEF">replace</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">/,/</span><span style="color: #C678DD">g</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">''</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">??</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'0'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">user</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">TwitterUser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">bio</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">location</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">website</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">joinDate</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">followersCount</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">followingCount</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">tweetsCount</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">user</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">users</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>This function uses Cheerio to parse the HTML response and extract the relevant user information. We can then create <code>TwitterUser</code> objects and add them to an array, which we return at the end.</p>
<p>To test our code, we can create a new file called <code>test.ts</code> in our <code>src</code> directory. In this file, we can import <code>axios</code> and <code>parseUsers</code>, and use them to scrape user data from Twitter:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">parseUsers</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">TwitterUser</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./user'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeUsers</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'https://twitter.com/i/api/graphql/hZ5oFYz59DnPmZZe75yB4Q/UserByScreenNameWithoutResults'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">params</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">variables</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">JSON</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">stringify</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #98C379">"screen_name"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"elonmusk"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #98C379">"withHighlightedLabel"</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span></span>
<span class="line"><span style="color: #ABB2BF">    })</span></span>
<span class="line"><span style="color: #ABB2BF">  };</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span></span>
<span class="line"><span style="color: #ABB2BF">  .</span><span style="color: #61AFEF">post</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">ApiResponse</span><span style="color: #ABB2BF">>(</span><span style="color: #E5C07B">SEARCH_API_URL</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">requestBody</span><span style="color: #ABB2BF">, {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">headers</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #98C379">"content-type"</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">"application/json"</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E06C75">authorization</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">`Bearer </span><span style="color: #C678DD">${</span><span style="color: #E06C75">bearerToken</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    },</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">TwitterUser</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">data</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">globalObjects</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">users</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">users</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeTwitterUsers</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75; font-style: italic">searchQuery</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75; font-style: italic">maxResults</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">number</span></span>
<span class="line"><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">TwitterUser</span><span style="color: #ABB2BF">[]> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">TwitterUser</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cursor</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">""</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">while</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">&#x3C;</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">maxResults</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">apiResponse</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">searchTwitterUsers</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">searchQuery</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">cursor</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">newUsers</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Object</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">values</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiResponse</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E5C07B">newUsers</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">break</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">(...</span><span style="color: #E06C75">newUsers</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">cursor</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">apiResponse</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E5C07B">timeline</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">instructions</span><span style="color: #ABB2BF">[</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">].</span><span style="color: #E5C07B">addEntries</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">entries</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">pop</span><span style="color: #ABB2BF">().</span><span style="color: #E5C07B">content</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">operation</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">cursor</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">value</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">slice</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">maxResults</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> () </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeTwitterUsers</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"elon musk"</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">users</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">})();</span></span></code></pre>
<p>In this code, we define the <code>TwitterUser</code> interface and the <code>searchTwitterUsers</code> and <code>scrapeTwitterUsers</code> functions.</p>
<p>The <code>TwitterUser</code> interface defines the properties of a user object returned by the Twitter API.</p>
<p>The <code>searchTwitterUsers</code> function sends a POST request to the Twitter API to search for users matching the given query. It uses the <code>axios</code> library to make the request and passes the necessary headers and request body. The function returns the response data as an object.</p>
<p>The <code>scrapeTwitterUsers</code> function calls <code>searchTwitterUsers</code> in a loop until it has collected the desired number of users. It stores the collected users in an array and returns the array when it is finished.</p>
<p>Finally, we call <code>scrapeTwitterUsers</code> and log the results to the console.</p>
<p>This code provides a basic example of how to scrape data from Twitter using Axios and TypeScript. We can modify this code to scrape other types of data from Twitter, such as tweets or hashtags, by changing the request parameters and parsing the response data accordingly.</p>
<h2 id="exporting-data-to-a-sqlite-database">Exporting data to a SQLite database</h2>
<p>To store the scraped data from Twitter in a database, we will use SQLite, a lightweight and easy-to-use database management system.</p>
<p>First, we need to install the necessary packages using the following command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #61AFEF">npm</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">install</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">sqlite3</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">sequelize</span></span></code></pre>
<p>We will also create a new file called <code>database.ts</code> where we will define the connection to the database and create the necessary models.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">Sequelize</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">DataTypes</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'sequelize'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">sequelize</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Sequelize</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">dialect</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'sqlite'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">storage</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'data/twitter.db'</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Define the User model</span></span>
<span class="line"><span style="color: #C678DD">export</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">sequelize</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">define</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'User'</span><span style="color: #ABB2BF">, {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">type</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">DataTypes</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">STRING</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">allowNull</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">type</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">DataTypes</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">STRING</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">allowNull</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">followers</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">type</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">DataTypes</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">INTEGER</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">allowNull</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">tweets</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">type</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">DataTypes</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">INTEGER</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">allowNull</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Sync the database and create the necessary tables</span></span>
<span class="line"><span style="color: #E5C07B">sequelize</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">sync</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">force</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF"> }).</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Database synced'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In the above code, we are defining the <code>User</code> model with four attributes: <code>username</code>, <code>name</code>, <code>followers</code>, and <code>tweets</code>. We are also defining the connection to the database using the <code>sequelize</code> object and specifying that we want to use the SQLite dialect with a file-based storage location.</p>
<p>We are then syncing the database and creating the necessary tables by calling the <code>sync</code> method on the <code>sequelize</code> object. We are also specifying the <code>force: true</code> option to drop any existing tables and recreate them.</p>
<p>Now, we can modify our <code>app.ts</code> file to use the <code>sequelize</code> object to insert the scraped data into the <code>User</code> table.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">User</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./database'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeTwitter</span><span style="color: #ABB2BF">(): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">void</span><span style="color: #ABB2BF">> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://twitter.com/elonmusk'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a.ProfileHeaderCard-screennameLink span.username'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">name</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a.ProfileHeaderCard-nameLink'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">followers</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a[data-nav="followers"] span.ProfileNav-value'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data-count'</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">??</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'0'</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">tweets</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'a[data-nav="tweets"] span.ProfileNav-value'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data-count'</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">??</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'0'</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">create</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">username</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">followers</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">tweets</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'User data inserted into database'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">scrapeTwitter</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>In the above code, we are importing the <code>User</code> model from the <code>database.ts</code> file and using the <code>create</code> method to insert the scraped data into the <code>User</code> table. We are also logging a success message to the console when the data is inserted successfully.</p>
<p>Now, when we run the <code>scrapeTwitter</code> function, the scraped data will be inserted into the <code>User</code> table in the SQLite database.</p>
<p>Now that we have successfully scraped and transformed the data, we can export it to a SQLite database using the <code>sqlite3</code> package. We will create a new file <code>database.ts</code> to define the database connection and schema.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">sqlite3</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'sqlite3'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Open the database connection</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">db</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">sqlite3</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">Database</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'./data/twitter.db'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Create the User table</span></span>
<span class="line"><span style="color: #E5C07B">db</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">run</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span></span>
<span class="line"><span style="color: #98C379">  CREATE TABLE IF NOT EXISTS User (</span></span>
<span class="line"><span style="color: #98C379">    id INTEGER PRIMARY KEY,</span></span>
<span class="line"><span style="color: #98C379">    name TEXT NOT NULL,</span></span>
<span class="line"><span style="color: #98C379">    username TEXT NOT NULL,</span></span>
<span class="line"><span style="color: #98C379">    bio TEXT,</span></span>
<span class="line"><span style="color: #98C379">    location TEXT,</span></span>
<span class="line"><span style="color: #98C379">    website TEXT,</span></span>
<span class="line"><span style="color: #98C379">    join_date TEXT,</span></span>
<span class="line"><span style="color: #98C379">    follower_count INTEGER,</span></span>
<span class="line"><span style="color: #98C379">    following_count INTEGER,</span></span>
<span class="line"><span style="color: #98C379">    tweet_count INTEGER,</span></span>
<span class="line"><span style="color: #98C379">    likes_count INTEGER</span></span>
<span class="line"><span style="color: #98C379">  )</span></span>
<span class="line"><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Close the database connection</span></span>
<span class="line"><span style="color: #E5C07B">db</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>In the above code, we open a connection to the <code>twitter.db</code> database file and create the <code>User</code> table if it does not already exist. The <code>User</code> table has columns for the user’s name, username, bio, location, website, join date, follower count, following count, tweet count, and likes count.</p>
<p>Next, we will modify the <code>scrapeTwitter</code> function to insert the scraped data into the <code>User</code> table.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">sqlite3</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'sqlite3'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">// Open the database connection</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">db</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">sqlite3</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">Database</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'./data/twitter.db'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeTwitter</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">username</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">url</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">`https://twitter.com/</span><span style="color: #C678DD">${</span><span style="color: #E06C75">username</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">name</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserProfileHeader_Items"] > div:nth-child(1) > div > div > div:nth-child(1) > div > div > div > div > div > div > div > div > div > div > div > div > div > div > span'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    .</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">usernameElement</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserProfileHeader_Items"] > div:nth-child(1) > div > div > div:nth-child(1) > div > div > div > div > div > div > div > div > div > div > div > div > div > div > a > span:nth-child(1)'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">usernameElement</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">slice</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">bio</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserProfileHeader_Items"] > div:nth-child(2) > div > div > div > span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">() </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserProfileHeader_Items"] > div:nth-child(2) > div > div > div > div > span:nth-child(1)'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">() </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">website</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">usernameElement</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'title'</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">null</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">joinDate</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> &#x3C;</span><span style="color: #E5C07B">span</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">class</span><span style="color: #ABB2BF">=</span><span style="color: #98C379">"math-inline"</span><span style="color: #ABB2BF">>\(</span><span style="color: #98C379">'div[data-testid="UserProfileHeader_Items"] > div:nth-child</span><span style="color: #56B6C2">\(</span><span style="color: #98C379">2</span><span style="color: #56B6C2">\)</span><span style="color: #98C379"> > div > div > div > span:nth-child</span><span style="color: #56B6C2">\(</span><span style="color: #98C379">2</span><span style="color: #56B6C2">\)</span><span style="color: #98C379"> > span'</span><span style="color: #ABB2BF">\)\.</span><span style="color: #E06C75">text</span><span style="color: #ABB2BF">\(\)\.</span><span style="color: #E06C75">slice</span><span style="color: #ABB2BF">\(</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">\);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">followerCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">parseInt</span><span style="color: #ABB2BF">\(&#x3C;/</span><span style="color: #E5C07B">span</span><span style="color: #ABB2BF">>(</span><span style="color: #98C379">'div[data-testid="UserProfileHeader_Items"] > div:nth-child(3) > div > a > div > div:nth-child(2) > span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data-count'</span><span style="color: #ABB2BF">)</span><span style="color: #56B6C2">!</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">followingCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(&#x3C;</span><span style="color: #E5C07B">span</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">class</span><span style="color: #ABB2BF">=</span><span style="color: #98C379">"math-inline"</span><span style="color: #ABB2BF">>\(</span><span style="color: #98C379">'div[data-testid="UserProfileHeader_Items"] > div:nth-child</span><span style="color: #56B6C2">\(</span><span style="color: #98C379">3</span><span style="color: #56B6C2">\)</span><span style="color: #98C379"> > div > a + div > div:nth-child</span><span style="color: #56B6C2">\(</span><span style="color: #98C379">2</span><span style="color: #56B6C2">\)</span><span style="color: #98C379"> > span'</span><span style="color: #ABB2BF">\)\.</span><span style="color: #E06C75">attr</span><span style="color: #ABB2BF">\(</span><span style="color: #98C379">'data-count'</span><span style="color: #ABB2BF">\)\</span><span style="color: #56B6C2">!</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">\);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">tweetCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">parseInt</span><span style="color: #ABB2BF">\(&#x3C;/</span><span style="color: #E5C07B">span</span><span style="color: #ABB2BF">>(</span><span style="color: #98C379">'div[data-testid="UserProfileHeader_Items"] > div:nth-child(3) > div > a + div + div > div:nth-child(2) > span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data-count'</span><span style="color: #ABB2BF">)</span><span style="color: #56B6C2">!</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">likesCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">parseInt</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'div[data-testid="UserProfileHeader_Items"] > div:nth-child(3) > div > a + div + div + div > div:nth-child(2) > span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'data-count'</span><span style="color: #ABB2BF">)</span><span style="color: #56B6C2">!</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Insert the user data into the database</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">stmt</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">db</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">prepare</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'INSERT INTO users (username, name, bio, location, website, join_date, follower_count, following_count, tweet_count, likes_count) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">stmt</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">run</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">username</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">bio</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">location</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">website</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">joinDate</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">followerCount</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">followingCount</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">tweetCount</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">likesCount</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// Close the database connection</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">db</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>copy XPath from Chrome, follow these steps:</p>
<ol>
<li>Open the Chrome web browser.</li>
<li>Go to the web page that contains the element you want to copy the XPath for.</li>
<li>Right-click on the element and select “Inspect Element”.</li>
<li>The Developer Tools will open in the bottom right corner of the browser window.</li>
<li>In the Developer Tools, click on the “Elements” tab. The element you right-clicked on will be highlighted in the Elements tab.</li>
<li>Right-click on the element and select “Copy XPath”.</li>
<li>The XPath for the element will be copied to your clipboard.
You can now paste the XPath into a text editor or other program. This is one way to find xpaths for purposes of web scraping.</li>
</ol>
<h2 id="authenticating-with-twitter-api-and-accessing-more-data">Authenticating with Twitter API and accessing more data</h2>
<p>To access more data from Twitter, we need to authenticate our application with the Twitter API. This will allow us to access user data that is not publicly available on the Twitter website.</p>
<p>First, we need to create a Twitter Developer account and create a new project. Once we have a project set up, we can create an app and generate API keys and access tokens.</p>
<p>With our API keys and access tokens, we can use the <code>twitter</code> package in Node.js to authenticate with the Twitter API and access more user data.</p>
<p>To authenticate with the Twitter API, we need to create a new instance of the <code>Twitter</code> class and pass in our API keys and access tokens as options. We can then call methods on the <code>Twitter</code> instance to access user data.</p>
<p>For example, we can use the <code>Twitter</code> instance to get a user’s timeline with the <code>get</code> method:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">twitter</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Twitter</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">consumer_key</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'your_consumer_key'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">consumer_secret</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'your_consumer_secret'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">access_token_key</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'your_access_token_key'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">access_token_secret</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'your_access_token_secret'</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">params</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> {</span><span style="color: #E06C75">screen_name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'elonmusk'</span><span style="color: #ABB2BF">};</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">result</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">twitter</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'statuses/user_timeline'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">params</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>This will return an array of the user’s tweets, which we can then parse and transform as needed.</p>
<p>In addition to the <code>statuses/user_timeline</code> endpoint, the Twitter API provides many other endpoints that allow us to access user data such as followers, friends, and favorites. By combining these endpoints with Puppeteer and Cheerio, we can scrape and extract a wealth of data from Twitter.</p>
<h2 id="scraping-instagram-data-with-puppeteer">Scraping Instagram data with Puppeteer</h2>
<p>Let’s dive into scraping Instagram data with Puppeteer!</p>
<p>Instagram is a popular social media platform with a lot of user-generated content, making it a good target for web scraping. However, scraping Instagram data is not easy due to its dynamic content and anti-scraping measures. Puppeteer is a great tool for scraping dynamic websites, so we can use it to extract data from Instagram.</p>
<p>First, we need to install Puppeteer and create a new Puppeteer instance:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>Next, we can navigate to the Instagram website and log in:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.instagram.com/'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">usernameInput</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$x</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'//input[@name="username"]'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">usernameInput</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'your_username'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">passwordInput</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$x</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'//input[@name="password"]'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">passwordInput</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'your_password'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> [</span><span style="color: #E5C07B">loginButton</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$x</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'//button[@type="submit"]'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">loginButton</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>Note that we are using XPath selectors to locate the username input, password input, and login button on the page.</p>
<p>After logging in, we can navigate to a specific user’s profile page and extract data from it. For example, we can extract the user’s follower count and bio:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.instagram.com/username/'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">followerCountElement</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.k9GMp span'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">followerCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">evaluate</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">followerCountElement</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">bioElement</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'._7UhW9'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">bio</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">evaluate</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">textContent</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">bioElement</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Follower count: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">followerCount</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Bio: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">bio</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>We are using CSS selectors to locate the follower count element and bio element on the page, and then using <code>page.evaluate()</code> to extract their text content.</p>
<p>We can also extract data from a user’s posts on their profile page. For example, we can extract the URLs of the images in their posts:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">postImages</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'img.FFVAD'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">elements</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">elements</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">src</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Post images: </span><span style="color: #C678DD">${</span><span style="color: #E06C75">postImages</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>Here, we are using <code>page.$$eval()</code> to evaluate a function on all elements that match the given CSS selector. The function extracts the <code>src</code> attribute of each image element and returns an array of URLs.</p>
<p>Once we have extracted the desired data, we can close the Puppeteer browser:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>Overall, scraping Instagram data with Puppeteer requires navigating the dynamic website and using CSS selectors and <code>page.evaluate()</code> to extract the desired data.</p>
<h2 id="handling-authentication-and-scrolling-on-instagram">Handling authentication and scrolling on Instagram</h2>
<p>Instagram uses an infinite scrolling mechanism to display images, meaning that more images are loaded as the user scrolls down. To scrape data from Instagram, we need to handle this infinite scrolling mechanism with Puppeteer.</p>
<p>To start, we need to authenticate with Instagram. Similar to Twitter, we can use Puppeteer to automate the process of logging in. After logging in, we can navigate to the profile page of the user we want to scrape data from.</p>
<p>Once on the profile page, we need to scroll down and load all the images. We can do this by scrolling to the bottom of the page and waiting for a few seconds to allow new images to load. We can then continue scrolling down and waiting until there are no more new images loaded. We can determine this by checking the height of the page before and after scrolling, and if the height remains the same, we know that we have reached the end of the page.</p>
<p>After all the images have been loaded, we can extract the data we need from each image. This typically includes information such as the image URL, caption, number of likes and comments, and any hashtags associated with the image.</p>
<p>We can use Puppeteer and Cheerio together to extract this data. Puppeteer is used to navigate and scroll through the page, while Cheerio is used to extract the data from the HTML.</p>
<p>Once we have extracted all the data, we can store it in a file or database for further analysis or use.</p>
<h2 id="extracting-user-information-and-posts-with-cheerio">Extracting user information and posts with Cheerio</h2>
<p>After successfully logging into Instagram, the next step is to extract the user’s profile information and their recent posts. We can use Cheerio to parse and extract the relevant data from the HTML page.</p>
<p>To extract the user’s profile information, we can inspect the HTML page and identify the HTML elements that contain the relevant data. We can then use Cheerio’s selector functions to select these elements and extract the necessary information.</p>
<p>Here’s an example code snippet that extracts the user’s profile picture URL, username, full name, bio, website, and number of posts:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">content</span><span style="color: #ABB2BF">());</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">profilePicUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'header img'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'src'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">username</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'header h1'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">fullName</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'header h1 + span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">bio</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'header + div span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">website</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'header + div a'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">numPosts</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'header + div span'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">eq</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>To extract the user’s recent posts, we can use a similar approach. We can identify the HTML elements that contain the post information, select them using Cheerio, and extract the relevant data. Here’s an example code snippet that extracts the URLs of the user’s recent posts:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">postUrls</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'article a'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">i</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">el</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">el</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">attr</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'href'</span><span style="color: #ABB2BF">)).</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>This code selects all <code>&#x3C;a></code> elements inside <code>&#x3C;article></code> elements on the page and extracts their <code>href</code> attribute. This gives us an array of URLs for the user’s recent posts.</p>
<p>Note that Instagram may have measures in place to prevent automated scraping, so it’s important to be mindful of these and to scrape responsibly.</p>
<h2 id="scraping-linkedin-data-with-puppeteer">Scraping LinkedIn data with Puppeteer</h2>
<p>We will be exploring how to scrape LinkedIn data using Puppeteer. Puppeteer is a Node library that provides a high-level API to control headless Chrome or Chromium over the DevTools protocol. It can be used for web scraping, testing, and automating web tasks.</p>
<p>To get started, we will need to install Puppeteer and its dependencies by running the following command:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install puppeteer</span></span></code></pre>
<p>Once we have Puppeteer installed, we can start by launching a new instance of Chrome or Chromium and navigating to the LinkedIn website:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">puppeteer</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'puppeteer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">puppeteer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">launch</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">newPage</span><span style="color: #ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.linkedin.com'</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>After we have navigated to the LinkedIn website, we will need to log in with our credentials. To do this, we can use the <code>type</code> method to enter our email and password into the input fields and then click the login button:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#session_key'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'your_email_here'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#session_password'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'your_password_here'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.sign-in-form__submit-button'</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>Once we have successfully logged in, we can start scraping data from the LinkedIn website. For example, we can scrape the job title, company name, and location of job postings by using the <code>$$</code> method to select all of the job posting elements on the page and then iterating over them to extract the desired data:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobs</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-container'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">for</span><span style="color: #ABB2BF"> (</span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">of</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">jobs</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-list__title'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">company</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-container__company-name'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-container__metadata-item'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E06C75">title</span><span style="color: #C678DD">}</span><span style="color: #98C379"> at </span><span style="color: #C678DD">${</span><span style="color: #E06C75">company</span><span style="color: #C678DD">}</span><span style="color: #98C379"> in </span><span style="color: #C678DD">${</span><span style="color: #E06C75">location</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>Finally, we can close the browser instance once we are finished scraping data:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">browser</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>That’s it! With Puppeteer, we can easily automate web tasks and scrape data from websites like LinkedIn.</p>
<h2 id="handling-authentication-and-pagination-on-linkedin">Handling authentication and pagination on LinkedIn</h2>
<p>We will be exploring how to handle authentication and pagination when scraping LinkedIn data using Puppeteer.</p>
<h2 id="handling-authentication">Handling authentication</h2>
<p>When scraping LinkedIn data, we will need to authenticate ourselves by logging into our account. To do this, we can use Puppeteer’s <code>type</code> and <code>click</code> methods to fill in our email and password and submit the login form.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.linkedin.com/login'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#username'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'your_email_here'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#password'</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'your_password_here'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.login__form_action_container button'</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>If LinkedIn detects suspicious login activity, it may prompt us to verify our identity by sending a verification code to our email or phone number. We can handle this by checking if the verification code input field exists on the page and, if so, entering the code and submitting the form.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">codeInput</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#input__email_verification_pin'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">codeInput</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">code</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'123456'</span><span style="color: #ABB2BF">; </span><span style="color: #7F848E; font-style: italic">// replace with actual verification code</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">codeInput</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">type</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">code</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'#email-pin-submit-button'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<h2 id="handling-pagination">Handling pagination</h2>
<p>When scraping data from LinkedIn, we may encounter pagination if the data we are interested in spans multiple pages. To handle pagination, we can use Puppeteer’s <code>waitForSelector</code> method to wait for the “Next” button to become clickable and then click it to navigate to the next page.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeJobs</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// navigate to the first page of job listings</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.linkedin.com/jobs/search/?keywords=web%20developer'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">while</span><span style="color: #ABB2BF"> (</span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// scrape job data from the current page</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobs</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.jobs-search-results__list li'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">for</span><span style="color: #ABB2BF"> (</span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">of</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">jobs</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__title'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">company</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__company-name'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__location'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E06C75">title</span><span style="color: #C678DD">}</span><span style="color: #98C379"> at </span><span style="color: #C678DD">${</span><span style="color: #E06C75">company</span><span style="color: #C678DD">}</span><span style="color: #98C379"> in </span><span style="color: #C678DD">${</span><span style="color: #E06C75">location</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// navigate to the next page if it exists</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.artdeco-pagination__button--next'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">nextButton</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">break</span><span style="color: #ABB2BF">; </span><span style="color: #7F848E; font-style: italic">// no more pages</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForSelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.jobs-search-results__list li'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeJobs</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>In the above example, we scrape job data from the search results page for the query “web developer”. We use a <code>while</code> loop to navigate to each page of results and scrape the data until there are no more pages. We wait for the presence of job listings on each page before continuing to the next page to avoid errors.</p>
<p>We can also limit the number of pages we scrape by setting a maximum page count. For example, if we only want to scrape the first 5 pages of job listings, we can modify our <code>while</code> loop to break out after 5 iterations:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeJobs</span><span style="color: #ABB2BF">() {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// navigate to the first page of job listings</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.linkedin.com/jobs/search/?keywords=web%20developer'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">pageCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">while</span><span style="color: #ABB2BF"> (</span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// scrape job data from the current page</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobs</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.jobs-search-results__list li'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">for</span><span style="color: #ABB2BF"> (</span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">of</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">jobs</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__title'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">company</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__company-name'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__location'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E06C75">title</span><span style="color: #C678DD">}</span><span style="color: #98C379"> at </span><span style="color: #C678DD">${</span><span style="color: #E06C75">company</span><span style="color: #C678DD">}</span><span style="color: #98C379"> in </span><span style="color: #C678DD">${</span><span style="color: #E06C75">location</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// navigate to the next page if it exists, up to 5 pages</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.artdeco-pagination__button--next'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">nextButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">pageCount</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">===</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">5</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">break</span><span style="color: #ABB2BF">; </span><span style="color: #7F848E; font-style: italic">// no more pages or reached max page count</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForSelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.jobs-search-results__list li'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">pageCount</span><span style="color: #56B6C2">++</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeJobs</span><span style="color: #ABB2BF">();</span></span></code></pre>
<p>In the above example, we use a <code>pageCount</code> variable to keep track of the number of pages we have scraped. We break out of the <code>while</code> loop if we have reached 5 pages or if there are no more pages to navigate to.</p>
<p>With these techniques, we can handle authentication and pagination when scraping data from LinkedIn using Puppeteer. However, it is important to note that web scraping can violate websites’ terms of service and may be illegal in some cases. Always check the legality of web scraping before proceeding and respect websites’ terms of service.</p>
<h2 id="extracting-user-information-with-cheerio-1">Extracting user information with Cheerio</h2>
<p>In this chapter, we will be exploring how to extract user information from LinkedIn profiles using Cheerio, a fast and flexible HTML parsing library for Node.js.</p>
<h2 id="scraping-user-profiles">Scraping user profiles</h2>
<p>To scrape user profiles on LinkedIn, we can use Puppeteer to navigate to the profile page and retrieve the HTML content. We can then pass the HTML content to Cheerio and use it to extract the information we want.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">cheerio</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'cheerio'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeUserProfile</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">url</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">html</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">url</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">name</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.pv-top-card-section__name'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">headline</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.pv-top-card-section__headline'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.pv-top-card-section__location'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">summary</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.pv-about-section .pv-about__summary-text'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E06C75">name</span><span style="color: #C678DD">}</span><span style="color: #56B6C2">\n</span><span style="color: #C678DD">${</span><span style="color: #E06C75">headline</span><span style="color: #C678DD">}</span><span style="color: #56B6C2">\n</span><span style="color: #C678DD">${</span><span style="color: #E06C75">location</span><span style="color: #C678DD">}</span><span style="color: #56B6C2">\n</span><span style="color: #C678DD">${</span><span style="color: #E06C75">summary</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the above example, we define a <code>scrapeUserProfile</code> function that takes a LinkedIn profile URL as input. We use Puppeteer to retrieve the HTML content of the profile page and pass it to Cheerio using <code>cheerio.load</code>. We then use Cheerio to extract the user’s name, headline, location, and summary from the profile page.</p>
<h2 id="scraping-user-skills">Scraping user skills</h2>
<p>LinkedIn users can add skills to their profile to highlight their areas of expertise. To scrape a user’s skills, we can use Cheerio to iterate over the list of skills and extract each skill as text.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeUserSkills</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">url</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">html</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`</span><span style="color: #C678DD">${</span><span style="color: #E06C75">url</span><span style="color: #C678DD">}</span><span style="color: #98C379">/detail/skills`</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">$</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">cheerio</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">load</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">html</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">skills</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.pv-skill-category-entity__name'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">_</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">element</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">text</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">()).</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">skills</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the above example, we define a <code>scrapeUserSkills</code> function that takes a LinkedIn profile URL as input. We use Puppeteer to navigate to the “Skills &#x26; Endorsements” section of the profile page and retrieve the HTML content. We then pass the HTML content to Cheerio using <code>cheerio.load</code> and use Cheerio to extract each skill as text from the list of skills.</p>
<p>With these techniques, we can extract user information and skills from LinkedIn profiles using Cheerio. However, as with all web scraping, it is important to respect websites’ terms of service and use these techniques responsibly.</p>
<h2 id="parsing-and-transforming-data-with-typescript-3">Parsing and transforming data with TypeScript</h2>
<p>We will be exploring how to parse and transform data scraped from LinkedIn using TypeScript. We will cover various techniques for working with data, such as filtering, mapping, and sorting.</p>
<h2 id="parsing-job-data">Parsing job data</h2>
<p>When scraping job listings from LinkedIn, we can parse the data into an array of objects, where each object represents a job listing with properties such as <code>title</code>, <code>company</code>, <code>location</code>, and <code>postedDate</code>.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">interface</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">company</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">location</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">postedDate</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeJobs</span><span style="color: #ABB2BF">(): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF">[]> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobListings</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [];</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #7F848E; font-style: italic">// navigate to the first page of job listings</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">goto</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'https://www.linkedin.com/jobs/search/?keywords=web%20developer'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">while</span><span style="color: #ABB2BF"> (</span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// scrape job data from the current page</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobs</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.jobs-search-results__list li'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">for</span><span style="color: #ABB2BF"> (</span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">of</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">jobs</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">title</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__title'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">company</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__company-name'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__location'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">postedDate</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$eval</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.job-card-search__posted-date'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">element</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">element</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">textContent</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">trim</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">      </span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobListing</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">company</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">location</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">postedDate</span><span style="color: #ABB2BF"> };</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #E5C07B">jobListings</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">push</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">jobListing</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic">// navigate to the next page if it exists, up to 5 pages</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">$</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.artdeco-pagination__button--next'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #56B6C2">!</span><span style="color: #E06C75">nextButton</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">||</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobListings</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">length</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">>=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">100</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">      </span><span style="color: #C678DD">break</span><span style="color: #ABB2BF">; </span><span style="color: #7F848E; font-style: italic">// no more pages or reached max job count</span></span>
<span class="line"><span style="color: #ABB2BF">    }</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">nextButton</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">click</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">page</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">waitForSelector</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'.jobs-search-results__list li'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">jobListings</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the above example, we define a <code>JobListing</code> interface to represent a job listing object. We then define a <code>scrapeJobs</code> function that scrapes job data from LinkedIn and parses it into an array of <code>JobListing</code> objects. We limit the maximum number of job listings to 100 and break out of the loop if there are no more pages or we have reached the maximum job count.</p>
<h2 id="filtering-job-data">Filtering job data</h2>
<p>Once we have parsed the job data into an array of objects, we can filter the data based on certain criteria. For example, we can filter the job listings to only include those that are located in a specific city.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">filterJobsByLocation</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">jobs</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF">[], </span><span style="color: #E06C75; font-style: italic">location</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF">[]> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">filter</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">job</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">toLowerCase</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">includes</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">location</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">toLowerCase</span><span style="color: #ABB2BF">()));</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the above example, we define a <code>filterJobsByLocation</code> function that takes an array of <code>JobListing</code> objects and a location string as input. We use the <code>Array.filter</code> method to filter the job listings to only include those that have a location property that includes the given location string (case-insensitive).</p>
<h2 id="sorting-job-data">Sorting job data</h2>
<p>We can also sort the job data based on certain criteria, such as the posted date or company name. For example, we can sort the job listings by the posted date in descending order.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">sortJobsByPostedDateDescending</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">jobs</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF">[]): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF">[]> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">sort</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">a</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">b</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Date</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">b</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">postedDate</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">getTime</span><span style="color: #ABB2BF">() </span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Date</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">a</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">postedDate</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">getTime</span><span style="color: #ABB2BF">());</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the above example, we
define a <code>sortJobsByPostedDateDescending</code> function that takes an array of <code>JobListing</code> objects as input. We use the <code>Array.sort</code> method to sort the job listings based on the posted date property in descending order. We use the <code>new Date</code> constructor to convert the posted date strings into Date objects, and then compare the timestamps using the <code>getTime</code> method.</p>
<h2 id="mapping-job-data">Mapping job data</h2>
<p>Another common operation when working with data is mapping. We can map the job data to extract only the properties we are interested in, or to transform the data in some way. For example, we can map the job listings to extract only the company names.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">mapJobsToCompanies</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">jobs</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF">[]): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">[]> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">job</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">job</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">company</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the above example, we define a <code>mapJobsToCompanies</code> function that takes an array of <code>JobListing</code> objects as input. We use the <code>Array.map</code> method to map the job listings to an array of company names, extracted from the <code>company</code> property of each job listing object.</p>
<h2 id="conclusion-1">Conclusion</h2>
<p>In this chapter, we covered various techniques for working with data scraped from LinkedIn using TypeScript. We demonstrated how to parse job data into an array of objects, filter the data based on certain criteria, sort the data based on certain criteria, and map the data to extract only the properties we are interested in. These techniques can be applied to a wide range of data processing tasks, and can be combined to perform more complex operations on the data.</p>
<h2 id="exporting-data-to-a-csv-file">Exporting data to a CSV file</h2>
<p>Once we have processed the data, it can be useful to export it to a CSV file for further analysis or use in other tools. TypeScript provides built-in support for working with file systems using the <code>fs</code> module.</p>
<p>To export our job data to a CSV file, we can use a library such as <code>csv-writer</code> to create a CSV file writer and then use it to write our data to the file.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">*</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">as</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">fs</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'fs'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">createObjectCsvWriter</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'csv-writer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">exportJobsToCsv</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">jobs</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">JobListing</span><span style="color: #ABB2BF">[], </span><span style="color: #E06C75; font-style: italic">filename</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">string</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">void</span><span style="color: #ABB2BF">> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">csvWriter</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">createObjectCsvWriter</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">path</span><span style="color: #ABB2BF">: </span><span style="color: #E06C75">filename</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">header</span><span style="color: #ABB2BF">: [</span></span>
<span class="line"><span style="color: #ABB2BF">      { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'title'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Title'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">      { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'company'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Company'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">      { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'location'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Location'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">      { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'postedDate'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Posted Date'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">    ],</span></span>
<span class="line"><span style="color: #ABB2BF">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">csvWriter</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeRecords</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">jobs</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">`Job data exported to </span><span style="color: #C678DD">${</span><span style="color: #E06C75">filename</span><span style="color: #C678DD">}</span><span style="color: #98C379">`</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the above example, we define an <code>exportJobsToCsv</code> function that takes an array of <code>JobListing</code> objects and a filename as input. We use the <code>createObjectCsvWriter</code> function from the <code>csv-writer</code> library to create a CSV writer object. We pass the desired header columns to the <code>header</code> option when creating the CSV writer.</p>
<p>Next, we call the <code>writeRecords</code> method of the CSV writer object to write the job data to the file. Finally, we log a message to the console to indicate that the data has been exported successfully.</p>
<p>To use this function to export our job data, we can call it with the array of job listings and the desired filename.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">jobListings</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">scrapeJobs</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">sortedJobs</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">sortJobsByPostedDateDescending</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">jobListings</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">exportJobsToCsv</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">sortedJobs</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'jobs.csv'</span><span style="color: #ABB2BF">);</span></span></code></pre>
<p>In the above example, we call the <code>scrapeJobs</code> function to retrieve the job data, then sort the data by the posted date using the <code>sortJobsByPostedDateDescending</code> function. Finally, we export the sorted data to a CSV file using the <code>exportJobsToCsv</code> function with the desired filename.</p>
<h2 id="conclusion-2">Conclusion</h2>
<p>In this chapter, we covered how to export scraped data to a CSV file using TypeScript. We demonstrated how to use the <code>csv-writer</code> library to create a CSV writer object and write data to a file. Exporting data to a CSV file can be useful for further analysis or use in other tools, and can help to organize and structure our data in a more manageable format.</p>
<h1 id="chapter-14-scraping-apis-with-typescript">Chapter 14: Scraping APIs with TypeScript</h1>
<h2 id="understanding-apis-and-their-use-cases">Understanding APIs and their use cases</h2>
<p>API stands for Application Programming Interface. It is a set of protocols, routines, and tools for building software applications. APIs allow different software systems to communicate with each other, exchanging data and services.</p>
<p>There are many use cases for APIs in software development. Some common examples include:</p>
<ol>
<li>
<p>Data integration: APIs can be used to integrate data from different sources, such as social media platforms, weather services, or financial data providers. This can be useful for building applications that need to access data from multiple sources.</p>
</li>
<li>
<p>Microservices architecture: APIs can be used to build a microservices architecture, where different components of an application are built as independent services that communicate with each other through APIs. This can make it easier to develop and scale large, complex applications.</p>
</li>
<li>
<p>Mobile applications: APIs can be used to provide access to services and data for mobile applications. Mobile applications often have limited resources and need to communicate with remote servers to retrieve data, and APIs can provide a standardized way of doing this.</p>
</li>
<li>
<p>E-commerce: APIs can be used in e-commerce applications to integrate with payment providers, shipping services, and other third-party services. This can make it easier to build and manage e-commerce applications that need to interact with multiple services.</p>
</li>
<li>
<p>Social media: APIs can be used to integrate social media features into applications, such as sharing content, authentication, and user data. This can be useful for building applications that rely on social media for user engagement.</p>
</li>
</ol>
<p>In general, APIs are useful for building applications that need to interact with other software systems, services, or data sources. APIs provide a standardized way of communicating and exchanging data, which can make it easier to build, test, and maintain applications.</p>
<h2 id="making-api-requests-with-axios">Making API requests with Axios</h2>
<p>Axios is a popular JavaScript library used for making HTTP requests from the browser or Node.js. It provides an easy-to-use API for making requests and handling responses, and supports features like interceptors, automatic data transformation, and error handling.</p>
<p>To make an API request with Axios, we first need to install the library using a package manager like npm or yarn.</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #abb2bf">npm install axios</span></span></code></pre>
<p>Once we have installed Axios, we can use it to make HTTP requests to a server. Here’s an example of making a GET request to an API endpoint:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">fetchUsers</span><span style="color: #ABB2BF">(): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">[]> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">[]>(</span><span style="color: #98C379">'https://example.com/api/users'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the above example, we import Axios and define an async function <code>fetchUsers</code> that makes a GET request to the <code>/api/users</code> endpoint on <code>example.com</code>. We use the <code>axios.get</code> method to make the request, passing in the endpoint URL as a string argument.</p>
<p>We also specify the generic type parameter <code>&#x3C;User[]></code> to indicate that we expect the response to be an array of <code>User</code> objects. Axios automatically deserializes the response data based on the specified type.</p>
<p>The <code>axios.get</code> method returns a Promise that resolves to an Axios response object, which contains information about the response, including the status code, headers, and data. In this example, we return the <code>response.data</code> property, which contains the deserialized response data.</p>
<p>Axios also supports other HTTP methods like POST, PUT, DELETE, and PATCH, which we can use to send data to a server or modify resources.</p>
<p>Here’s an example of making a POST request to an API endpoint:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">async</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">function</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">createUser</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">user</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">): </span><span style="color: #E5C07B">Promise</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">await</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">post</span><span style="color: #ABB2BF">&#x3C;</span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">>(</span><span style="color: #98C379">'https://example.com/api/users'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">user</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">return</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span></code></pre>
<p>In the above example, we define an async function <code>createUser</code> that makes a POST request to the <code>/api/users</code> endpoint on <code>example.com</code>. We pass in the <code>user</code> object as the second argument to the <code>axios.post</code> method, which will be serialized as JSON and sent in the request body.</p>
<p>We also specify the generic type parameter <code>&#x3C;User></code> to indicate that we expect the response to be a <code>User</code> object.</p>
<p>Axios provides many other options and features, such as interceptors, cancellation, and automatic retries, that can be useful for handling complex API requests and responses.</p>
<h2 id="authentication-and-rate-limiting">Authentication and rate limiting</h2>
<p>When building applications that make API requests, it’s important to consider authentication and rate limiting to ensure that we can securely access the data we need without exceeding API usage limits.</p>
<p>Authentication is the process of verifying the identity of a user or application to ensure that they have the necessary permissions to access the requested data or service. Many APIs require authentication before allowing access to data, and there are several ways to authenticate API requests, such as:</p>
<ol>
<li>
<p>API keys: An API key is a unique identifier that is used to authenticate API requests. API keys are often used to track and limit usage of an API, and are usually passed as a query parameter or header in the API request.</p>
</li>
<li>
<p>OAuth: OAuth is an authorization framework that allows third-party applications to access a user’s resources on a server without sharing their credentials. OAuth requires the user to grant permission to the application to access their resources, and uses access tokens to authenticate API requests.</p>
</li>
<li>
<p>JSON Web Tokens (JWT): JWT is a standard for securely transmitting information between parties as a JSON object. JWTs can be used for authentication and authorization by including the user’s identity and permissions in the token, which can be validated by the server.</p>
</li>
</ol>
<p>Rate limiting is the process of limiting the number of API requests that can be made in a given time period to prevent abuse and ensure fair usage of the API. Many APIs enforce rate limits by tracking the number of requests made by a user or application, and returning an error response when the limit is exceeded. To avoid exceeding rate limits, we can implement the following strategies:</p>
<ol>
<li>
<p>Caching: Caching API responses can reduce the number of requests made to the API and improve performance. We can use a caching library like Redis or Memcached to cache responses and serve them from the cache instead of making a new request to the API.</p>
</li>
<li>
<p>Backoff: Backoff is a strategy that involves waiting for a short period of time before retrying a failed API request. This can help reduce the load on the API server and prevent rate limit errors.</p>
</li>
<li>
<p>Throttling: Throttling is a strategy that involves limiting the rate at which API requests are made to ensure that we do not exceed the API usage limit. We can use a library like Bottleneck or RateLimit to implement throttling in our application.</p>
</li>
</ol>
<p>By implementing authentication and rate limiting strategies, we can ensure that our application can securely access the necessary data without exceeding API usage limits.</p>
<h2 id="transforming-api-responses-into-usable-data">Transforming API responses into usable data</h2>
<p>API responses often come in different formats such as JSON, XML or CSV, which can be difficult to work with directly. Therefore, it is often necessary to transform the API response data into a format that is more usable for our application.</p>
<p>One common approach to transforming API responses is to use a data transformation library like <code>lodash</code>, <code>Ramda</code> or <code>Underscore.js</code>. These libraries provide a set of functions for manipulating and transforming data in a variety of ways, such as filtering, sorting, and grouping data.</p>
<p>For example, let’s say we have an API response that returns an array of objects representing users, and we want to extract a list of usernames from the response. We can use the <code>map()</code> function from <code>lodash</code> to transform the response:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">map</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'lodash'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">apiUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'https://api.example.com/users'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiUrl</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">usernames</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">map</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">, </span><span style="color: #98C379">'username'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">usernames</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we are using the <code>map()</code> function to extract the <code>username</code> property from each object in the API response data array. The resulting <code>usernames</code> array can then be used in our application as needed.</p>
<p>Another common approach to transforming API responses is to use a data modeling library like <code>json2 or </code>class-transformer`. These libraries allow us to define TypeScript classes that represent the structure of the API response, and then automatically convert the response data into instances of these classes.</p>
<p>For example, let’s say we have an API response that returns an object representing a user, and we want to convert the response into a <code>User</code> TypeScript class:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">axios</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'axios'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">plainToClass</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'class-transformer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">User</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./models/user.model'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">apiUrl</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'https://api.example.com/users/1'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">axios</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">get</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">apiUrl</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">response</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">user</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">plainToClass</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">User</span><span style="color: #ABB2BF">, </span><span style="color: #E5C07B">response</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">data</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">user</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we are using the <code>plainToClass()</code> function from <code>class-transformer</code> to convert the API response data into an instance of the <code>User</code> class. The resulting <code>user</code> object can then be used in our application with all of the type checking and validation benefits of TypeScript classes.</p>
<h2 id="exporting-data-to-various-file-formats-1">Exporting data to various file formats</h2>
<p>Exporting data from our application into various file formats is a common requirement in many use cases. For example, we may need to export data into CSV, JSON, or XML formats to integrate with other systems, to generate reports, or to backup data.</p>
<p>In TypeScript, there are several libraries available that can help us export data into different file formats, including <code>csv-writer</code>, <code>jsonfile</code>, <code>xml-js</code>, and <code>exceljs</code>.</p>
<p>For example, let’s say we have an array of user objects, and we want to export the data as a CSV file. We can use the <code>csv-writer</code> library to accomplish this:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">createObjectCsvWriter</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'csv-writer'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">User</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./models/user.model'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'John Doe'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'john.doe@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Jane Smith'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'jane.smith@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Bob Johnson'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'bob.johnson@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">csvWriter</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">createObjectCsvWriter</span><span style="color: #ABB2BF">({</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">path</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'users.csv'</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">header</span><span style="color: #ABB2BF">: [</span></span>
<span class="line"><span style="color: #ABB2BF">    { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'id'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'ID'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">    { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'name'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Name'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">    { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'email'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">title</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Email'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  ],</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">csvWriter</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeRecords</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">users</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'CSV file written successfully'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we are using the <code>createObjectCsvWriter()</code> function from <code>csv-writer</code> to create a CSV file writer. We pass in an array of <code>User</code> objects, and specify the path where we want to save the CSV file, as well as the column headers.</p>
<p>We then call the <code>writeRecords()</code> function to write the data to the CSV file. Once the operation is complete, we log a success message to the console.</p>
<p>We can use similar approaches with other libraries to export data into other file formats such as JSON or XML.</p>
<p>For example, let’s say we have an array of user objects, and we want to export the data as a JSON file. We can use the <code>jsonfile</code> library to accomplish this:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">*</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">as</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">jsonfile</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'jsonfile'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">User</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./models/user.model'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'John Doe'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'john.doe@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Jane Smith'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'jane.smith@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Bob Johnson'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'bob.johnson@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">jsonfile</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFile</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'users.json'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">users</span><span style="color: #ABB2BF">, { </span><span style="color: #E06C75">spaces</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF"> }, (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'JSON file written successfully'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we are using the <code>writeFile()</code> function from <code>jsonfile</code> to write the <code>users</code> array to a JSON file. We pass in the path where we want to save the JSON file, as well as an options object that specifies the indentation level for the JSON output.</p>
<p>We also provide a callback function to handle any errors that may occur during the file write operation, and log success or error messages to the console as appropriate.</p>
<p>Similarly, we can export data into XML format using the <code>xml-js</code> library:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">*</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">as</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">fs</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'fs'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">*</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">as</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">xml</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'xml-js'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">User</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./models/user.model'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'John Doe'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'john.doe@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Jane Smith'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'jane.smith@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Bob Johnson'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'bob.johnson@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">xmlData</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">xml</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">js2xml</span><span style="color: #ABB2BF">({ </span><span style="color: #E06C75">users</span><span style="color: #ABB2BF"> }, { </span><span style="color: #E06C75">compact</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">spaces</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">fs</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFile</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'users.xml'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">xmlData</span><span style="color: #ABB2BF">, (</span><span style="color: #E06C75; font-style: italic">err</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> (</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">) {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">error</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">err</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  } </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'XML file written successfully'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we are using the <code>js2xml()</code> function from <code>xml-js</code> to convert the <code>users</code> array into XML format. We pass in an options object that specifies the formatting options for the XML output.</p>
<p>We then use the Node.js <code>fs</code> module to write the XML data to a file. We provide a callback function to handle any errors that may occur during the file write operation, and log success or error messages to the console as appropriate.</p>
<p>Finally, we can export data into Excel format using the <code>exceljs</code> library:</p>
<pre is:raw="" class="astro-code one-dark-pro" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">*</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">as</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">excel</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'exceljs'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"><span style="color: #C678DD">import</span><span style="color: #ABB2BF"> { </span><span style="color: #E06C75">User</span><span style="color: #ABB2BF"> } </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'./models/user.model'</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">: </span><span style="color: #E5C07B">User</span><span style="color: #ABB2BF">[] </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'John Doe'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'john.doe@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Jane Smith'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'jane.smith@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">id</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">name</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Bob Johnson'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">email</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'bob.johnson@example.com'</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">workbook</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">new</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">excel</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">Workbook</span><span style="color: #ABB2BF">();</span></span>
<span class="line"><span style="color: #C678DD">const</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">worksheet</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">workbook</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">addWorksheet</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Users'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">worksheet</span><span style="color: #ABB2BF">.</span><span style="color: #E06C75">columns</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">header</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'ID'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">key</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'id'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">width</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">header</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Name'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">key</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'name'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">width</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">30</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">  { </span><span style="color: #E06C75">header</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'Email'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">key</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">'email'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75">width</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">50</span><span style="color: #ABB2BF"> },</span></span>
<span class="line"><span style="color: #ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">users</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">forEach</span><span style="color: #ABB2BF">((</span><span style="color: #E06C75; font-style: italic">user</span><span style="color: #ABB2BF">) </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">worksheet</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">addRow</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75">user</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E5C07B">workbook</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">xlsx</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">writeFile</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'users.xlsx'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">then</span><span style="color: #ABB2BF">(() </span><span style="color: #C678DD">=></span><span style="color: #ABB2BF"> {</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E5C07B">console</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">log</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'Excel file written successfully'</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">});</span></span></code></pre>
<p>In this example, we are using the <code>exceljs</code> library to create a new Excel workbook and worksheet. We specify the column headers and widths for the worksheet, and then use a loop to add rows to the worksheet based on the data in the <code>users</code> array.</p>
<p>We then use the <code>writeFile()</code> function to write the Excel data to a file. Once the operation is complete, we log a success message to the console.</p>
<p>Overall, these examples demonstrate how we can use different libraries in TypeScript to export data into various file formats, based on the requirements of our application.</p>
<h1 id="chapter-15-web-scraping-in-production">Chapter 15: Web Scraping in Production</h1>
<h2 id="overview-of-deploying-web-scrapers-to-production">Overview of deploying web scrapers to production</h2>
<p>Deploying web scrapers to production requires careful consideration of various factors, such as:</p>
<ol>
<li>
<p><strong>Scalability</strong>: Can the scraper handle large volumes of data and multiple concurrent requests without crashing or slowing down?</p>
</li>
<li>
<p><strong>Reliability</strong>: Is the scraper able to handle errors gracefully, and retry failed requests or resume from the last successful point in case of interruptions?</p>
</li>
<li>
<p><strong>Efficiency</strong>: Does the scraper run efficiently, without consuming excessive resources or causing unnecessary load on the target website?</p>
</li>
<li>
<p><strong>Data storage and management</strong>: How will the scraped data be stored, managed, and accessed for downstream processing or analysis?</p>
</li>
<li>
<p><strong>Security</strong>: Are there any security or privacy concerns with the data being scraped, and how can they be addressed?</p>
</li>
<li>
<p><strong>Legal considerations</strong>: Are there any legal implications or restrictions on the data being scraped, and how can they be complied with?</p>
</li>
</ol>
<p>To deploy a web scraper to production, we typically follow these steps:</p>
<ol>
<li>
<p><strong>Optimize the code</strong>: Review the code and identify any areas for optimization to improve the scraper’s performance, reliability, and efficiency.</p>
</li>
<li>
<p><strong>Choose a deployment method</strong>: There are various options for deploying web scrapers, such as using cloud-based services like AWS, Azure, or Google Cloud, or deploying to a dedicated server or virtual machine.</p>
</li>
<li>
<p><strong>Set up the environment</strong>: Set up the production environment with the necessary dependencies, configuration settings, and security measures.</p>
</li>
<li>
<p><strong>Test the scraper</strong>: Test the scraper in the production environment to ensure it works as expected and handles errors gracefully.</p>
</li>
<li>
<p><strong>Schedule the scraper</strong>: Set up a scheduler to run the scraper at regular intervals or in response to specific triggers.</p>
</li>
<li>
<p><strong>Monitor the scraper</strong>: Monitor the scraper’s performance, resource usage, and error logs to ensure it is running smoothly and identify any issues that need to be addressed.</p>
</li>
<li>
<p><strong>Store the data</strong>: Store the scraped data in a reliable and accessible format, such as a database or cloud storage service.</p>
</li>
<li>
<p><strong>Comply with legal and ethical considerations</strong>: Ensure the scraper complies with any legal or ethical considerations related to the data being scraped, such as terms of service or data privacy regulations.</p>
</li>
</ol>
<p>Overall, deploying web scrapers to production requires careful planning, testing, and monitoring to ensure they work reliably and efficiently while adhering to legal and ethical considerations.</p>
<h2 id="scaling-web-scrapers-for-high-throughput">Scaling web scrapers for high throughput</h2>
<p>Scaling web scrapers for high throughput requires a combination of architectural and operational strategies to distribute the load across multiple servers or instances. Here are some approaches that can be used to scale web scrapers:</p>
<ol>
<li>
<p><strong>Distributed scraping</strong>: Distribute the scraping load across multiple instances, each responsible for scraping a subset of the data or a specific website. This can be achieved using technologies such as Kubernetes, Docker Swarm, or Apache Mesos.</p>
</li>
<li>
<p><strong>Caching</strong>: Use caching to reduce the number of requests sent to the target website. Caching can be implemented at various levels, such as in-memory caching, database caching, or CDN caching.</p>
</li>
<li>
<p><strong>Load balancing</strong>: Use load balancing to evenly distribute the incoming requests across multiple servers or instances. This can be done using hardware load balancers or software load balancers like NGINX or HAProxy.</p>
</li>
<li>
<p><strong>Asynchronous processing</strong>: Use asynchronous processing to avoid blocking the scraping process while waiting for responses from the target website. Asynchronous processing can be achieved using tools like Celery, RabbitMQ, or Apache Kafka.</p>
</li>
<li>
<p><strong>Auto-scaling</strong>: Use auto-scaling to automatically add or remove instances based on the demand for the scraping workload. This can be done using cloud-based services like AWS Auto Scaling, Azure Autoscale, or Google Cloud Autoscaling.</p>
</li>
<li>
<p><strong>Optimize the scraper code</strong>: Optimize the scraper code to reduce the time and resources needed to process each request. This can be done by reducing the number of requests sent to the target website, using efficient data structures and algorithms, and minimizing I/O operations.</p>
</li>
<li>
<p><strong>Monitor and optimize resource usage</strong>: Monitor the resource usage of the scraper instances and optimize them for efficiency. This includes optimizing CPU, memory, and disk usage, as well as reducing network bandwidth and minimizing downtime.</p>
</li>
</ol>
<p>Overall, scaling web scrapers for high throughput requires a combination of architectural and operational strategies to distribute the load across multiple instances while optimizing the scraper code and resource usage.</p>
<h2 id="handling-errors-and-edge-cases-in-production">Handling errors and edge cases in production</h2>
<p>Handling errors and edge cases in production is critical for maintaining the stability and reliability of a web scraper. Here are some best practices for handling errors and edge cases in production:</p>
<ol>
<li>
<p><strong>Logging</strong>: Implement robust logging mechanisms to capture errors and exceptions that occur during scraping. This includes capturing information about the request, response, and any relevant metadata.</p>
</li>
<li>
<p><strong>Error handling</strong>: Implement error handling mechanisms that gracefully handle errors and exceptions that occur during scraping. This includes handling HTTP errors, connection timeouts, and server errors.</p>
</li>
<li>
<p><strong>Retry logic</strong>: Implement retry logic to automatically retry failed requests or requests that encounter errors. This includes setting a maximum number of retries and implementing backoff strategies to prevent overloading the target website.</p>
</li>
<li>
<p><strong>Fallback mechanisms</strong>: Implement fallback mechanisms to handle cases where the expected data is not available or is incomplete. This includes using default values, alternate data sources, or manual intervention to complete the scraping process.</p>
</li>
<li>
<p><strong>Edge case handling</strong>: Identify and handle edge cases that may occur during scraping, such as handling dynamic content, pagination, and CAPTCHAs.</p>
</li>
<li>
<p><strong>Testing</strong>: Implement thorough testing procedures to ensure the scraper is working as expected and can handle various edge cases and errors that may occur during scraping.</p>
</li>
<li>
<p><strong>Monitoring</strong>: Implement monitoring mechanisms to detect issues and errors that may occur during scraping. This includes monitoring the health of the scraper instances, the number of requests being processed, and the response times of the target website.</p>
</li>
</ol>
<p>Overall, handling errors and edge cases in production requires a proactive approach that includes logging, error handling, retry logic, fallback mechanisms, edge case handling, testing, and monitoring. By implementing these best practices, web scrapers can be made more reliable, robust, and resilient in production environments.</p>
<h2 id="best-practices-for-monitoring-and-maintaining-scrapers">Best practices for monitoring and maintaining scrapers</h2>
<p>Monitoring and maintaining web scrapers is an important part of ensuring their reliability and effectiveness. Here are some best practices for monitoring and maintaining scrapers:</p>
<ol>
<li>
<p><strong>Monitoring scraper performance</strong>: Monitor the scraper’s performance to ensure that it is running smoothly and processing data as expected. This includes monitoring the number of requests being made, the response times of the target website, and the number of errors encountered during scraping.</p>
</li>
<li>
<p><strong>Logging scraper activity</strong>: Implement logging mechanisms to capture information about the scraper’s activity, including requests made, responses received, and any errors encountered during scraping.</p>
</li>
<li>
<p><strong>Alerting</strong>: Implement alerting mechanisms to notify relevant stakeholders if the scraper encounters errors or is not running as expected. This can include email alerts, Slack notifications, or other forms of alerts.</p>
</li>
<li>
<p><strong>Version control</strong>: Implement version control mechanisms to track changes to the scraper’s codebase and configuration files. This can help ensure that the scraper is always using the most up-to-date code and settings.</p>
</li>
<li>
<p><strong>Documentation</strong>: Maintain documentation for the scraper’s codebase and configuration files to ensure that others can understand and maintain the scraper if needed.</p>
</li>
<li>
<p><strong>Regular maintenance</strong>: Regularly perform maintenance on the scraper, including updating dependencies, optimizing code, and removing unnecessary code.</p>
</li>
<li>
<p><strong>Backups</strong>: Implement backup mechanisms to ensure that data is not lost if the scraper or its data storage mechanisms fail.</p>
</li>
</ol>
<p>By following these best practices, you can ensure that your web scraper is performing as expected and is well-maintained. This can help ensure that you are getting the data you need in a reliable and efficient manner.</p>
<h2 id="case-studies-of-successful-production-web-scraping-projects">Case studies of successful production web scraping projects</h2>
<p>There are numerous successful production web scraping projects that have been implemented by companies across a variety of industries. Here are a few examples:</p>
<ol>
<li>
<p><strong>Price comparison engines</strong>: Many companies in the retail industry use web scraping to collect and compare prices from competitors’ websites. This allows them to offer competitive pricing and make data-driven decisions about their pricing strategy.</p>
</li>
<li>
<p><strong>Real estate data</strong>: Companies in the real estate industry use web scraping to collect data about properties, including pricing, amenities, and other key features. This data can then be used to inform pricing and marketing decisions, as well as to identify new opportunities for investment.</p>
</li>
<li>
<p><strong>Job listings</strong>: Job search websites use web scraping to collect and aggregate job listings from multiple sources. This allows them to offer a more comprehensive view of available job opportunities and provide job seekers with a better user experience.</p>
</li>
<li>
<p><strong>Social media sentiment analysis</strong>: Many companies use web scraping to collect data from social media platforms and analyze sentiment about their brand or products. This can help them identify potential issues and respond quickly to customer concerns.</p>
</li>
<li>
<p><strong>Competitive intelligence</strong>: Companies in many industries use web scraping to collect data about competitors’ products, prices, and marketing strategies. This allows them to identify opportunities for growth and make data-driven decisions about their own products and marketing campaigns.</p>
</li>
</ol>
<p>Overall, web scraping has proven to be a valuable tool for companies across a wide range of industries. By collecting and analyzing data from the web, companies can make more informed decisions, stay ahead of the competition, and provide better products and services to their customers.</p>
<h1 id="chapter-16-web-scraping-applications">Chapter 16: Web Scraping Applications</h1>
<h2 id="overview-of-web-scraping-applications">Overview of web scraping applications</h2>
<p>Web scraping, also known as web data extraction or web harvesting, is the process of automatically collecting data from websites. It involves using software tools to extract data from web pages and transform it into a structured format that can be used for analysis or other purposes.</p>
<p>Here are some common applications of web scraping:</p>
<ol>
<li>
<p><strong>Competitive intelligence</strong>: Companies can use web scraping to gather data on their competitors, including their pricing strategies, product offerings, and marketing campaigns. This can help companies stay ahead of the competition and make more informed business decisions.</p>
</li>
<li>
<p><strong>Market research</strong>: Web scraping can be used to gather data on consumer behavior, industry trends, and other market insights. This data can be used to inform product development, marketing campaigns, and other business decisions.</p>
</li>
<li>
<p><strong>Lead generation</strong>: Web scraping can be used to gather contact information for potential customers, such as email addresses and phone numbers. This can be valuable for sales and marketing teams looking to generate leads and grow their customer base.</p>
</li>
<li>
<p><strong>Social media monitoring</strong>: Web scraping can be used to monitor social media platforms for mentions of a company or brand. This can help companies identify customer sentiment and respond to issues or concerns in a timely manner.</p>
</li>
<li>
<p><strong>Price comparison</strong>: Web scraping can be used to gather pricing data from multiple websites, allowing companies to compare prices and make informed pricing decisions.</p>
</li>
<li>
<p><strong>Content aggregation</strong>: Web scraping can be used to collect news articles, blog posts, and other content from multiple sources and present it in a single location.</p>
</li>
</ol>
<p>Overall, web scraping has many practical applications for businesses and individuals looking to collect and analyze data from the web. It can help companies make more informed business decisions, generate leads, and stay ahead of the competition.</p>
<h2 id="examples-of-real-world-applications-of-web-scraping">Examples of real-world applications of web scraping</h2>
<p>Web scraping has a wide range of real-world applications, and is used by businesses, organizations, and individuals to gather and analyze data from the web. Here are some examples of real-world applications of web scraping:</p>
<ol>
<li>
<p><strong>Price comparison</strong>: Retailers can use web scraping to collect pricing data from competitors’ websites, allowing them to adjust their prices and stay competitive.</p>
</li>
<li>
<p><strong>Lead generation</strong>: Sales and marketing teams can use web scraping to collect contact information for potential customers, allowing them to reach out and generate leads.</p>
</li>
<li>
<p><strong>Market research</strong>: Researchers can use web scraping to gather data on consumer behavior, industry trends, and other market insights.</p>
</li>
<li>
<p><strong>Content aggregation</strong>: News organizations and other publishers can use web scraping to collect articles and other content from multiple sources, allowing them to present a more complete picture of a particular topic.</p>
</li>
<li>
<p><strong>Social media monitoring</strong>: Brands and organizations can use web scraping to monitor social media platforms for mentions of their brand, allowing them to respond quickly to customer concerns and issues.</p>
</li>
<li>
<p><strong>Weather monitoring</strong>: Weather services can use web scraping to collect data from multiple sources and provide more accurate weather forecasts.</p>
</li>
<li>
<p><strong>Job listings</strong>: Job search websites can use web scraping to collect and aggregate job listings from multiple sources, allowing them to offer a more comprehensive view of available job opportunities.</p>
</li>
<li>
<p><strong>Real estate data</strong>: Real estate companies can use web scraping to collect data on available properties, including pricing and other key features.</p>
</li>
</ol>
<p>These are just a few examples of the many real-world applications of web scraping. By collecting and analyzing data from the web, businesses and organizations can make more informed decisions and stay ahead of the competition.</p>
<h2 id="building-web-scrapers-for-specific-applications">Building web scrapers for specific applications</h2>
<p>Building web scrapers for specific applications requires a deep understanding of the data that needs to be collected, as well as the sources from which it needs to be collected. Here are some tips for building web scrapers for specific applications:</p>
<ol>
<li>
<p><strong>Identify the data source</strong>: Determine the website or websites from which you will be collecting data. Make sure you understand the structure of the website and the format of the data you will be collecting.</p>
</li>
<li>
<p><strong>Determine the data fields</strong>: Determine the specific data fields you need to collect from the website. This will help you determine the structure of your scraper and the types of data storage you will need.</p>
</li>
<li>
<p><strong>Create a plan for handling errors</strong>: Web scraping can be prone to errors due to changes in the structure of the website or other unexpected issues. Make sure you have a plan in place for handling these errors, such as by logging error messages or sending alerts when errors occur.</p>
</li>
<li>
<p><strong>Consider rate limiting and authentication</strong>: Some websites may have rate limiting or authentication requirements that you need to take into account when building your scraper. Make sure you understand these requirements and build your scraper accordingly.</p>
</li>
<li>
<p><strong>Test your scraper</strong>: Before deploying your scraper, test it thoroughly to make sure it is collecting the data you need and handling errors appropriately.</p>
</li>
<li>
<p><strong>Monitor your scraper</strong>: Once your scraper is deployed, monitor it regularly to make sure it is running smoothly and collecting the data you need. Make sure you have alerts in place to notify you of any issues that arise.</p>
</li>
</ol>
<p>By following these tips, you can build effective web scrapers for specific applications that collect the data you need and help you make more informed decisions.</p>
<h2 id="best-practices-for-designing-and-building-web-scraping-applications">Best practices for designing and building web scraping applications</h2>
<p>Here are some best practices for designing and building web scraping applications:</p>
<ol>
<li>
<p><strong>Identify the data sources</strong>: Determine the websites and sources from which you will be collecting data. Make sure you have permission to scrape the data and that the data is relevant to your needs.</p>
</li>
<li>
<p><strong>Understand the data</strong>: Understand the structure and format of the data you will be collecting. This will help you design a scraper that can efficiently collect and store the data.</p>
</li>
<li>
<p><strong>Choose the right tool for the job</strong>: Select a web scraping tool or library that is appropriate for your needs. Some popular options include BeautifulSoup, Scrapy, and Puppeteer. Make sure the tool you choose has the features you need and can handle the volume of data you plan to collect.</p>
</li>
<li>
<p><strong>Consider the website structure</strong>: Consider the structure of the website you will be scraping. Some websites may require additional steps to authenticate or navigate before you can access the data. Make sure you account for these steps in your scraper design.</p>
</li>
<li>
<p><strong>Handle errors gracefully</strong>: Web scraping can be prone to errors due to changes in the website structure or unexpected issues. Make sure you have a plan in place for handling errors, such as logging error messages or sending alerts when errors occur.</p>
</li>
<li>
<p><strong>Be respectful of website policies</strong>: Respect website policies and terms of service when scraping data. Avoid scraping data too frequently or in a way that may cause undue strain on the website’s servers.</p>
</li>
<li>
<p><strong>Test your scraper</strong>: Before deploying your scraper, test it thoroughly to make sure it is collecting the data you need and handling errors appropriately.</p>
</li>
<li>
<p><strong>Monitor your scraper</strong>: Once your scraper is deployed, monitor it regularly to make sure it is running smoothly and collecting the data you need. Make sure you have alerts in place to notify you of any issues that arise.</p>
</li>
</ol>
<p>By following these best practices, you can design and build web scraping applications that are effective, reliable, and respectful of website policies.</p>
            </article>
          </div>
          <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var c;{let d={0:t=>t,1:t=>JSON.parse(t,o),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(JSON.parse(t,o)),5:t=>new Set(JSON.parse(t,o)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(JSON.parse(t)),9:t=>new Uint16Array(JSON.parse(t)),10:t=>new Uint32Array(JSON.parse(t))},o=(t,r)=>{if(t===""||!Array.isArray(r))return r;let[e,n]=r;return e in d?d[e](n):void 0};customElements.get("astro-island")||customElements.define("astro-island",(c=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=()=>{var l;if(!this.hydrator||!this.isConnected||(l=this.parentElement)!=null&&l.closest("astro-island[ssr]"))return;let r=this.querySelectorAll("astro-slot"),e={},n=this.querySelectorAll("template[data-astro-template]");for(let s of n){let i=s.closest(this.tagName);!i||!i.isSameNode(this)||(e[s.getAttribute("data-astro-template")||"default"]=s.innerHTML,s.remove())}for(let s of r){let i=s.closest(this.tagName);!i||!i.isSameNode(this)||(e[s.getAttribute("name")||"default"]=s.innerHTML)}let a=this.hasAttribute("props")?JSON.parse(this.getAttribute("props"),o):{};this.hydrator(this)(this.Component,a,e,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),window.removeEventListener("astro:hydrate",this.hydrate),window.dispatchEvent(new CustomEvent("astro:hydrate"))}}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((r,e)=>{e.disconnect(),setTimeout(()=>this.childrenConnectedCallback(),0)}).observe(this,{childList:!0})}async childrenConnectedCallback(){window.addEventListener("astro:hydrate",this.hydrate);let r=this.getAttribute("before-hydration-url");r&&await import(r),this.start()}start(){let r=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(Astro[e]===void 0){window.addEventListener(`astro:${e}`,()=>this.start(),{once:!0});return}Astro[e](async()=>{let n=this.getAttribute("renderer-url"),[a,{default:l}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),s=this.getAttribute("component-export")||"default";if(!s.includes("."))this.Component=a[s];else{this.Component=a;for(let i of s.split("."))this.Component=this.Component[i]}return this.hydrator=l,this.hydrate},r,this)}attributeChangedCallback(){this.hydrate()}},c.observedAttributes=["props"],c))}})();</script><astro-island uid="ZbKvuO" prefix="r0" component-url="/_astro/Disqus.101366bd.js" component-export="default" renderer-url="/_astro/client.663bf61e.js" props="{}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Disqus&quot;,&quot;value&quot;:true}" await-children=""><div class="row mt-16 justify-center "><div id="disqus_thread"></div></div></astro-island>
        </div>
      </div>
    </div>
  </section>

    </main>
    <footer class="footer bg-[#F1F1F1]">
  <div class="container">
    <div class="gx-5 row pb-10 pt-[52px]">
      <div class="col-12 mt-12 md:col-6 lg:col-3">
        <a href="/" class="navbar-brand block">
  <img alt="Pinwheel Astro" style="height:31px;width:147px" width="294" height="62" src="/_astro/logo_ZThIBR.png" loading="lazy" decoding="async">
</a>
        <p class="mt-6">
          Trying to make the world a better place.
        </p>
      </div>
      <div class="col-12 mt-12 md:col-6 lg:col-3">
        <h6>Socials</h6>

        <ul class="social-icons mt-4 lg:mt-6">
  <li class="inline-block">
        <a aria-label="facebook" href="https://facebook.com/" target="_blank" rel="noopener noreferrer nofollow">
          <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M480 257.35c0-123.7-100.3-224-224-224s-224 100.3-224 224c0 111.8 81.9 204.47 189 221.29V322.12h-56.89v-64.77H221V208c0-56.13 33.45-87.16 84.61-87.16 24.51 0 50.15 4.38 50.15 4.38v55.13H327.5c-27.81 0-36.51 17.26-36.51 35v42h62.12l-9.92 64.77H291v156.54c107.1-16.81 189-109.48 189-221.31z"></path></svg>
        </a>
      </li>
  <li class="inline-block">
        <a aria-label="twitter" href="https://twitter.com/" target="_blank" rel="noopener noreferrer nofollow">
          <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M496 109.5a201.8 201.8 0 01-56.55 15.3 97.51 97.51 0 0043.33-53.6 197.74 197.74 0 01-62.56 23.5A99.14 99.14 0 00348.31 64c-54.42 0-98.46 43.4-98.46 96.9a93.21 93.21 0 002.54 22.1 280.7 280.7 0 01-203-101.3A95.69 95.69 0 0036 130.4c0 33.6 17.53 63.3 44 80.7A97.5 97.5 0 0135.22 199v1.2c0 47 34 86.1 79 95a100.76 100.76 0 01-25.94 3.4 94.38 94.38 0 01-18.51-1.8c12.51 38.5 48.92 66.5 92.05 67.3A199.59 199.59 0 0139.5 405.6a203 203 0 01-23.5-1.4A278.68 278.68 0 00166.74 448c181.36 0 280.44-147.7 280.44-275.8 0-4.2-.11-8.4-.31-12.5A198.48 198.48 0 00496 109.5z"></path></svg>
        </a>
      </li>
  
  
  
  <li class="inline-block">
        <a aria-label="linkedin" href="https://linkedin.com/" target="_blank" rel="noopener noreferrer nofollow">
          <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M444.17 32H70.28C49.85 32 32 46.7 32 66.89v374.72C32 461.91 49.85 480 70.28 480h373.78c20.54 0 35.94-18.21 35.94-38.39V66.89C480.12 46.7 464.6 32 444.17 32zm-273.3 373.43h-64.18V205.88h64.18zM141 175.54h-.46c-20.54 0-33.84-15.29-33.84-34.43 0-19.49 13.65-34.42 34.65-34.42s33.85 14.82 34.31 34.42c-.01 19.14-13.31 34.43-34.66 34.43zm264.43 229.89h-64.18V296.32c0-26.14-9.34-44-32.56-44-17.74 0-28.24 12-32.91 23.69-1.75 4.2-2.22 9.92-2.22 15.76v113.66h-64.18V205.88h64.18v27.77c9.34-13.3 23.93-32.44 57.88-32.44 42.13 0 74 27.77 74 87.64z"></path></svg>
        </a>
      </li>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="inline-block">
        <a aria-label="skype" href="https://skype.com/" target="_blank" rel="noopener noreferrer nofollow">
          <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M467.16 303.6a205.69 205.69 0 004.9-45.15c0-116.32-95.69-210.7-213.79-210.7a221.83 221.83 0 00-36.52 3A123.58 123.58 0 00155.93 32C87.55 32 32 86.72 32 154.15A119.56 119.56 0 0049 216a211.16 211.16 0 00-4.32 42.35c0 116.44 95.69 210.7 213.67 210.7a214 214 0 0039.09-3.5A125.45 125.45 0 00356.07 480C424.57 480 480 425.28 480 357.85a118 118 0 00-12.84-54.25zM368 359c-9.92 13.76-24.51 24.73-43.41 32.43S283.36 403 257.69 403c-30.69 0-56.36-5.37-76.55-15.87a101 101 0 01-35.24-30.8c-9.11-12.83-13.66-25.66-13.66-38 0-7.7 3-14.35 8.87-19.95 5.84-5.37 13.42-8.17 22.29-8.17 7.35 0 13.65 2.1 18.79 6.42 4.9 4.08 9.1 10.15 12.48 18.08A108.09 108.09 0 00207 336.15q6.32 8.22 17.86 13.65c7.82 3.62 18.2 5.48 31 5.48 17.62 0 32.09-3.73 42.94-11.08 10.74-7.12 15.88-15.75 15.88-26.25 0-8.28-2.69-14.82-8.29-19.95-5.83-5.37-13.42-9.57-22.87-12.37-9.69-3-22.87-6.18-39.21-9.56-22.17-4.67-41-10.27-56-16.57-15.28-6.42-27.65-15.4-36.76-26.48-9.22-11.32-13.77-25.55-13.77-42.24a67.86 67.86 0 0114.47-42.58c9.57-12.25 23.46-21.82 41.55-28.35 17.74-6.53 38.86-9.8 62.66-9.8 19.14 0 35.83 2.22 49.83 6.42s25.91 10.15 35.36 17.38 16.34 14.93 20.77 23 6.66 16.22 6.66 24c0 7.46-2.92 14.35-8.76 20.3a29.65 29.65 0 01-21.94 9.1c-7.93 0-14.12-1.87-18.43-5.6-4-3.5-8.17-8.87-12.72-16.69-5.37-9.91-11.79-17.85-19.14-23.45-7.24-5.36-19.14-8.16-35.71-8.16-15.29 0-27.77 3-37 9-8.87 5.72-13.19 12.37-13.19 20.18a18.26 18.26 0 004.32 12.25 38.13 38.13 0 0012.72 9.57 90.14 90.14 0 0017.15 6.53c6 1.64 15.87 4.09 29.53 7.12 17.38 3.62 33.25 7.82 47.26 12.13 14.24 4.55 26.49 10 36.52 16.45a72.93 72.93 0 0124.16 25.09c5.72 10 8.64 22.63 8.64 37.1A75.09 75.09 0 01368 359z"></path></svg>
        </a>
      </li>
  
  
  
  
  
</ul>
      </div>
      <div class="col-12 mt-12 md:col-6 lg:col-3">
        <h6>Quick Links</h6>
        <ul>
          <li class="mb-4">
                <a class="hover:text-primary hover:underline " href="/about">
                  About
                </a>
              </li><li class="mb-4">
                <a class="hover:text-primary hover:underline " href="/contact">
                  Contact
                </a>
              </li><li class="mb-4">
                <a class="hover:text-primary hover:underline " href="/elements">
                  Elements
                </a>
              </li><li class="mb-0">
                <a class="hover:text-primary hover:underline " href="/changelog">
                  Changelog
                </a>
              </li>
        </ul>
      </div>
      <div class="col-12 mt-12 md:col-6 lg:col-3">
        <h6>Location & Contact</h6>
        <ul>
          <li class="mb-2">Somewhere in Canada</li>
          <li class="mb-2">
            <a class="mb-2 hover:text-primary" href="mailto:colourfulmerchtik@gmail.com">colourfulmerchtik@gmail.com</a>
          </li>
          <li>
            <a class="hover:text-primary hover:underline" href="tel:+704-555-0127">+704-555-0127</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="container max-w-[1440px]">
    <div class="footer-copyright mx-auto border-t border-border pb-10 pt-7 text-center">
      <p class="content text-text">Copyright © 2023</p>
    </div>
  </div>
</footer>
  </body></html>